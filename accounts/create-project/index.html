<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>
        New Project
    </title>

    <meta name="viewport" content="width=device-width">
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    <link rel='stylesheet' href="../../global.css">
    <script>
        $(() => {
            $("#header").load("../header.html");
        });
    </script>
</head>
<body>
<div id="header"></div>
<div style="text-align: center; font-size: 20px">
    <label>
        Name:
        <input type="text" id="name">
    </label>
    <button id="submit">Create</button>
    <div id="error" style="text-align: center; font-size: 15px"></div>
</div>


</body>
</html>

<script type="module">
	import {APIToken, request} from '../../request.js';

    const error = $('#error');
    const nameElement = $('#name');
    const apiToken = new APIToken({});

    document.addEventListener('keypress', () => {
        nameElement.val(nameElement.val());
    });

    $(`#submit`).click(async () => {
        const name = nameElement.val();

        if (name.length < 5) {
            error.html('Name must be longer than 4 character');
            return;
        }

        const id = await request('/new-project', apiToken, {name});

        window.location.href = 'https://entropyengine.dev/editor?p=' + id.projectID;
    });

</script>