<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1"><title>Entropy Engine</title><script src="https://code.jquery.com/jquery-1.10.2.js"></script></head><body><div style="margin: 5px"><div id="top-bar"><div><a class="item" href="https://entropyengine.dev/"><img src="../../logo.png" alt="logo" style="height: 35px; width: 35px"></a></div><div><a class="item" href="https://entropyengine.dev/accounts/my-projects">My Projects </a><a class="item" href="https://entropyengine.dev/accounts">My Account </a><a class="item" href="https://entropyengine.dev/docs">Docs</a></div><div>ping: <span id="ping"></span>ms</div></div></div><main><div style="bottom: 0; top: 0"><div id="top-bar"><a class="button svg-grow" href="../accounts/home" style="background: url(../svg/home.svg) no-repeat center center;
                background-size: contain;
                width: 20px; height: 20px;"></a> <button onclick="window.goToBuildMenu()" class="button top-menu-button" style="width: 50px; margin: 2px; height: 27px" id="build-button">Build</button> <button onclick="window.save()" class="button top-menu-button" style="width: 100px" id="save">Save</button><p style="width: 200px; font-size: 20px; text-align: center" id="project-name"></p><button onclick="window.run()" class="button svg-grow top-menu-button" id="run" style="background: url(../svg/play.svg) no-repeat center center;
                background-size: contain;
                width: 80px; height: 20px;"></button> <a class="button svg-grow" href="../share?p=" style="background: url(../svg/share.svg) no-repeat center center;
                background-size: contain;
                width: 20px; height: 15px;" id="share"></a><div>ping: <span id="ping"></span>ms</div></div><div id="content"><div id="menu-bar-lower"><div style="display: grid"><button onclick="window.setState(window.sceneView)" class="button tab" style="grid-column: 1/3; width: 100%" id="go-to-scene-button">Scene</button> <button onclick="window.setState(window.scriptEditor)" class="button tab" style="grid-column: 3/5; width: 100%" id="go-to-scripts-button">Scripts</button> <button onclick="window.setState(window.gameView)" class="button tab" style="grid-column: 5/7; width: 100%" id="go-to-game-button">Game</button> <button onclick="window.setState(window.assets)" class="button tab" style="grid-column: 7/9; width: 100%" id="go-to-assets-button">Assets</button> <button onclick="window.setState(window.sceneSettings)" class="button tab" style="grid-column: 9/11; width: 100%" id="go-to-scene-settings-button">Scene Settings</button> <button onclick="window.setState(window.comments)" class="button tab" style="grid-column: 11/13; width: 100%" id="go-to-comments-button">Comments</button></div></div><div id="hierarchy"></div><div id="comments"></div><div id="scripts"></div><div id="canvas"><div id="scene-toolbar"></div><canvas id="myCanvas"></canvas></div><div id="assets"></div><div id="scene-settings"></div><div id="inspector"></div><div id="pop-up"><div id="pop-up-content"></div></div></div></div></main><style>:root {
  --mouse-x: 0px;
  --mouse-y: 0px;
}
html {
  max-height: 100vh;
  overflow-y: hidden;
}
#top-bar {
  height: 30px;
  display: flex;
  justify-content: space-evenly;
  align-items: center;
  background-color: vaR(--bg-dark);
}
#menu-bar-lower {
  grid-column: 2/4;
  grid-row: 1/1;
  display: grid;
}
#content {
  display: grid;
  grid-template-rows: 30px;
  border: none;
  margin: 0;
  padding: 0;
  height: 99vh;
  grid-template-columns: 20vw auto auto 20vw;
  overflow: hidden;
}
#inspector {
  border: 1px solid black;
  grid-column: 4/4;
  grid-row: 1/5;
  width: 20vw;
  overflow-y: scroll;
  height: calc(100vh - 30px);
  padding: 2px 0 5px 0;
  overflow-x: hidden;
}
#scene-toolbar {
  height: 30px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  background-color: vaR(--bg-dark);
  width: 100%;
}
#canvas {
  border: 1px solid black;
  grid-column: 2/4;
  grid-row: 2/5;
  display: inline;
}
#scripts {
  border: 1px solid black;
  grid-column: 2/4;
  grid-row: 2/5;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100%;
}
#script-code {
  width: calc(100% - 10px);
  height: 100%;
}
#game {
  border: 1px solid black;
  grid-column: 2/4;
  grid-row: 2/5;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100%;
}
#myCanvas {
  border: 1px solid #c6c6c6;
}
canvas {
  -ms-interpolation-mode: nearest-neighbor;
  image-rendering: -moz-crisp-edges;
  image-rendering: -webkit-crisp-edges;
  image-rendering: pixelated;
}
#assets {
  border: 1px solid black;
  grid-column: 2/4;
  grid-row: 2/5;
  height: 100%;
  max-width: 100%;
}
#scene-settings {
  border: 1px solid black;
  grid-column: 2/4;
  grid-row: 2/5;
  height: 100%;
  max-width: 100%;
  overflow-y: scroll;
}
#comments {
  border: 1px solid darkgrey;
  grid-column: 2/4;
  grid-row: 2/5;
  height: 100%;
  max-width: 100%;
}
#hierarchy {
  border: 1px solid black;
  grid-column: 1/1;
  grid-row: 1/5;
  min-width: 250px;
  height: 100%;
  overflow-y: scroll;
}
#pop-up {
  position: fixed;
  visibility: hidden;
  border: 1px solid rgba(184, 184, 184, 0.5);
  border-radius: 8px;
  width: 175px;
  min-height: 25px;
  overflow-y: scroll;
  right: 0;
  box-shadow: 0 0 10px 5px rgba(0, 0, 0, 0.1);
}
#pop-up-content {
  padding: 3px 0 3px 8px;
}
.add-component-popup {
  text-align: center;
  height: 200px;
  overflow-y: scroll;
  width: 80%;
  border: 1px solid grey;
  border-radius: 8px;
}
.header {
  text-align: center;
  font-size: 20px;
  margin: 5px 0;
}
.subheader {
  text-align: center;
  font-size: 15px;
  margin: 5px 0;
}
.center {
  display: flex;
  justify-content: center;
  align-items: center;
}
.center-self {
  justify-self: center;
  align-self: center;
}
input,
select {
  border: none;
  border-bottom: 1px solid vaR(--input-opposite-bg);
  background-color: vaR(--input-bg);
  border-radius: 4px;
  padding: 2px 2px 2px 4px;
  margin: 2px;
  color: vaR(--text-colour);
}
input:hover,
select:hover {
  background-color: vaR(--input-hover-bg);
}
input[type=number] {
  width: 75px;
}
input[type=number],
input[type=text] {
  height: 18px;
}
input[type=checkbox] {
  background-color: vaR(--input-bg);
}
input[type=checkbox]:hover {
  background-color: vaR(--input-hover-bg);
}
input[type=checkbox]:checked {
  background-color: vaR(--input-opposite-bg);
}
.array {
  border: 1px solid grey;
  border-radius: 5px;
  min-height: 18px;
  padding: 8px;
}
.even-space-container {
  text-align: justify;
  -ms-text-justify: distribute-all-lines;
  text-justify: distribute-all-lines;
}
.even-space-item {
  vertical-align: top;
  display: inline-block;
  *display: inline;
  zoom: 1;
}
.even-space-stretch {
  width: 100%;
  display: inline-block;
  font-size: 0;
  line-height: 0;
}
#scripts-container {
  max-height: 30px;
  overflow-x: scroll;
  overflow-y: hidden;
}
#scripts-container > ::-webkit-scrollbar-track {
  background-color: vaR(--input-opposite-bg);
}
.tab {
  border-right: 1px solid rgba(0, 0, 0, 0.5);
}
.top-menu-button {
  margin: 8px 2px;
  height: 90%;
}
.svg-grow:hover {
  transform: scale(1.2);
}
.asset-container {
  width: 150px;
  height: 200px;
  border-radius: 10px;
  margin: 5px;
  flex: 0 1 calc(25% - 1em);
  border: 1px solid vaR(--input-bg);
  transition: 200ms;
}
.asset-container:hover > div > div.asset-image-container > div.asset-image {
  transform: scale(1.1);
}
.asset-container:hover {
  transform: scale(1.02);
  background-color: vaR(--input-bg);
}
.asset-image-container {
  width: 130px;
  height: 130px;
  border-radius: 5px;
  border: 2px solid vaR(--input-hover-bg);
  overflow: hidden;
}
.asset-image {
  width: 100%;
  height: 100%;
  background-size: contain;
  transition: 750ms;
}
#hierarchy > ol,
#hierarchy > ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
  border: none;
  outline: none;
}
#add-comment-container {
  text-align: center;
  margin: 0 0 20px 0;
}
#add-comment {
  border-bottom: 1px solid grey;
  margin: 20px;
  background-color: rgba(0, 0, 0, 0);
  width: 90%;
  border-radius: 0;
}
.tooltip-container {
  position: relative;
  display: inline-block;
}
.tooltip-container .tooltip,
.tooltip-container .tooltip-fleeting {
  visibility: hidden;
  width: 16vw;
  background-color: var(--input-bg);
  color: var(--text-colour);
  border: 1px solid var(--input-hover-bg);
  text-align: center;
  border-radius: 6px;
  padding: 5px;
  /* Position the tooltip */
  position: absolute;
  z-index: 1000;
  bottom: 100%;
  left: 50%;
  margin-left: -50px;
  /* Magic number */
}
.tooltip-container:hover .tooltip-fleeting:not(:hover) {
  visibility: visible;
}
.tooltip-container:hover .tooltip {
  visibility: visible;
}
.tooltip-container .tooltip::after,
.tooltip-container .tooltip-fleeting::after {
  content: " ";
  position: absolute;
  top: 100%;
  /* At the bottom of the tooltip */
  left: 10%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: var(--input-bg) transparent transparent transparent;
}
.CodeMirror {
  border: 1px solid #eee;
}
.CodeMirror-scroll,
.CodeMirror,
.cm-s-darcula {
  height: 100%;
}</style><script defer="defer">(()=>{"use strict";var n={257:(n,e,t)=>{t.d(e,{Z:()=>c});var r=t(81),o=t.n(r),a=t(645),i=t.n(a)()(o());i.push([n.id,"@font-face {\n  font-family: 'Nunito';\n  font-style: normal;\n  font-weight: 400;\n  src: url(https://fonts.gstatic.com/s/nunito/v22/XRXI3I6Li01BKofiOc5wtlZ2di8HDLshdTQ3ig.ttf) format('truetype');\n}\n:root {\n  --input-bg: #494949;\n  --input-hover-bg: #525252;\n  --input-opposite-bg: #5a5a5a;\n  --transparent: rgba(0, 0, 0, 0);\n  --bg: #363636;\n  --bg-dark: #1e1e1e;\n  --text-colour: #fafafa;\n  --text-hover-colour: #cbcbcb;\n  --warning: #ff6f6f;\n}\nbody {\n  color: vaR(--text-colour);\n  background-color: vaR(--bg);\n}\n/* width */\n::-webkit-scrollbar {\n  width: 8px;\n  height: 8px;\n}\n/* Track */\n::-webkit-scrollbar-track {\n  background: #1a1a1a;\n}\n/* Handle */\n::-webkit-scrollbar-thumb {\n  background: #888;\n  border-radius: 4px;\n}\n/* Handle on hover */\n::-webkit-scrollbar-thumb:hover {\n  background: #555;\n  border-radius: 2px;\n}\nhtml,\nbody {\n  font-family: 'Nunito', serif;\n  font-size: 13px;\n  height: 100%;\n  margin: 0;\n  border: none;\n  padding: 0;\n}\n.empty-button {\n  border: none;\n  border-radius: 0;\n  padding: 5px;\n  margin: 0;\n  width: 100%;\n  text-align: left;\n  outline: none;\n}\n.short-button {\n  border: none;\n  border-radius: 2px;\n  padding: 5px;\n  margin: 2px;\n  width: 50px;\n  text-align: center;\n  background-color: vaR(--input-bg);\n  outline: none;\n  color: vaR(--text-colour);\n}\n.empty-button:hover {\n  background-color: #d4d4d4;\n}\n.button {\n  border: none;\n  border-radius: 2px;\n  padding: 5px;\n  margin: 2px;\n  width: 80%;\n  text-align: center;\n  background-color: vaR(--input-bg);\n  outline: none;\n  color: vaR(--text-colour);\n  text-decoration: none;\n}\n.button:hover:enabled {\n  background-color: vaR(--input-hover-bg);\n}\n.short-button:hover:enabled {\n  background-color: vaR(--input-hover-bg);\n}\ninput,\na,\nbutton {\n  color: vaR(--text-colour);\n  background-color: vaR(--input-bg);\n  border: none;\n  outline: none;\n  padding: 4px;\n  text-decoration: none;\n}\ninput:hover,\na:hover,\nbutton:hover {\n  background-color: vaR(--input-hover-bg);\n}\n.blur {\n  background-color: rgba(255, 255, 255, 0.1);\n  backdrop-filter: blur(10px);\n}\nsvg {\n  fill: vaR(--text-colour);\n}\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n#top-bar {\n  height: 40px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin: 5px 0;\n  border-bottom: 1px solid vaR(--input-bg);\n}\n.item {\n  margin: 10px;\n  text-decoration: none;\n  background: none;\n  font-size: 15px;\n}\n.item:hover {\n  background: none;\n  color: vaR(--text-hover-colour);\n}\n",""]);const c=i},645:n=>{n.exports=function(n){var e=[];return e.toString=function(){return this.map((function(e){var t="",r=void 0!==e[5];return e[4]&&(t+="@supports (".concat(e[4],") {")),e[2]&&(t+="@media ".concat(e[2]," {")),r&&(t+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),t+=n(e),r&&(t+="}"),e[2]&&(t+="}"),e[4]&&(t+="}"),t})).join("")},e.i=function(n,t,r,o,a){"string"==typeof n&&(n=[[null,n,void 0]]);var i={};if(r)for(var c=0;c<this.length;c++){var u=this[c][0];null!=u&&(i[u]=!0)}for(var s=0;s<n.length;s++){var l=[].concat(n[s]);r&&i[l[0]]||(void 0!==a&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=a),t&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=t):l[2]=t),o&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=o):l[4]="".concat(o)),e.push(l))}},e}},81:n=>{n.exports=function(n){return n[1]}},379:n=>{var e=[];function t(n){for(var t=-1,r=0;r<e.length;r++)if(e[r].identifier===n){t=r;break}return t}function r(n,r){for(var a={},i=[],c=0;c<n.length;c++){var u=n[c],s=r.base?u[0]+r.base:u[0],l=a[s]||0,d="".concat(s," ").concat(l);a[s]=l+1;var f=t(d),p={css:u[1],media:u[2],sourceMap:u[3],supports:u[4],layer:u[5]};if(-1!==f)e[f].references++,e[f].updater(p);else{var h=o(p,r);r.byIndex=c,e.splice(c,0,{identifier:d,updater:h,references:1})}i.push(d)}return i}function o(n,e){var t=e.domAPI(e);return t.update(n),function(e){if(e){if(e.css===n.css&&e.media===n.media&&e.sourceMap===n.sourceMap&&e.supports===n.supports&&e.layer===n.layer)return;t.update(n=e)}else t.remove()}}n.exports=function(n,o){var a=r(n=n||[],o=o||{});return function(n){n=n||[];for(var i=0;i<a.length;i++){var c=t(a[i]);e[c].references--}for(var u=r(n,o),s=0;s<a.length;s++){var l=t(a[s]);0===e[l].references&&(e[l].updater(),e.splice(l,1))}a=u}}},569:n=>{var e={};n.exports=function(n,t){var r=function(n){if(void 0===e[n]){var t=document.querySelector(n);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(n){t=null}e[n]=t}return e[n]}(n);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}},216:n=>{n.exports=function(n){var e=document.createElement("style");return n.setAttributes(e,n.attributes),n.insert(e,n.options),e}},565:(n,e,t)=>{n.exports=function(n){var e=t.nc;e&&n.setAttribute("nonce",e)}},795:n=>{n.exports=function(n){var e=n.insertStyleElement(n);return{update:function(t){!function(n,e,t){var r="";t.supports&&(r+="@supports (".concat(t.supports,") {")),t.media&&(r+="@media ".concat(t.media," {"));var o=void 0!==t.layer;o&&(r+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),r+=t.css,o&&(r+="}"),t.media&&(r+="}"),t.supports&&(r+="}");var a=t.sourceMap;a&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleTagTransform(r,n,e.options)}(e,n,t)},remove:function(){!function(n){if(null===n.parentNode)return!1;n.parentNode.removeChild(n)}(e)}}}},589:n=>{n.exports=function(n,e){if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}},480:function(){var n=this&&this.__assign||function(){return n=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n},n.apply(this,arguments)},e=this&&this.__awaiter||function(n,e,t,r){return new(t||(t=Promise))((function(o,a){function i(n){try{u(r.next(n))}catch(n){a(n)}}function c(n){try{u(r.throw(n))}catch(n){a(n)}}function u(n){var e;n.done?o(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(i,c)}u((r=r.apply(n,e||[])).next())}))},t=this&&this.__generator||function(n,e){var t,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(n,i)}catch(n){a=[6,n],r=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};function r(){return e(this,void 0,void 0,(function(){var n;return t(this,(function(e){switch(e.label){case 0:return n=window.location.href,window.location.href="https://entropyengine.dev/accounts/error?type=serverPingFailed&cb="+encodeURIComponent(n),[4,new Promise((function(n){}))];case 1:return e.sent(),[2]}}))}))}var o="https://entropyengine.dev:".concat("50001"),a=!1;function i(){return e(this,void 0,void 0,(function(){var n=this;return t(this,(function(o){return a=!0,[2,new Promise((function(o){return e(n,void 0,void 0,(function(){var n=this;return t(this,(function(a){switch(a.label){case 0:return a.trys.push([0,4,,6]),[4,window.request("ping").catch((function(){return e(n,void 0,void 0,(function(){return t(this,(function(n){switch(n.label){case 0:return[4,r()];case 1:return n.sent(),[2]}}))}))}))];case 1:return a.sent().ok?[3,3]:[4,r()];case 2:a.sent(),a.label=3;case 3:return[3,6];case 4:return a.sent(),[4,r()];case 5:return a.sent(),[3,6];case 6:return o(),[2]}}))}))}))]}))}))}window.request=function(c,u){return void 0===u&&(u={}),e(void 0,void 0,void 0,(function(){var e,s;return t(this,(function(t){switch(t.label){case 0:return a?[3,2]:[4,i()];case 1:t.sent(),t.label=2;case 2:return(s=window.apiToken).user||(s.user=localStorage.id),[4,fetch("".concat(o,"/").concat(c),{method:"POST",body:JSON.stringify(n(n({},u),{token:window.apiToken}))}).catch(r)];case 3:return(e=t.sent())?[4,e.json()]:[2,{error:"no response"}];case 4:return[2,t.sent()]}}))}))}},316:function(){var n=this&&this.__awaiter||function(n,e,t,r){return new(t||(t=Promise))((function(o,a){function i(n){try{u(r.next(n))}catch(n){a(n)}}function c(n){try{u(r.throw(n))}catch(n){a(n)}}function u(n){var e;n.done?o(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(i,c)}u((r=r.apply(n,e||[])).next())}))},e=this&&this.__generator||function(n,e){var t,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(n,i)}catch(n){a=[6,n],r=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};window.signOut=function(){localStorage.id=void 0},window.forceSignOut=function(n){window.signOut(),window.location.href="https://entropyengine.dev/accounts/error?type="+n},window.validID=function(t){return n(void 0,void 0,void 0,(function(){var n;return e(this,(function(e){switch(e.label){case 0:return(n=![void 0,0,"0",null,""," ",[],"undefined","null","none"].includes(t))?[4,window.request("user-exists",{user:t})]:[3,2];case 1:n=!!e.sent().exists,e.label=2;case 2:return[2,n]}}))}))},window.mustBeSignedIn=function(t,r){return n(void 0,void 0,void 0,(function(){return e(this,(function(n){switch(n.label){case 0:return[4,window.validID(localStorage.id)];case 1:return n.sent()?(t(),[2]):(window.forceSignOut("notSignedIn"),r&&r(),[2])}}))}))};var t=window.location.search,r=new URLSearchParams(t);window.urlParam=function(n){return r.get(n)},window.sleep=function(n){return new Promise((function(e){return setTimeout(e,n)}))},window.genCacheBust=function(){return Math.ceil(1e4*Math.random())},window.secondsToReadable=function(n){var e=n,t=n/60,r=t/60,o=r/24,a=o/365,i="";return a>=1&&(i+="".concat(Math.floor(a)," years "),o%=365),o>=1&&e<3154e4&&(i+="".concat(Math.floor(o)," days "),r%=24),r>=1&&e<86400&&(i+="".concat(Math.floor(r)," hours "),t%=60),t>=1&&e<2600&&(i+="".concat(Math.floor(t)," minutes "),n%=60),e<60&&(i+="".concat(n," seconds")),i},window.unixTimeAgo=function(n){return window.secondsToReadable(Math.round((new Date).getTime()/1e3)-n)},window.nameFromScriptURL=function(n){var e=n.substring(n.lastIndexOf("/")+1);return e.substring(0,e.length-3)},window.copyToClipboard=function(n){var e=document.createElement("input");e.style.position="absolute",e.style.position="-10000px",e.value=n,e.select(),e.setSelectionRange(0,99999),document.execCommand("copy"),e.innerText="",document.removeChild(e)}}},e={};function t(r){var o=e[r];if(void 0!==o)return o.exports;var a=e[r]={id:r,exports:{}};return n[r].call(a.exports,a,a.exports,t),a.exports}t.n=n=>{var e=n&&n.__esModule?()=>n.default:()=>n;return t.d(e,{a:e}),e},t.d=(n,e)=>{for(var r in e)t.o(e,r)&&!t.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:e[r]})},t.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),(()=>{var n=t(379),e=t.n(n),r=t(795),o=t.n(r),a=t(569),i=t.n(a),c=t(565),u=t.n(c),s=t(216),l=t.n(s),d=t(589),f=t.n(d),p=t(257),h={};h.styleTagTransform=f(),h.setAttributes=u(),h.insert=i().bind(null,"head"),h.domAPI=o(),h.insertStyleElement=l(),e()(p.Z,h),p.Z&&p.Z.locals&&p.Z.locals,t(316),t(480);window.apiToken={user:localStorage.id};var v=function(){return n=void 0,e=void 0,r=function(){var n,e;return function(n,e){var t,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(n,i)}catch(n){a=[6,n],r=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,(function(t){switch(t.label){case 0:return n=performance.now(),[4,fetch("https://entropyengine.dev:50001/ping",{method:"POST",body:JSON.stringify({})})];case 1:return[4,t.sent().json()];case 2:return t.sent().ok?(e=performance.now()-n,$("#ping").html(Math.floor(e).toFixed(0)),[2]):(console.error("Server ping failed"),[2])}}))},new((t=void 0)||(t=Promise))((function(o,a){function i(n){try{u(r.next(n))}catch(n){a(n)}}function c(n){try{u(r.throw(n))}catch(n){a(n)}}function u(n){var e;n.done?o(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(i,c)}u((r=r.apply(n,e||[])).next())}));var n,e,t,r};setInterval(v,5e3),v()})()})();</script><script defer="defer">/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var __webpack_modules__={745:e=>{(()=>{var t={768:function(e){e.exports=(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Context:()=>Z,ESArray:()=>U,ESBoolean:()=>$,ESError:()=>Re,ESErrorPrimitive:()=>O,ESFunction:()=>M,ESJSBinding:()=>B,ESNamespace:()=>N,ESNumber:()=>D,ESObject:()=>R,ESPrimitive:()=>E,ESString:()=>L,ESSymbol:()=>j,ESType:()=>A,ESUndefined:()=>I,ExpectedCharError:()=>Me,IS_NODE_INSTANCE:()=>f,IllegalCharError:()=>Ne,ImportError:()=>$e,IndexError:()=>Le,InvalidOperationError:()=>je,InvalidRuntimeError:()=>Ge,InvalidSyntaxError:()=>Be,KEYWORDS:()=>p,N_array:()=>ce,N_binOp:()=>re,N_break:()=>Te,N_class:()=>_e,N_continue:()=>ke,N_emptyObject:()=>fe,N_for:()=>ue,N_functionCall:()=>de,N_functionDefinition:()=>pe,N_if:()=>se,N_indexed:()=>me,N_namespace:()=>be,N_number:()=>we,N_objectLiteral:()=>le,N_primWrapper:()=>Ee,N_return:()=>ve,N_statements:()=>he,N_string:()=>ge,N_unaryOp:()=>ie,N_undefined:()=>Se,N_varAssign:()=>oe,N_variable:()=>xe,N_while:()=>ae,N_yield:()=>ye,Node:()=>ne,ReferenceError:()=>Ue,TestFailed:()=>We,TypeError:()=>De,colours:()=>z,deepClone:()=>Oe,digits:()=>r,doubleCharTokens:()=>x,global:()=>u,identifierChars:()=>i,importCache:()=>m,indent:()=>Ae,init:()=>Ke,interpretResult:()=>te,libs:()=>d,multiLineCommentEnd:()=>a,multiLineCommentStart:()=>s,now:()=>v,primitiveMethods:()=>T,refreshPerformanceNow:()=>y,run:()=>Qe,runningInNode:()=>h,setGlobalContext:()=>c,singleCharTokens:()=>g,singleLineComment:()=>o,sleep:()=>Pe,str:()=>Ce,stringSurrounds:()=>l,strip:()=>W,tokenType:()=>_,tokenTypeString:()=>w,tripleCharTokens:()=>S,tt:()=>b,types:()=>k,validURI:()=>Ie,wrap:()=>G});class n{constructor(e,t,n,r="(unknown)"){this.idx=e,this.ln=t,this.col=n,this.file=r}advance(e=""){return this.idx++,this.col++,"\n"===e&&(this.ln++,this.col=0),this}get clone(){return new n(this.idx,this.ln,this.col,this.file)}get str(){return`File ${this.file}, ${this.ln+1}:${this.col+1}`}get isUnknown(){return-2===this.idx}static get unknown(){return new n(-2,-2,-2,"(unknown)")}}const r="0123456789",i="_$abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",o="//",s="/*",a="*/";let u;const c=e=>{u=e},l=["'","`",'"'];let f="undefined"==typeof window;const h=()=>{f=!0},d={print:console.log},p=["var","let","global","local","mutable","const","if","else","while","for","in","continue","break","func","return","yield","class","extends","namespace","export"];let v=()=>0;function y(e){return t=this,r=function*(){v=e?()=>Date.now():()=>{try{return null===performance||void 0===performance?void 0:performance.now()}catch(e){return 0}}},new((n=void 0)||(n=Promise))((function(e,i){function o(e){try{a(r.next(e))}catch(e){i(e)}}function s(e){try{a(r.throw(e))}catch(e){i(e)}}function a(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(e){e(r)}))).then(o,s)}a((r=r.apply(t,[])).next())}));var t,n,r}y(f);const m={};var _;!function(e){e[e.NUMBER=0]="NUMBER",e[e.STRING=1]="STRING",e[e.ENDSTATEMENT=2]="ENDSTATEMENT",e[e.IDENTIFIER=3]="IDENTIFIER",e[e.KEYWORD=4]="KEYWORD",e[e.COMMA=5]="COMMA",e[e.ASSIGN=6]="ASSIGN",e[e.ADD=7]="ADD",e[e.SUB=8]="SUB",e[e.MUL=9]="MUL",e[e.DIV=10]="DIV",e[e.POW=11]="POW",e[e.OPAREN=12]="OPAREN",e[e.CPAREN=13]="CPAREN",e[e.OBRACES=14]="OBRACES",e[e.CBRACES=15]="CBRACES",e[e.OSQUARE=16]="OSQUARE",e[e.CSQUARE=17]="CSQUARE",e[e.EQUALS=18]="EQUALS",e[e.NOTEQUALS=19]="NOTEQUALS",e[e.NOT=20]="NOT",e[e.GT=21]="GT",e[e.LT=22]="LT",e[e.GTE=23]="GTE",e[e.LTE=24]="LTE",e[e.AND=25]="AND",e[e.OR=26]="OR",e[e.COLON=27]="COLON",e[e.DOT=28]="DOT",e[e.EOF=29]="EOF",e[e.BITWISE_OR=30]="BITWISE_OR",e[e.BITWISE_AND=31]="BITWISE_AND",e[e.BITWISE_NOT=32]="BITWISE_NOT"}(_||(_={}));let b=_;const w={[b.NUMBER]:"Number",[b.STRING]:"String",[b.ENDSTATEMENT]:";",[b.IDENTIFIER]:"Identifier",[b.KEYWORD]:"Keyword",[b.COMMA]:",",[b.OBRACES]:"{",[b.CBRACES]:"}",[b.OPAREN]:"(",[b.CPAREN]:")",[b.OSQUARE]:"[",[b.CSQUARE]:"]",[b.ASSIGN]:"=",[b.ADD]:"+",[b.SUB]:"-",[b.MUL]:"*",[b.DIV]:"/",[b.POW]:"^",[b.EQUALS]:"==",[b.NOTEQUALS]:"!=",[b.NOT]:"!",[b.GT]:">",[b.LT]:"<",[b.GTE]:">=",[b.LTE]:"<=",[b.AND]:"&&",[b.OR]:"||",[b.COLON]:":",[b.DOT]:".",[b.EOF]:"End of File",[b.BITWISE_AND]:"&",[b.BITWISE_OR]:"|",[b.BITWISE_NOT]:"~"},g={"*":b.MUL,"/":b.DIV,"+":b.ADD,"-":b.SUB,"(":b.OPAREN,")":b.CPAREN,"^":b.POW,"{":b.OBRACES,"}":b.CBRACES,",":b.COMMA,"[":b.OSQUARE,"]":b.CSQUARE,";":b.ENDSTATEMENT,":":b.COLON,".":b.DOT,"=":b.ASSIGN,">":b.GT,"<":b.LT,"!":b.NOT,"|":b.BITWISE_OR,"&":b.BITWISE_AND,"~":b.BITWISE_NOT},x={"==":b.EQUALS,"!=":b.NOTEQUALS,">=":b.GTE,"<=":b.LTE,"+=":b.ASSIGN,"-=":b.ASSIGN,"*=":b.ASSIGN,"/=":b.ASSIGN,"&&":b.AND,"||":b.OR},S={},T=["__add__","__subtract__","__multiply__","__divide__","__pow__","__eq__","__gt__","__lt__","__and__","__or__","__bool__","__setProperty__","__getProperty__","__call__"],k={};class E{constructor(e,t=k.any){this.self=this,this.isa=(e,t)=>new $(t===this.__type__),this.is=(e,t)=>new $(t===this),this.valueOf=()=>this.__value__,this.typeName=()=>this.__type__.__name__,this.hasProperty=(e,t)=>new $(this.hasOwnProperty(Ce(t))),this.describe=(e,t)=>{this.info.isBuiltIn||(this.info.description=Ce(t))},this.detail=(e,t)=>{if(this.info.isBuiltIn)return;const r=W(t,e);if("object"!=typeof r)return new De(n.unknown,"object",this.typeName(),Ce(this));this.info=Object.assign(Object.assign({},this.info),r),this.info.isBuiltIn=!1},this.__type__=t||this,this.__value__=e,this.info={}}__add__(e,t){return new je("",this)}__subtract__(e,t){return new je("",this)}__multiply__(e,t){return new je("",this)}__divide__(e,t){return new je("",this)}__pow__(e,t){return new je("__pow__",this)}__eq__(e,t){return new je("__eq__",this)}__gt__(e,t){return new je("__gt__",this)}__lt__(e,t){return new je("__lt__",this)}__and__(e,t){return new je("__and__",this)}__or__(e,t){return new je("__or__",this)}__bool__(e){return new je("__bool__",this)}__setProperty__(e,t,n){return new je("__setProperty__",this,`[${Ce(t)}] = ${Ce(n)}`)}__call__(e,...t){return new je("__call__",this)}}class O extends E{constructor(e=new Re(n.unknown,"Unknown","Error not specified")){super(e,k.error),this.__getProperty__=(e,t)=>{if(this.self.hasOwnProperty(Ce(t))){const e=this.self[Ce(t)];return"function"==typeof e?new M(e):G(e)}return new Le(n.unknown,t.valueOf(),this)},this.cast=({})=>new Re(n.unknown,"TypeError","Cannot cast type 'error'"),this.str=()=>new L(`<Error: ${this.valueOf().str}>`),this.__eq__=(e,t)=>new $(t instanceof O&&this.valueOf().constructor===t.valueOf().constructor),this.__bool__=()=>new $(!0),this.bool=this.__bool__,this.clone=()=>new O(this.valueOf())}}function C(e,t,r,i,o){if(!(t instanceof A))return new De(n.unknown,"Type",typeof t,t);const s=new M((({context:e},...n)=>{const s=new Z;if(s.parent=e,t.__extends__){let e=C(s,t.__extends__,r,i,o);if(e instanceof Re)return e}const a=null==t?void 0:t.__init__;if(!a)return;a.this_=i,a.__closure__=s;const u=a.__call__({context:s},...n);return u instanceof Re?u:void 0}),void 0,"super",i);let a=e.setOwn("super",s);if(a instanceof Re)return a;const u=P(t,{context:e},[],!1,r);return u instanceof Re?u:void 0}function P(e,{context:t},n,r=!0,i={}){var o;if(e.__isPrimitive__){if(n.length<1)return new I;switch(e.__name__){case"Undefined":case"Type":return n.length<1?new A:new L(n[0].__type__.__name__);case"String":return new L(n[0].str().valueOf());case"Array":return new U(n);case"Number":return new D(n[0].valueOf());case"Function":return new M(n[0].valueOf());case"Boolean":return new $(n[0].bool().valueOf());default:return G(n[0])}}const s=new Z;s.parent=null===(o=e.__init__)||void 0===o?void 0:o.__closure__;const a=new R;if(e.__extends__){let n=C(s,e.__extends__,i,a,t);if(n instanceof Re)return n}a.__value__=i;for(let t of e.__methods__){const e=t.clone();e.this_=a,i[t.name]=e,-1!==T.indexOf(t.name)&&(a[t.name]=e.__call__)}if(r&&e.__init__){e.__init__.this_=a,e.__init__.__closure__=s;const t=e.__init__.__call__({context:s},...n);if(t instanceof Re)return t}return a.__type__=e,e.__instances__.push(a),a}class A extends E{constructor(e=!1,t="(anon)",r=[],i,o){super(void 0,null==k?void 0:k.type),this.__instances__=[],this.clone=()=>new A(this.__isPrimitive__,this.__name__,this.__methods__,this.__extends__,this.__init__),this.isa=({},e)=>new $(e===k.type),this.cast=({},e)=>new je("cast",this),this.includesType=(e,t)=>{var n,r,i,o,s,a;return this.equals(e,k.any).bool().valueOf()||t.equals(e,k.any).bool().valueOf()||!0===(null===(n=this.__extends__)||void 0===n?void 0:n.equals(e,t).valueOf())||!0===(null===(r=this.__extends__)||void 0===r?void 0:r.equals(e,k.any).valueOf())||!0===(null===(i=this.__extends__)||void 0===i?void 0:i.includesType(e,t).valueOf())||!0===(null===(o=t.__extends__)||void 0===o?void 0:o.equals(e,this).valueOf())||!0===(null===(s=t.__extends__)||void 0===s?void 0:s.equals(e,k.any).valueOf())||!0===(null===(a=t.__extends__)||void 0===a?void 0:a.includesType(e,this).valueOf())?new $(!0):this.equals(e,t)},this.equals=({},e)=>new $(e.__name__===this.__name__&&e.__isPrimitive__===this.__isPrimitive__&&Object.is(this.valueOf(),e.valueOf())),this.__call__=({context:e},...t)=>P(this,{context:e},t||[]),this.str=()=>new L(`<Type: ${this.__name__}>`),this.__bool__=()=>new $(!0),this.bool=this.__bool__,this.__getProperty__=({},e)=>{if(this.self.hasOwnProperty(Ce(e))){const t=this.self[Ce(e)];return"function"==typeof t?new M(t):G(t)}return new Le(n.unknown,e.valueOf(),this)},this.__isPrimitive__=e,this.__name__=t,this.info.name=t,this.__extends__=i,this.__methods__=r,o&&(o.name=t,this.__init__=o),k.type||(this.__type__=this)}}class I extends E{constructor(){super(void 0,k.undefined),this.cast=({context:e},t)=>{switch(t){case k.number:return new D;case k.string:return new L;case k.array:return new U;case k.undefined:return new I;case k.type:return new A;case k.error:return new O;case k.object:case k.any:return new R;case k.function:return new M((()=>{}));case k.boolean:return new $;default:return t instanceof A?t.__call__({context:e}):new Re(n.unknown,"TypeError",`Cannot cast to type '${Ce(t.typeName())}'`)}},this.str=()=>new L("<Undefined>"),this.__eq__=({},e)=>new $(e instanceof I||void 0===e||void 0===e.valueOf()),this.__bool__=()=>new $,this.bool=this.__bool__,this.clone=()=>new I,this.__getProperty__=({},e)=>{if(this.self.hasOwnProperty(Ce(e))){const t=this.self[Ce(e)];return"function"==typeof t?new M(t):G(t)}return new Le(n.unknown,e.valueOf(),this)},this.info={name:"undefined",description:"Not defined, not a value.",file:"built-in",isBuiltIn:!0}}}class R extends E{constructor(e={}){super(e,k.object),this.isa=(e,t)=>t===k.object?new $(!0):t instanceof A?this.__type__.includesType(e,t):new De(n.unknown,"TypeError","type",Ce(t.typeName()),Ce(t)),this.cast=({},e)=>e===k.number?new D(this.valueOf()?1:0):new Re(n.unknown,"TypeError",`Cannot cast boolean to type '${Ce(e.typeName())}'`),this.str=()=>{let e=Ce(this.valueOf());return"\n"===e[e.length-1]&&(e=e.substr(0,e.length-1)),new L(`<ESObject ${e}>`)},this.__eq__=({context:e},t)=>{if(!(t instanceof R))return new $;if(t.keys.length!==this.keys.length)return new $;for(let n of this.keys){const r=n.valueOf(),i=this.valueOf()[r],o=t.valueOf()[r];if(!i){if(o)return new $;continue}if(!i.__eq__)return new $;const s=i.__eq__({context:e},o);if(s instanceof Re)return s;if(!s.valueOf())return new $}return new $(!0)},this.__bool__=()=>new $(!0),this.bool=this.__bool__,this.__add__=({context:e},t)=>{if(!(t instanceof R))return new De(n.unknown,"object",t.typeName().valueOf(),t);let r={};for(let t of this.keys){const n=t.valueOf(),i=this.__getProperty__({context:e},t);if(i instanceof Re)return i;r[n]=i}for(let n of t.keys){const i=n.valueOf();if(r.hasOwnProperty(i))continue;const o=t.__getProperty__({context:e},n);if(o instanceof Re)return o;r[i]=o}return new R(r)},this.__subtract__=(e,t)=>{let r=[];if(t instanceof L)r=[Ce(t)];else{if(!(t instanceof U))return new De(n.unknown,"array | string",t.typeName().valueOf(),t);r=W(t,e)}if(!Array.isArray(r))return new De(n.unknown,"array | string",t.typeName().valueOf(),t);let i={};for(let t of this.keys){const n=t.valueOf();if(-1===r.indexOf(n)){let r=this.__getProperty__(e,t);if(r instanceof Re)return r;i[n]=r}}return new R(i)},this.__getProperty__=({},e)=>{if(!(e instanceof L))return new De(n.unknown,"string",e.typeName(),Ce(e));const t=e.valueOf();if(this.valueOf().hasOwnProperty(t))return this.valueOf()[t];if(this.self.hasOwnProperty(t)){const e=this.self[t];return"function"==typeof e?new M(e):G(e)}return new I},this.__setProperty__=({},e,t)=>{if(!(e instanceof L))return new De(n.unknown,"string",e.typeName(),Ce(e));this.__value__[e.valueOf()]=t},this.hasProperty=(e,t)=>{const n=Ce(t);return this.valueOf().hasOwnProperty(Ce(n))?new $(!0):new $(this.hasOwnProperty(n))},this.clone=()=>{const e=new R;let t={},n=this.valueOf();for(let e of Object.keys(n))t[e]=n[e];return e.__value__=t,e}}get keys(){return Object.keys(this.valueOf()).map((e=>new L(e)))}set keys(e){}}class N extends E{constructor(e,t,r=!1){super(t,k.object),this.cast=({})=>new Re(n.unknown,"TypeError","Cannot cast type 'namespace'"),this.clone=()=>{let e={},t=this.valueOf();for(let n of Object.keys(t))e[n]=t[n];return new N(this.name,e)},this.str=()=>{const e=Object.keys(this.valueOf());return new L(`<Namespace ${Ce(this.name)}${e.length>0?": ":""}${e.slice(0,5)}${e.length>=5?"...":""}>`)},this.__eq__=({},e)=>new $(this===e),this.__bool__=()=>new $(!0),this.bool=this.__bool__,this.__getProperty__=({},e)=>{if(e instanceof L&&this.valueOf().hasOwnProperty(e.valueOf())){const t=this.valueOf()[e.valueOf()];if(t.isAccessible)return t.value}if(!(e instanceof L))return new De(n.unknown,"string",e.typeName());if(this.self.hasOwnProperty(Ce(e))){const t=this.self[Ce(e)];return"function"==typeof t?new M(t):G(t)}return new Le(n.unknown,e.valueOf(),this.self)},this.info.name=Ce(e),this.mutable=r}get name(){return new L(this.info.name)}set name(e){this.info.name=e.valueOf()}__setProperty__({},e,t){if(!(e instanceof L))return new De(n.unknown,"string",e.typeName().valueOf(),Ce(e));let r=Ce(e);if(!this.mutable)return new De(n.unknown,"mutable","immutable",`${Ce(this.name)}`);t instanceof E||(t=G(t));const i=this.__value__[r];return i?i.isConstant?new De(n.unknown,"mutable","immutable",`${Ce(this.name)}.${r}`):i.isAccessible?void(i.value=t):new De(n.unknown,"accessible","inaccessible",`${Ce(this.name)}.${r}`):new Re(n.unknown,"SymbolError",`Symbol ${r} is not declared in namespace ${Ce(this.name)}.`)}}class B extends E{constructor(e,t="<AnonNative>",r=!1){super(e,k.object),this.cast=({})=>new Re(n.unknown,"TypeError","Cannot cast native object"),this.clone=()=>new B(this.__value__),this.str=()=>{try{return new L(JSON.stringify(this.__value__))}catch(e){return new L(`${this.__value__}`)}},this.__eq__=({},e)=>new $(this===e),this.__bool__=()=>new $(!0),this.bool=this.__bool__,this.__getProperty__=(e,t)=>{const r=Ce(t),i=this.valueOf(),o=i[r];if(void 0===o){if(this.self.hasOwnProperty(r)){const e=this.self[Ce(r)];return"function"==typeof e?new M(e):G(e)}return new Le(n.unknown,r,this)}return o instanceof E?o:"function"==typeof o?new M((({context:t},...n)=>i[r](...n.map((t=>W(t,e)))))):new B(o)},this.__call__=(e,...t)=>{if("function"!=typeof this.__value__)return new De(n.unknown,"function",typeof this.__value__,Ce(this));let r;try{r=new this.__value__(...t.map((t=>W(t,e))))}catch(n){r=this.__value__(...t.map((t=>W(t,e))))}return r instanceof E?r:new B(r)},this.hasProperty=(e,t)=>new $(!(this.__getProperty__(e,t)instanceof Re)),this.info.name=Ce(t)}}k.type=new A(!0,"Type"),k.undefined=new A(!0,"Undefined"),k.string=new A(!0,"String"),k.array=new A(!0,"Array"),k.number=new A(!0,"Number"),k.any=new A(!0,"Any"),k.function=new A(!0,"Function"),k.bool=new A(!0,"Boolean"),k.object=new A(!0,"Object"),k.error=new A(!0,"Error"),k.any.info={name:"any",description:"Matches any other type",file:"built-in",isBuiltIn:!0},k.number.info={name:"any",description:"The ES Number type. Is a a double-precision 64-bit binary format IEEE 754 value, like double in Java and C#",file:"built-in",isBuiltIn:!0},k.string.info={name:"string",description:"The ES String type. Holds an array of characters, and can be defined with any of ', \" and `. Can be indexed like an array.",file:"built-in",isBuiltIn:!0},k.bool.info={name:"bool",description:"The ES Bool type. Exactly two instances exist, true and false.",file:"built-in",isBuiltIn:!0},k.function.info={name:"function",description:"The ES Function type. Is a block of code which executes when called and takes in 0+ parameters.",file:"built-in",isBuiltIn:!0},k.array.info={name:"array",description:"The ES Array type. Defines a set of items of any type which can be accessed by an index with [].",file:"built-in",isBuiltIn:!0},k.object.info={name:"object",description:"The ES Object type. Similar to JS objects or python dictionaries.",file:"built-in",isBuiltIn:!0},k.error.info={name:"error",description:"The ES Error type. Call to throw an error.",file:"built-in",isBuiltIn:!0},k.type.info={name:"type",description:"The ES Type type. Call to get the type of a value at a string.",file:"built-in",isBuiltIn:!0};class M extends E{constructor(e=(()=>{}),t=[],r="(anon)",i=new R,o=k.any,s=u){super(e,k.function),this.cast=({},e)=>new Re(n.unknown,"TypeError","Cannot cast type 'function'"),this.clone=()=>new M(this.__value__,this.arguments_,this.name,this.this_,this.returnType,this.__closure__),this.valueOf=()=>this,this.str=()=>new L(`<Func: ${this.name}>`),this.__eq__=({},e)=>new $(e instanceof M&&this.__value__===e.__value__),this.__bool__=()=>new $(!0),this.bool=this.__bool__,this.__call__=({context:e},...t)=>(this.__closure__.path=e.path,function(e,t,r){var i;let o=e;(e=t.__closure__).path=o.path;const s=t.__value__,a=function(e,t,r){const i=new Z;i.parent=r;let o=Math.max(e.length,t.arguments_.length);for(let s=0;s<o;s++){let o=new I,a=k.any;if(!t.arguments_[s])continue;const u=t.arguments_[s];if(!(u.type instanceof A))return new De(n.unknown,"Type",typeof u.type,u.type);if(e[s]instanceof E&&(a=e[s].__type__,o=e[s]),!u.type.includesType({context:r},a).bool().valueOf())return new De(n.unknown,u.type.__name__,a.__name__,Ce(o));i.setOwn(u.name,o,{forceThroughConst:!0})}let s=i.setOwn("args",new U(e),{forceThroughConst:!0});return s instanceof Re?s:i}(r,t,e);if(a instanceof Re)return a;let u=null!==(i=t.this_)&&void 0!==i?i:new R;if(!(u instanceof R))return new De(n.unknown,"object",typeof u,u,"'this' must be an object");let c=a.setOwn("this",u);return c instanceof Re?c:s instanceof ne?function(e,t,r,i){var o,s,a,u;const c=i.interpret(t);return c.error?c.error:(void 0!==c.funcReturn&&(c.val=c.funcReturn,c.funcReturn=void 0),!1===e.returnType.includesType({context:t},null!==(s=null===(o=c.val)||void 0===o?void 0:o.__type__)&&void 0!==s?s:k.any).valueOf()?new De(n.unknown,e.returnType.__name__,(null===(a=c.val)||void 0===a?void 0:a.typeName().valueOf())||"undefined",null===(u=c.val)||void 0===u?void 0:u.str().valueOf(),"(from function return)"):c.val?c.val:new I)}(t,a,0,s):"function"==typeof s?function(e,t,n,r){for(let e=n.length;e<r.length;e++)n.push(new I);const i=r({context:t},...n);return i instanceof Re||i instanceof E?i:new I}(0,a,r,s):new De(n.unknown,"function",typeof s)}(this.__closure__,this,t)),this.__getProperty__=({},e)=>{if(this.self.hasOwnProperty(Ce(e))){const t=this.self[Ce(e)];return"function"==typeof t?new M(t):G(t)}return new Le(n.unknown,e.valueOf(),this)},this.arguments_=t,this.info.name=r,this.this_=i,this.returnType=o,this.__closure__=s,this.info.returnType=Ce(o),this.info.args=t.map((e=>({name:e.name,defaultValue:Ce(e.defaultValue),type:e.type.info.name,required:!0})))}get name(){var e;return null!==(e=this.info.name)&&void 0!==e?e:"(anonymous)"}set name(e){this.info.name=e}}class D extends E{constructor(e=0){super(e,k.number),this.cast=({},e)=>{switch(e){case k.number:return this;case k.string:return this.str();case k.array:return new U(new Array(this.valueOf()));default:return new Re(n.unknown,"TypeError",`Cannot cast to type '${Ce(e.typeName())}'`)}},this.str=()=>new L(this.valueOf().toString()),this.__add__=({},e)=>e instanceof D?new D(this.valueOf()+e.valueOf()):new De(n.unknown,"Number",e.typeName().valueOf(),e.valueOf()),this.__subtract__=({},e)=>e instanceof D?new D(this.valueOf()-e.valueOf()):new De(n.unknown,"Number",e.typeName().valueOf(),e.valueOf()),this.__multiply__=({},e)=>e instanceof D?new D(this.valueOf()*e.valueOf()):new De(n.unknown,"Number",e.typeName().valueOf(),e.valueOf()),this.__divide__=({},e)=>e instanceof D?new D(this.valueOf()/e.valueOf()):new De(n.unknown,"Number",e.typeName().valueOf(),e.valueOf()),this.__pow__=({},e)=>e instanceof D?new D(Math.pow(this.valueOf(),e.valueOf())):new De(n.unknown,"Number",e.typeName().valueOf(),e.valueOf()),this.__eq__=({},e)=>new $(e instanceof D&&this.valueOf()===e.valueOf()),this.__gt__=({},e)=>e instanceof D?new $(this.valueOf()>e.valueOf()):new De(n.unknown,"Number",e.typeName().valueOf(),e.valueOf()),this.__lt__=({},e)=>e instanceof D?new $(this.valueOf()<e.valueOf()):new De(n.unknown,"Number",e.typeName().valueOf(),e.valueOf()),this.__bool__=()=>new $(this.valueOf()>0),this.bool=this.__bool__,this.clone=()=>new D(this.valueOf()),this.__getProperty__=({},e)=>{if(this.self.hasOwnProperty(Ce(e))){const t=this.self[Ce(e)];return"function"==typeof t?new M(t):G(t)}return new Le(n.unknown,e.valueOf(),this)}}}class $ extends E{constructor(e=!1){super(Boolean(e),k.bool),this.__getProperty__=(e,t)=>{if(this.self.hasOwnProperty(Ce(t))){const e=this.self[Ce(t)];return"function"==typeof e?new M(e):G(e)}return new Le(n.unknown,t.valueOf(),this)},this.cast=(e,t)=>t===k.number?new D(this.valueOf()?1:0):new Re(n.unknown,"TypeError",`Cannot cast boolean to type '${Ce(t.typeName())}'`),this.__eq__=(e,t)=>t instanceof $?new $(this.valueOf()===t.valueOf()):new De(n.unknown,"Boolean",t.typeName().valueOf(),t.valueOf()),this.__bool__=()=>this,this.__and__=(e,t)=>new $(this.valueOf()&&t.bool().valueOf()),this.__or__=(e,t)=>new $(this.valueOf()||t.bool().valueOf()),this.str=()=>new L(this.valueOf()?"true":"false"),this.clone=()=>new $(this.valueOf()),this.bool=()=>this,this.info={name:Ce(e),description:`Boolean global constant which evaluates to ${Ce(e)}, the opposite of ${Ce(!e)}`,file:"built-in",isBuiltIn:!0,helpLink:"https://en.wikipedia.org/wiki/Boolean_expression"}}}class U extends E{constructor(e=[]){super(e,k.array),this.cast=({},e)=>{switch(e){case k.number:return new D(this.len);case k.boolean:return this.bool();default:return new Re(n.unknown,"TypeError",`Cannot cast boolean to type '${Ce(e.typeName())}'`)}},this.str=()=>new L(Ce(this.valueOf())),this.__eq__=({context:e},t)=>{if(!(t instanceof U))return new $;if(t.len!==this.len)return new $;for(let n=0;n<this.len;n++){const r=this.valueOf()[n],i=t.valueOf()[n];if(!r){if(i)return new $;continue}if(!r.__eq__)return new $;const o=r.__eq__({context:e},i);if(o instanceof Re)return o;if(!o.valueOf())return new $}return new $(!0)},this.__add__=({context:e},t)=>t instanceof U?new U([...this.valueOf(),...t.valueOf()]):new De(n.unknown,"array",t.typeName().valueOf(),t),this.__bool__=()=>new $(this.valueOf().length>0),this.bool=this.__bool__,this.__getProperty__=({},e)=>{if(e instanceof L&&this.self.hasOwnProperty(Ce(e))){const t=this.self[Ce(e)];return"function"==typeof t?new M(t):G(t)}if(!(e instanceof D))return new I;let t=e.valueOf();for(;t<0;)t=this.valueOf().length+t;return t<this.valueOf().length?this.valueOf()[t]:new I},this.add=({},e,t=new D(this.len-1))=>{if(!(e instanceof E))throw"adding non-primitive to array: "+Ce(e);return this.len++,this.__value__.splice(t.valueOf(),0,e),new D(this.len)},this.contains=({},e)=>{for(let t of this.__value__)if(e.valueOf()==t.valueOf())return!0;return!1},this.clone=()=>{const e=[];for(let t of this.valueOf())e.push(t);return new U(e)},this.len=e.length}__setProperty__({},e,t){if(!(e instanceof D))return;t instanceof E||(t=G(t));let n=e.valueOf();for(;n<0;)n=this.valueOf().length+n;this.__value__[n]=t}}class L extends E{constructor(e=""){super(e,k.string),this.str=()=>this,this.cast=({},e)=>{switch(e){case k.number:const t=parseFloat(this.valueOf());return isNaN(t)?new Re(n.unknown,"TypeError","This string is not a valid number"):new D(t);case k.string:return this;case k.array:return new U(this.valueOf().split("").map((e=>new L(e))));default:return new Re(n.unknown,"TypeError",`Cannot cast to type '${Ce(e.typeName())}'`)}},this.__add__=({},e)=>e instanceof L?new L(this.valueOf()+e.valueOf()):new De(n.unknown,"String",e.typeName().valueOf(),e.valueOf()),this.__multiply__=({},e)=>e instanceof D?new L(this.valueOf().repeat(e.valueOf())):new De(n.unknown,"Number",e.typeName().valueOf(),e.valueOf()),this.__eq__=({},e)=>new $(e instanceof L&&this.valueOf()===e.valueOf()),this.__gt__=({},e)=>e instanceof L?new $(this.valueOf().length>e.valueOf().length):new De(n.unknown,"String",e.typeName().valueOf(),e.valueOf()),this.__lt__=({},e)=>e instanceof L?new $(this.valueOf().length<e.valueOf().length):new De(n.unknown,"String",e.typeName().valueOf(),e.valueOf()),this.__bool__=()=>new $(this.valueOf().length>0),this.bool=this.__bool__,this.len=()=>new D(this.valueOf().length),this.clone=()=>new L(this.valueOf()),this.__getProperty__=(e,t)=>{if(t instanceof L&&this.self.hasOwnProperty(Ce(t))){const e=this.self[Ce(t)];return"function"==typeof e?new M(e):G(e)}if(!(t instanceof D))return new L;let n=t.valueOf();for(;n<0;)n=this.valueOf().length+n;return n<this.valueOf().length?new L(this.valueOf()[n]):new L}}__setProperty__({},e,t){if(!(e instanceof D))return;t instanceof L||(t=new L(Ce(t)));let n=e.valueOf();for(;n<0;)n=this.valueOf().length+n;const r=t.str().valueOf();let i=this.__value__.substr(0,n),o=this.__value__.substr(n+r.length);this.__value__=i+r+o}}class j{constructor(e,t,n={}){var r,i;this.clone=()=>new j(this.value.clone(),this.identifier,{isConstant:this.isConstant,isAccessible:this.isAccessible}),this.str=()=>new L(`<Symbol: ${this.identifier}>`),this.value=e,this.identifier=t,this.isConstant=null!==(r=n.isConstant)&&void 0!==r&&r,this.isAccessible=null===(i=n.isAccessible)||void 0===i||i}}function G(e,t=!1){return e instanceof E?e:null==e?new I:e instanceof Re?new O(e):e instanceof j?e.value:"number"==typeof e?new D(e):"string"==typeof e?new L(e):"boolean"==typeof e?new $(e):"bigint"==typeof e?new D(Number(e)):"symbol"==typeof e?new L(String(e)):new B(e,void 0,t)}function W(e,t){if(null!=e){if(!(e instanceof E))return e;if(e instanceof U)return e.valueOf().map((e=>W(e,t)),t);if(e instanceof R){let n={};for(let r in e.valueOf())n[r]=W(e.valueOf()[r],t);return n}if(!(e instanceof I))return e instanceof M?(...n)=>{const r=e.__call__(t,...n.map((e=>G(e))));return r instanceof Re?r:W(r,t)}:e instanceof A?e:e.valueOf()}}const q={red:31,yellow:33,green:32,cyan:36,blue:34,grey:2},F={};for(let e of Object.keys(q))F[e]=t=>(t||(t=""),f?`[${q[e]}m`+t+"[0m":`<span style="color: ${e}">${t}</span>`);const z=F,V={range:[({context:e},t)=>{if(!(t instanceof D))return new De(n.unknown,"Number",t.typeName().valueOf(),t.valueOf());const r=t.valueOf();try{return new U([...Array(r).keys()].map((e=>new D(e))))}catch(e){return new Re(n.unknown,"RangeError",`Cannot make range of length '${Ce(t)}'`)}},{args:[{name:"N",type:"Number"}],description:"Generates an array of integers given N. Starts at 0 and goes to N-1. Can be used like for i in range(10) ..., similarly to python.",returns:"array of numbers from 0 to N-1",returnType:"number[] | RangeError"}],log:[({context:e},...t)=>{console.log(...t.map((e=>Ce(e))))},{args:[{name:"...values",type:"any[]"}],description:"Uses console.log to log all values",returnType:"void"}],parseNum:[({context:e},t)=>{try{const e=parseFloat(Ce(t));return isNaN(e)?new Re(n.unknown,"TypeError",`Cannot convert '${Ce(t)}' to a number.`):new D(e)}catch(e){return new Re(n.unknown,"TypeError",`Cannot convert '${Ce(t)}' to a number.`)}},{args:[{name:"num",type:"any"}],description:"Converts a string of digits into a number. Works with decimals and integers. Calls .str() on value before using native JS 'parseFloat' function. Returns TypeError if the string can't be converted into a number.",returnType:"number | TypeError"}],help:[({context:e},...t)=>{if(!t.length)return new L("Visit https://entropygames.io/entropy-script for help with Entropy Script!\nTry 'help(<anything>)' for help about a particular object.");let n="";for(const e of t){if(!(e instanceof E))return void console.log("Invalid arg not primitive: "+Ce(e));const t=e.info;if(n+=`${z.yellow(`Help on '${t.name||"(anonymous)"}'`)}:\n    \n    ${z.yellow("Value")}: ${Ae(Ae(Ce(e)))}\n    ${z.yellow("Type")}: '${Ce(e.typeName())}'\n    ${z.yellow("Location")}: ${t.file||z.yellow("(unknown)")}\n    \n        ${z.green(t.description)||"No description."}\n        \n    ${t.helpLink?z.cyan(t.helpLink+"\n\n"):""}\n`,t.args&&e instanceof M){const e=t.args.length,r=t.args.filter((e=>e.required)).length;n+=e==r?z.yellow(`    Arguments (${e}): \n`):z.yellow(`    Arguments (${r}-${e}): \n`);for(const[e,r]of t.args.entries())n+="object"!=typeof r?`        ${e+1}. INVALID ARG INFO`:`        ${e+1}. ${r.name}${!1===r.required?z.yellow(" (optional) "):" "}{${r.type}} ${r.description||""}\n`;n+="\n\n",t.returns&&(n+=`    Returns: ${t.returns}\n\n`),t.returnType&&(n+=`    Return Type: ${t.returnType}\n\n`)}if(t.contents&&(e instanceof R||e instanceof N)){n+="    Properties: \n      ";for(let e of t.contents)n+=e.name+"\n      "}}return console.log(n),t.length>1?new U(t):t?t[0]:void 0},{args:[{name:"value",type:"any"}],description:"logs info on value",returns:"value passed in"}],delete:[({context:e},t)=>{const r=Ce(t);if(!e.has(r))return new Re(n.unknown,"DeleteError",`Identifier '${r}' not found in the current context`);e.set(r,new I)},{name:"delete",args:[{name:"identifier",type:"string"}],description:"Deletes a variable from the current context"}],__path:[({context:e})=>new L(e.path),{name:"__path",args:[],description:"Returns the current path"}],__symbols:[({context:e})=>G(e.keys),{name:"__allSymbols",args:[],description:"Returns an array of the names of all symbols in the current context"}],using:[({context:e},t,r)=>{if(!(t instanceof N||t instanceof B))return new De(n.unknown,"Namespace",Ce(t.typeName()));let i=!0;r&&(r.bool().valueOf()||(i=!1));const o=t.valueOf();i?e=e.root:e.parent&&(e=e.parent);for(const t of Object.keys(o))e.setOwn(t,o[t].value,{isConstant:o[t].isConstant,isAccessible:o[t].isAccessible,forceThroughConst:!0})},{name:"using",args:[{name:"module",type:"namespace"},{name:"global",type:"bool"}],description:"Adds contents of a namespace to the global context"}],sleep:[({context:e},t,r)=>t instanceof D?r instanceof M?void Pe(t.valueOf()).then((()=>{const t=r.__call__({context:e});t instanceof Re&&console.log(t.str)})):new De(n.unknown,"function",Ce(r.typeName()),Ce(r)):new De(n.unknown,"number",Ce(t.typeName()),Ce(t)),{name:"sleep",args:[{name:"n",type:"number"},{name:"callback",type:"function"}],description:"Waits n milliseconds and then executes the callback"}]},K={ascii:{asciiToChar:(e,t)=>t instanceof D?new L(String.fromCharCode(t.valueOf())):new De(n.unknown,"number",Ce(t.typeName()),Ce(t)),charToAscii:(e,t)=>t instanceof L?new D(Ce(t).charCodeAt(0)):new De(n.unknown,"string",Ce(t.typeName()),Ce(t))},json:{parse:(e,t)=>new R(JSON.parse(Ce(t))),stringify:(e,t)=>t instanceof R?new L(JSON.stringify(W(t,e))):new De(n.unknown,"object",Ce(t.typeName()),Ce(t))}},Q={};function Y(e,t){const n={},r=e.valueOf();for(const e of Object.keys(r))n[e]=new j(r[e],e);return new B(n,t)}function H(e){return e in K||e in Q}function J(e){if(e in Q)return Q[e];if(e in K){const t=Y(new B(K[e]),e);return Q[e]=t,t}}function X(e,t,r){V.import=[({context:r},i,o)=>{if(f)return new Re(n.unknown,"ImportError","Is running in node instance but trying to run browser import function");const s=i.str();if(H(Ce(s)))return J(Ce(s));try{fetch(Ce(s)).then((e=>e.text())).then((i=>{return a=this,c=function*(){const a=new Z;a.parent=e;const u=yield Qe(i);u.error?t(new $e(n.unknown,Ce(s),u.error.str).str):o instanceof M&&o.__call__({context:r},new N(s,a.getSymbolTableAsDict()))},new((u=void 0)||(u=Promise))((function(e,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function r(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof u?i:new u((function(e){e(i)}))).then(n,r)}i((c=c.apply(a,[])).next())}));var a,u,c}))}catch(e){return new Re(n.unknown,"ImportError",e.toString())}},{}],V.print=[({context:e},...n)=>{let r="";for(let e of n)r+=Ce(e);t(r)},{}],V.input=[({context:e},t,n)=>{r(t.valueOf(),(t=>{let r=null==n?void 0:n.valueOf();if(r instanceof M){let n=r.__call__({context:e},new L(t));n instanceof Re&&console.log(n.str)}else"function"==typeof r&&r(t);return new L("'input()' does not return anything. Pass in a function as the second argument, which will take the user input as an argument.")}))},{}];for(let t in V){const n=new M(V[t][0],[],t,void 0,void 0,e);n.info=V[t][1],n.info.name=t,n.info.isBuiltIn=!0,n.info.file="built-in",e.set(t,n,{global:!0,isConstant:!0})}!function(e){const t={false:new $(!1),true:new $(!0),nil:new I,any:k.any,number:k.number,string:k.string,bool:k.bool,function:k.function,array:k.array,object:k.object,type:k.type,error:k.error,undefined:k.undefined};for(let n in t){const r=t[n];e.set(n,r,{global:!0,isConstant:!0})}}(e);const i=function(){if(Q.math=new B(Math),!f){const e=(()=>{if(f)return new Ge;const e=window;return void 0!==e&&"$"in e?{$:new B(e.$,"jquery"),window:new B(e,"window"),document:new B(e.document,"document")}:new Ue(n.unknown,"$ must be property of window to use dom library")})();if(e instanceof Re)return e;K.dom=e}}();if(i)return i;e.initialisedAsGlobal=!0}class Z{constructor(){this.symbolTable={},this.initialisedAsGlobal=!1,this.deleted=!1,this.path_=""}get path(){return this.path_||!this.parent?this.path_:this.parent.path}set path(e){this.path_=e}get parent(){return this.parent_}set parent(e){e!=this?this.parent_=e:console.error(z.red("Setting context parent to self"))}has(e){return void 0!==this.get(e)}hasOwn(e){return this.symbolTable[e]instanceof j}get(e){let t=this.getSymbol(e);return t instanceof Re||null==t?t:t.value}getRawSymbolTableAsDict(){const e={};for(let t in this.symbolTable)e[t]=this.symbolTable[t].value;return e}getSymbolTableAsDict(){const e={};for(let t in this.symbolTable)e[t]=this.symbolTable[t];return e}getSymbol(e){let t=this.symbolTable[e];if(void 0!==t&&!t.isAccessible)return new De(n.unknown,"assessable","inaccessible",t.identifier);if(void 0===t&&this.parent){let r=this.parent.getSymbol(e);if(r instanceof Re)return r;if(!r)return new Ue(n.unknown,e);t=r}return t}set(e,t,n={}){let r=this;if(n.global)r=this.root;else{for(;!r.hasOwn(e)&&void 0!==r.parent;)r=r.parent;r.hasOwn(e)||(r=this)}return r.setOwn(e,t,n)}setOwn(e,t,r={}){if(t instanceof E||(t=G(t)),r.global&&!this.initialisedAsGlobal&&(r.global=!1),!r.forceThroughConst){let t=this.symbolTable[e];if(null==t?void 0:t.isConstant)return new De(n.unknown,"dynamic","constant",e)}this.symbolTable[e]=new j(t,e,r)}remove(e){delete this.symbolTable[e]}clear(){for(let e in this.symbolTable)this.remove(e);this.parent=void 0,this.deleted=!0}get root(){let e=this;for(;e.parent;)e=e.parent;return e}get keys(){return Object.keys(this.symbolTable)}resetAsGlobal(){var e,t;if(!this.initialisedAsGlobal)return;const n=this.root.get("print"),r=this.root.get("input");n instanceof E&&r instanceof E?(this.symbolTable={},this.initialisedAsGlobal=!1,X(this,(null===(e=n.valueOf())||void 0===e?void 0:e.func)||console.log,(null===(t=r.valueOf())||void 0===t?void 0:t.func)||(()=>{}))):console.error("Error with print and input functions.")}clone(){const e=new Z;return e.parent=this.parent,e.deleted=this.deleted,e.initialisedAsGlobal=this.initialisedAsGlobal,e.symbolTable=Object.assign(Object.assign({},e.symbolTable),this.symbolTable),e}deepClone(){var e;let t=this.clone();return t.parent=null===(e=t.parent)||void 0===e?void 0:e.deepClone(),t}log(){console.log("---- CONTEXT ----");for(let e in this.symbolTable){const t=this.symbolTable[e];let n=e;t.isConstant&&(n+=" (CONST)"),t.isAccessible||(n+=" (INACCESSIBLE)"),n+=": ",n+=Ce(this.symbolTable[e].value),console.log(n)}console.log("-----------------")}}function ee(e,t){var r;let i;const o=e.type.interpret(t);if(o.error)return o.error;if(!(o.val instanceof A))return new De(n.unknown,"Type",typeof o.val,o.val,"Argument can't be undefined");let s;if(i=o.val,e.defaultValue){let n=null===(r=e.defaultValue)||void 0===r?void 0:r.interpret(t);if(n.error)return n.error;n.val instanceof E&&(s=n.val)}return{name:e.name,type:i,defaultValue:s}}class te{constructor(){this.val=new I,this.shouldBreak=!1,this.shouldContinue=!1}}class ne{constructor(e,t=!1){this.pos=e,this.isTerminal=t}interpret(e){var t;const r=v(),i=new te,o=this.interpret_(e);o instanceof Re?i.error=o:o instanceof te?(i.val=o.val,i.error=o.error,i.funcReturn=o.funcReturn,i.shouldBreak=o.shouldBreak,i.shouldContinue=o.shouldContinue):i.val=o,i.error&&i.error.pos.isUnknown&&(i.error.pos=this.pos),i.val instanceof E||(i.error=new De(n.unknown,"Primitive","Native JS value",Ce(i.val)),i.val=new I),(t=i.val.info).file||(t.file=this.pos.file),ne.interprets++;let s=v()-r;return ne.totalTime+=s,s>ne.maxTime&&(ne.maxTime=s),i}}ne.interprets=0,ne.totalTime=0,ne.maxTime=0;class re extends ne{constructor(e,t,n,r){super(e),this.left=t,this.opTok=n,this.right=r}interpret_(e){const t=this.left.interpret(e);if(t.error)return t.error;const n=this.right.interpret(e);if(n.error)return n.error;const r=t.val,i=n.val;if(void 0===r)return new De(this.opTok.pos,"~undefined","undefined",r,"N_binOp.interpret_");if(void 0===i)return new De(this.opTok.pos,"~undefined","undefined",i,"N_binOp.interpret_");switch(this.opTok.type){case b.LTE:{const t=r.__lt__({context:e},i),n=r.__eq__({context:e},i);return t instanceof Re?t:n instanceof Re?n:t.__or__({context:e},n)}case b.GTE:{const t=r.__gt__({context:e},i),n=r.__eq__({context:e},i);return t instanceof Re?t:n instanceof Re?n:t.__or__({context:e},n)}case b.NOTEQUALS:{const t=r.__eq__({context:e},i);return t instanceof Re?t:new $(!t.bool().valueOf())}case b.ADD:return r.__add__({context:e},i);case b.SUB:return r.__subtract__({context:e},i);case b.MUL:return r.__multiply__({context:e},i);case b.DIV:return r.__divide__({context:e},i);case b.POW:return r.__pow__({context:e},i);case b.EQUALS:return r.__eq__({context:e},i);case b.LT:return r.__lt__({context:e},i);case b.GT:return r.__gt__({context:e},i);case b.AND:return r.__and__({context:e},i);case b.OR:return r.__or__({context:e},i);default:return new Be(this.opTok.pos,`Invalid binary operator: ${w[this.opTok.type]}`)}}}class ie extends ne{constructor(e,t,n){super(e),this.a=t,this.opTok=n}interpret_(e){var t,n,r;const i=this.a.interpret(e);if(i.error)return i.error;switch(this.opTok.type){case b.SUB:case b.ADD:if(!(i.val instanceof D))return new De(this.pos,"Number",(null===(t=i.val)||void 0===t?void 0:t.typeName().toString())||"undefined_",null===(n=i.val)||void 0===n?void 0:n.valueOf());const e=i.val.valueOf();return new D(this.opTok.type===b.SUB?-e:Math.abs(e));case b.NOT:return new $(!(null===(r=null==i?void 0:i.val)||void 0===r?void 0:r.bool().valueOf()));default:return new Be(this.opTok.pos,`Invalid unary operator: ${w[this.opTok.type]}`)}}}class oe extends ne{constructor(e,t,n,r="=",i=!1,o=!1,s=!1,a=!1,u=k.any){super(e),this.value=n,this.varNameTok=t,this.isGlobal=i,this.assignType=r,this.isConstant=s,this.isDeclaration=a,this.isLocal=o,this.type=u instanceof A?new Ee(u):u}interpret_(e){var t,n,r,i;if(this.isDeclaration&&e.hasOwn(this.varNameTok.value))return new Be(this.pos,`Symbol '${this.varNameTok.value}' already exists, and cannot be redeclared`);const o=this.value.interpret(e),s=this.type.interpret(e);if(o.error)return o.error;if(s.error)return s.error;if(!(s.val&&s.val instanceof A))return new De(this.varNameTok.pos,"Type",null!==(n=null===(t=s.val)||void 0===t?void 0:t.typeName().valueOf())&&void 0!==n?n:"undefined",null===(r=s.val)||void 0===r?void 0:r.str(),"@ !typeRes.val || !(typeRes.val instanceof ESType)");if(!o.val)return new De(this.varNameTok.pos,"~undefined","undefined","N_varAssign.interpret_");if(!s.val.includesType({context:e},o.val.__type__).bool().valueOf())return new De(this.varNameTok.pos,Ce(s.val),Ce(null===(i=o.val)||void 0===i?void 0:i.typeName()),Ce(o.val));if(this.isDeclaration)return"="!==this.assignType?new Be(this.pos,`Cannot declare variable with operator '${this.assignType}'`):(e.setOwn(this.varNameTok.value,o.val,{global:!1,isConstant:this.isConstant}),o.val);if("="===this.assignType){let t=o.val;void 0===t&&(t=new I);const n=e.set(this.varNameTok.value,t,{global:this.isGlobal,isConstant:this.isConstant});if(n instanceof Re)return n}else{if(this.isDeclaration)return new Be(this.pos,`Cannot declare variable with operator '${this.assignType}'`);const t=e.get(this.varNameTok.value);if(t instanceof Re)return t;if(null==t)return new Be(this.pos,`Cannot declare variable with operator '${this.assignType}'`);let n,r=o.val;switch(this.assignType[0]){case"*":n=t.__multiply__({context:e},r);break;case"/":n=t.__divide__({context:e},r);break;case"+":n=t.__add__({context:e},r);break;case"-":n=t.__subtract__({context:e},r);break;default:return new Re(this.pos,"AssignError",`Cannot find assignType of ${this.assignType[0]}`)}if(n instanceof Re)return n;let i=e.set(this.varNameTok.value,n,{global:this.isGlobal,isConstant:this.isConstant});if(i instanceof Re)return i;o.val=n}return"(anonymous)"!==o.val.info.name&&o.val.info.name||(o.val.info.name=this.varNameTok.value),o}}class se extends ne{constructor(e,t,n,r){super(e),this.comparison=t,this.ifFalse=r,this.ifTrue=n}interpret_(e){var t;let n=new Z;n.parent=e;let r=new te,i=this.comparison.interpret(e);if(i.error)return i;if(null===(t=i.val)||void 0===t?void 0:t.bool().valueOf()){if(r=this.ifTrue.interpret(n),r.val=new I,r.error)return r}else if(this.ifFalse&&(r=this.ifFalse.interpret(n),r.val=new I,r.error))return r;return r}}class ae extends ne{constructor(e,t,n){super(e),this.comparison=t,this.loop=n}interpret_(e){var t,n;let r=new Z;for(r.parent=e;;){let i=this.comparison.interpret(e);if(i.error)return i;if(!(null===(n=null===(t=i.val)||void 0===t?void 0:t.bool())||void 0===n?void 0:n.valueOf()))break;let o=this.loop.interpret(r);if(o.error)return o;if(o.shouldBreak)break}return new I}}class ue extends ne{constructor(e,t,n,r,i,o){super(e),this.body=t,this.array=n,this.identifier=r,this.isGlobalId=i,this.isConstId=o}interpret_(e){var t,n,r,i,o,s,a,u;let c=new Z;c.parent=e;const l=this.array.interpret(e);if(l.error)return l;if(-1===["Array","Number","Object","String","Any"].indexOf((null===(t=l.val)||void 0===t?void 0:t.typeName().valueOf())||""))return new De(this.identifier.pos,"Array | Number | Object | String",typeof l.val+" | "+(null===(n=l.val)||void 0===n?void 0:n.typeName()));function f(e,t,n,r,i){c.set(t,n,{global:r,isConstant:i});const o=e.interpret(c);return o.error||void 0!==o.funcReturn?o:o.shouldBreak?(o.shouldBreak=!1,"break"):void(o.shouldContinue&&(o.shouldContinue=!1))}if(l.val instanceof D||"number"==typeof(null===(r=l.val)||void 0===r?void 0:r.valueOf()))for(let e=0;e<l.val.valueOf();e++){const t=f(this.body,this.identifier.value,new D(e),this.isGlobalId,this.isConstId);if("break"===t)break;if(t&&(t.error||void 0!==t.funcReturn))return t}else if(l.val instanceof R||"number"==typeof(null===(i=l.val)||void 0===i?void 0:i.valueOf())&&!Array.isArray(null===(o=l.val)||void 0===o?void 0:o.valueOf()))for(let e in null===(s=l.val)||void 0===s?void 0:s.valueOf()){const t=f(this.body,this.identifier.value,new L(e),this.isGlobalId,this.isConstId);if("break"===t)break;if(t&&(t.error||void 0!==t.funcReturn))return t}else{if(!(l.val instanceof U||Array.isArray(null===(a=l.val)||void 0===a?void 0:a.valueOf())))return new De(this.identifier.pos,"Array | Number | Object | String",typeof l.val);for(let e of null===(u=l.val)||void 0===u?void 0:u.valueOf()){const t=f(this.body,this.identifier.value,e,this.isGlobalId,this.isConstId);if("break"===t)break;if(t&&(t.error||void 0!==t.funcReturn))return t}}return new I}}class ce extends ne{constructor(e,t,n=!1){super(e),this.items=t,this.shouldClone=n}interpret_(e){let t=new te,n=[];for(let t of this.items){const r=t.interpret(e);if(r.error||void 0!==r.funcReturn)return r;if(!r.val)continue;let i=r.val;this.shouldClone&&(i=i.clone()),n.push(i)}return t.val=new U(n),t}}class le extends ne{constructor(e,t){super(e),this.properties=t}interpret_(e){let t={};for(const[n,r]of this.properties){const i=r.interpret(e);if(i.error)return i.error;const o=n.interpret(e);if(o.error)return o.error;o.val&&i.val&&(t[o.val.valueOf()]=i.val)}return new R(t)}}class fe extends ne{constructor(e){super(e)}interpret_(e){return new R({})}}class he extends ne{constructor(e,t){super(e),this.items=t}interpret_(e){let t;for(let n of this.items){const r=n.interpret(e);if(r.error||void 0!==r.funcReturn||r.shouldBreak||r.shouldContinue)return r;t=r.val}return t||new I}}class de extends ne{constructor(e,t,n){super(e),this.arguments=n,this.to=t}interpret_(e){let{val:t,error:n}=this.to.interpret(e);if(n)return n;if(!t)return new De(this.pos,"any","undefined",void 0,"On function call");let r=[];for(let t of this.arguments){const n=t.interpret(e);if(n.error)return n.error;n.val&&r.push(n.val)}const i=t.__call__({context:e},...r);return i instanceof Re&&i.traceback.push({position:this.pos,line:`${t.info.name||"<AnonFunction>"}(${r.map(Ce).join(", ")})`}),i}}class pe extends ne{constructor(e,t,n,r,i="(anon)",o=new R,s=""){super(e),this.arguments=n,this.body=t,this.name=i,this.this_=o,this.returnType=r,this.description=s}interpret_(e){var t,n,r;let i=[];for(let t of this.arguments){const n=ee(t,e);if(n instanceof Re)return n;i.push(n)}const o=this.returnType.interpret(e);return o.error?o.error:o.val instanceof A?new M(this.body,i,this.name,this.this_,o.val,e):new De(this.returnType.pos,"Type",null!==(n=null===(t=o.val)||void 0===t?void 0:t.typeName().valueOf())&&void 0!==n?n:"<Undefined>",null===(r=o.val)||void 0===r?void 0:r.str().valueOf(),`On func '${this.name}' return type`)}}class ve extends ne{constructor(e,t){super(e),this.value=t}interpret_(e){const t=new te;if(void 0===this.value)return t.funcReturn=new I,t;let n=this.value.interpret(e);return n.error?n.error:(t.funcReturn=n.val,t)}}class ye extends ne{constructor(e,t){super(e),this.value=t}interpret_(e){var t;const n=new te;if(void 0===this.value)return n.funcReturn=new I,n;let r=this.value.interpret(e);return r.error?r.error:((null===(t=r.val)||void 0===t?void 0:t.bool().valueOf())&&(n.funcReturn=r.val),n)}}class me extends ne{constructor(e,t,n){super(e),this.base=t,this.index=n}interpret_(e){var t;let n=this.base.interpret(e);if(n.error)return n;let r=this.index.interpret(e);if(r.error)return r;const i=r.val,o=n.val;if(!o||!i)return new I;if(void 0!==this.value){let n=this.value.interpret(e);if(n.error)return n;const r=G(o.__getProperty__({context:e},i));let s,a=n.val;if(null!==(t=this.assignType)&&void 0!==t||(this.assignType="="),!a)return new De(this.pos,"~undefined","undefined","undefined","N_indexed.interpret_");switch(this.assignType[0]){case"*":s=r.__multiply__({context:e},a);break;case"/":s=r.__divide__({context:e},a);break;case"+":s=r.__add__({context:e},a);break;case"-":s=r.__subtract__({context:e},a);break;case"=":s=a;break;default:return new Re(this.pos,"AssignError",`Cannot find assignType of ${this.assignType[0]}`)}if(s instanceof Re)return s;if(!o.__setProperty__)return new De(this.pos,"mutable","immutable",o.valueOf());const u=o.__setProperty__({context:e},i,null!=s?s:new I);if(u instanceof Re)return u}return o.__getProperty__({context:e},i)}}class _e extends ne{constructor(e,t,n,r,i="<anon class>"){super(e),this.init=r,this.methods=t,this.name=i,this.extends_=n,this.instances=[]}interpret_(e){var t,n,r;const i=[];for(let n of this.methods){const r=n.interpret(e);if(r.error)return r.error;if(!(r.val instanceof M))return new De(this.pos,"Function",(null===(t=r.val)||void 0===t?void 0:t.typeName().valueOf())||"undefined","method on "+this.name);i.push(r.val)}let o,s;if(this.extends_){const t=this.extends_.interpret(e);if(t.error)return t.error;if(!(t.val instanceof A))return new De(this.pos,"Function",(null===(n=t.val)||void 0===n?void 0:n.typeName().valueOf())||"undefined","method on "+this.name);o=t.val}if(this.init){const t=this.init.interpret(e);if(t.error)return t.error;if(!(t.val instanceof M))return new De(this.pos,"Function",(null===(r=t.val)||void 0===r?void 0:r.typeName().valueOf())||"undefined","method on "+this.name);s=t.val}return new A(!1,this.name,i,o,s)}}class be extends ne{constructor(e,t,n="(anon)",r=!1){super(e),this.name=n,this.statements=t,this.mutable=r}interpret_(e){const t=new Z;t.parent=e;const n=this.statements.interpret(t);return n.error?n:new N(new L(this.name),t.getSymbolTableAsDict(),this.mutable)}}class we extends ne{constructor(e,t){super(e,!0),this.a=t}interpret_(e){let t=this.a.value;if("number"!=typeof t)return new De(this.pos,"number",typeof t);const n=new te;return n.val=new D(t),n}}class ge extends ne{constructor(e,t){super(e,!0),this.a=t}interpret_(e){let t=this.a.value;if("string"!=typeof t)return new De(this.pos,"string",typeof t);const n=new te;return n.val=new L(t),n}}class xe extends ne{constructor(e){super(e.pos,!0),this.a=e}interpret_(e){if(!e.has(this.a.value))return new Ue(this.a.pos,this.a.value);let t=new te,n=e.getSymbol(this.a.value);return n?n instanceof Re?n:(t.val=n.value,t):new I}}class Se extends ne{constructor(e=n.unknown){super(e,!0)}interpret_(e){const t=new te;return t.val=new I,t}}class Te extends ne{constructor(e){super(e,!0)}interpret_(e){const t=new te;return t.shouldBreak=!0,t}}class ke extends ne{constructor(e){super(e,!0)}interpret_(e){const t=new te;return t.shouldContinue=!0,t}}class Ee extends ne{constructor(e,t=n.unknown){super(t,!0),this.value=e}interpret_(e){return this.value}}function Oe(e,t=new WeakMap){let n;if(Object(e)!==e||e instanceof Function)return e;if(t.has(e))return t.get(e);try{n=new e.constructor}catch(t){n=Object.create(Object.getPrototypeOf(e))}return e instanceof Map?Array.from(e,(([e,r])=>n.set(Oe(e,t),Oe(r,t)))):e instanceof Set&&Array.from(e,(e=>n.add(Oe(e,t)))),t.set(e,n),Object.assign(n,...Object.keys(e).map((n=>({[n]:Oe(e[n],t)}))))}function Ce(e,t=0){if("string"==typeof e)return t>0?`'${e}'`:e;if(t>20)return"...";let n="";if(void 0===e)return"undefined";if(e instanceof E)return e.str().valueOf();if(e instanceof ne)return`<RunTimeNode: ${e.constructor.name}>`;switch(typeof e){case"object":if(Array.isArray(e)){n+="[";for(let r of e)try{n+=Ce(r,t+1)+", "}catch(e){n+="<large property>, "}e.length&&(n=n.substring(0,n.length-2)),n+="]"}else{try{n+=e.constructor.name}catch(e){n+="UNKNOWN_CONSTRUCTOR"}n+=": {\n";let r=0;for(let i in e)r++,e.hasOwnProperty&&e.hasOwnProperty(i)&&(n+=`  ${i}: ${Ce(e[i],t+1)||""}, \n`);r>0&&(n=n.substring(0,n.length-3)),n+="\n}\n"}break;case"string":n=`'${e}'`;break;case"bigint":case"number":case"boolean":n=`${e}`;break;case"undefined":n="<NativeUndefined>";break;case"function":n=`<NativeFunction ${e.name}>`}for(let e=0;e<t;e++)n=Ae(n);return n}const Pe=e=>new Promise((t=>setTimeout((()=>t()),e)));function Ae(e){return e.replace(/\n/g,"\n    ")}const Ie=e=>/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(e);class Re{constructor(e,t,n){this.traceback=[],this.pos=e,this.name=t,this.details=n}get colouredStr(){let e="";if(this.traceback.length){e=z.yellow("Error Traceback (most recent call last):\n");for(let t of[...this.traceback].reverse())e+=`    ${z.cyan(t.position.str)}:\n        ${t.line}\n`}return e+=`${z.red(this.name)}: ${this.details} \n at ${z.cyan(this.pos.str)}`,e}get str(){return`${this.name}: ${this.details} \n at ${this.pos.str}`}}class Ne extends Re{constructor(e,t){super(e,"IllegalCharError",`'${t}'`)}}class Be extends Re{constructor(e,t){super(e,"InvalidSyntaxError",t)}}class Me extends Re{constructor(e,t){super(e,"ExpectedCharError",`'${t}'`)}}class De extends Re{constructor(e,t,n,r="",i=""){super(e,"TypeError",`Expected type '${t}', got type '${n}' ${void 0===r?"":` on value '${Ce(r)}'`} ${i||""}`)}}class $e extends Re{constructor(e,t,n=""){super(e,"ImportError",`Could not import ${t}: ${n}`)}}class Ue extends Re{constructor(e,t){super(e,"ReferenceError",`${t} is not defined`)}}class Le extends Re{constructor(e,t,n){var r;super(e,"IndexError",`'${t}' is not a property of '${(null===(r=null==n?void 0:n.info)||void 0===r?void 0:r.name)||Ce(n)}'`)}}class je extends Re{constructor(e,t,r="",i=n.unknown){var o;super(i,"TypeError",`Cannot perform '${e}' on value ${(null===(o=null==t?void 0:t.info)||void 0===o?void 0:o.name)||Ce(t)}: ${r}`)}}class Ge extends Re{constructor(){super(n.unknown,"InvalidRuntimeError","Required runtime of "+(f?"browser":"node"))}}class We extends Re{constructor(e){super(n.unknown,"TestFailed",e)}}class qe{constructor(e,t,n){this.type=t,this.value=n,this.pos=e}matches(e,t){return this.type===e&&this.value===t}}class Fe{constructor(e,t){this.text=e,this.position=new n(-1,0,-1,t),this.advance()}advance(){this.position.advance(this.currentChar),this.currentChar=this.text[this.position.idx]}generate(){if(!this.text)return[new qe(this.position,b.EOF)];const e=[];for(;void 0!==this.currentChar;)if(" \t\n".includes(this.currentChar))this.advance();else if(r.includes(this.currentChar))e.push(this.makeNumber());else if(this.currentChar===o[0]&&this.text[this.position.idx+1]===o[1])this.singleLineComment();else if(this.currentChar===s[0]&&this.text[this.position.idx+1]===s[1])this.multiLineComment();else if(i.includes(this.currentChar))e.push(this.makeIdentifier());else if(-1!==l.indexOf(this.currentChar))e.push(this.makeString());else{const t=this.currentChar;let n=this.unknownChar();if(!n){let e=this.position.clone,t=this.currentChar;return this.advance(),new Ne(e,t)}n.type===b.ASSIGN&&(n.value=t),e.push(n)}return e.push(new qe(this.position,b.EOF)),e}makeNumber(){const e=this.position.clone;let t="",n=0;for(;void 0!==this.currentChar&&(r+"._").includes(this.currentChar);){if("."===this.currentChar){if(1===n)break;n++,t+="."}else"_"!==this.currentChar&&(t+=this.currentChar);this.advance()}return new qe(e,b.NUMBER,parseFloat(t))}makeString(){const e=this.position.clone;let t="",n=this.currentChar;for(this.advance();this.currentChar!==n&&void 0!==this.currentChar;)"\\"!==this.currentChar||(this.advance(),"n"!==this.currentChar)?(t+=this.currentChar,this.advance()):(t+="\n",this.advance());return this.advance(),new qe(e,b.STRING,t)}makeIdentifier(){let e="";const t=this.position.clone;for(;void 0!==this.currentChar&&(i+r).includes(this.currentChar);)e+=this.currentChar,this.advance();let n=b.IDENTIFIER;return-1!==p.indexOf(e)&&(n=b.KEYWORD),new qe(t,n,e)}unknownChar(){if(void 0!==this.currentChar){for(let e in S)if(e[0]===this.currentChar&&e[1]===this.text[this.position.idx+1]&&e[2]===this.text[this.position.idx+2]){const t=this.position.clone;return this.advance(),this.advance(),this.advance(),new qe(t,S[e])}for(let e in x)if(e[0]===this.currentChar&&e[1]===this.text[this.position.idx+1]){const t=this.position.clone;return this.advance(),this.advance(),new qe(t,x[e])}if(g.hasOwnProperty(this.currentChar)){let e=this.position.clone,t=g[this.currentChar];return this.advance(),new qe(e,t)}}}singleLineComment(){for(this.advance();"\n"!==this.currentChar&&void 0!==this.currentChar;)this.advance();this.advance()}multiLineComment(){for(this.advance();this.currentChar!==a[0]||this.text[this.position.idx+1]!==a[1];)this.advance();this.advance(),this.advance()}}class ze{constructor(){this.advanceCount=0,this.lastRegisteredAdvanceCount=0,this.reverseCount=0}registerAdvance(){this.advanceCount=1,this.lastRegisteredAdvanceCount++}register(e){return this.lastRegisteredAdvanceCount=e.advanceCount,this.advanceCount+=e.advanceCount,e.error&&(this.error=e.error),e.node?e.node:new Se}tryRegister(e){if(!e.error)return this.register(e);this.reverseCount+=e.advanceCount}success(e){return this.node=e,this}failure(e){return this.error=e,this}}class Ve{constructor(e){this.tokens=e,this.tokenIdx=-1,this.currentToken=e[0],this.advance()}parse(){var e;if(!this.currentToken||!this.tokens||1===this.tokens.length&&this.tokens[0].type===b.EOF)return new ze;const t=this.statements(!0);return t.error||this.currentToken.type===_.EOF?t:t.failure(new Be(null===(e=this.currentToken)||void 0===e?void 0:e.pos,`Expected 'End of File', got token of type'${w[this.currentToken.type]}' of value ${this.currentToken.value}`))}advance(e){return e&&e.registerAdvance(),this.tokenIdx++,this.currentToken=this.tokens[this.tokenIdx],this.currentToken}reverse(e=1){return this.tokenIdx-=e,this.currentToken=this.tokens[this.tokenIdx],this.currentToken}consume(e,t,n){if(this.currentToken.type!==t)return e.failure(new Be(this.currentToken.pos,null!=n?n:`Expected '${w[t]}' but got '${w[this.currentToken.type]}'`));this.advance(e)}clearEndStatements(e){for(;this.currentToken.type===b.ENDSTATEMENT;)this.advance(e)}statements(e=!1){const t=new ze,n=this.currentToken.pos;let r=[];this.clearEndStatements(t);const i=t.register(this.statement());if(!i)return t;if(r.push(i),t.error)return t;let o=!0;for(;;){let e=0;for(;this.currentToken.type===b.ENDSTATEMENT;)this.advance(t),e++;if(0===e&&(o=!1),!o)break;const n=t.tryRegister(this.statement());n?r.push(n):this.reverse(t.reverseCount)}this.clearEndStatements(t);let s=new he(n,r);return e&&(s=new ce(n,r,!0)),t.success(s)}statement(){const e=new ze,t=this.currentToken.pos;if(this.currentToken.matches(b.KEYWORD,"return")){this.advance(e);let n=new Se(this.currentToken.pos);if(this.currentToken.type!==b.ENDSTATEMENT){let t=e.register(this.expr());if(!t)return e.failure(new Be(this.currentToken.pos,"Expected end of statement"));n=t}return e.success(new ve(t,n))}if(this.currentToken.matches(b.KEYWORD,"yield")){this.advance(e);let n=new Se(this.currentToken.pos);if(this.currentToken.type!==b.ENDSTATEMENT){let t=e.register(this.expr());if(!t)return e.failure(new Be(this.currentToken.pos,"Expected end of statement"));n=t}return e.success(new ye(t,n))}if(this.currentToken.matches(b.KEYWORD,"break"))return this.advance(e),e.success(new Te(t));if(this.currentToken.matches(b.KEYWORD,"continue"))return this.advance(e),e.success(new ke(t));const n=e.register(this.expr());return e.error?e:n?e.success(n):e.failure(new Be(t,"No empty statements"))}atom(){const e=new ze,t=this.currentToken,n=this.currentToken.pos;switch(t.type){case b.NUMBER:return this.advance(e),e.success(new we(n,t));case b.STRING:return this.advance(e),e.success(new ge(n,t));case b.IDENTIFIER:return this.atomIdentifier(e,n,t);case b.OPAREN:this.advance(e);const r=e.register(this.expr());return e.error?e:this.currentToken.type==b.CPAREN?(this.advance(e),e.success(r)):e.failure(new Be(this.currentToken.pos,"Expected ')'"));case b.OSQUARE:let i=e.register(this.array());return e.error?e:e.success(i);case b.OBRACES:let o=e.register(this.object());return e.error?e:e.success(o);case b.KEYWORD:if("if"===t.value){const t=e.register(this.ifExpr());return e.error?e:e.success(t)}return e.failure(new Be(this.currentToken.pos,`Invalid Identifier ${t.value}`));default:return e.failure(new Be(this.currentToken.pos,"Expected number, identifier, '(', '+' or '-'"))}}atomIdentifier(e,t,n){this.advance(e);let r=new xe(n),i=new Se(t),o=!1;for(;-1!==[b.OPAREN,b.OSQUARE,b.DOT].indexOf(this.currentToken.type);)switch(this.currentToken.type){case b.OPAREN:o=!0;const t=r;if(r=e.register(this.makeFunctionCall(r,i)),i=t,e.error)return e;break;case b.OSQUARE:if(i=r,r=e.register(this.makeIndex(r)),e.error)return e;break;case b.DOT:if(this.advance(e),this.currentToken.type!==b.IDENTIFIER)return e.failure(new Be(this.currentToken.pos,"Expected identifier after '.'"));i=r,r=new me(this.currentToken.pos,r,new ge(this.currentToken.pos,this.currentToken)),this.advance(e)}if(this.currentToken.type===b.ASSIGN){let n=this.currentToken.value;if(o)return e.failure(new Be(t,"Cannot assign to return value of function"));this.advance(e);const i=e.register(this.expr());if(r instanceof xe)r=new oe(t,r.a,i,n,!1);else{if(!(r instanceof me))return e.failure(new Be(t,`Cannot have node of type ${this.currentToken.constructor.name}.\n                            Expected either index or variable node.`));r.value=i,r.assignType=n}if(e.error)return e}return e.success(r)}power(){return this.binOp((()=>this.atom()),[_.POW],(()=>this.factor()))}factor(){const e=new ze,t=this.currentToken;switch(t.type){case b.SUB:case b.ADD:this.advance(e);const n=e.register(this.factor());return e.error?e:e.success(new ie(t.pos,n,t));default:return this.power()}}term(){return this.binOp((()=>this.factor()),[b.MUL,b.DIV])}arithmeticExpr(){return this.binOp((()=>this.term()),[b.ADD,b.SUB])}comparisonExpr(){const e=new ze;if(this.currentToken.type===b.NOT){const t=this.currentToken;this.advance(e);let n=e.register(this.expr());return e.error?e:e.success(new ie(t.pos,n,t))}let t=e.register(this.binOp((()=>this.arithmeticExpr()),[b.EQUALS,b.NOTEQUALS,b.GT,b.GTE,b.LTE,b.LT]));return e.error?e:e.success(t)}expr(){const e=new ze;if(this.clearEndStatements(e),this.currentToken.type===b.KEYWORD&&-1!==["var","let","global","mutable","const","local"].indexOf(this.currentToken.value))return this.initiateVar(e);if(this.currentToken.matches(_.KEYWORD,"if"))return this.ifExpr();if(this.currentToken.matches(_.KEYWORD,"while"))return this.whileExpr();if(this.currentToken.matches(_.KEYWORD,"for"))return this.forExpr();if(this.currentToken.matches(_.KEYWORD,"func"))return this.funcExpr();if(this.currentToken.matches(_.KEYWORD,"class"))return this.classExpr();if(this.currentToken.matches(_.KEYWORD,"namespace"))return this.namespace();let t=e.register(this.binOp((()=>this.comparisonExpr()),[b.AND,b.OR]));return e.error?e:e.success(t)}binOp(e,t,n=e){const r=new ze;let i=r.register(e());if(r.error)return r;for(;-1!==t.indexOf(this.currentToken.type)||-1!==t.indexOf([this.currentToken.type,this.currentToken.value]);){const e=this.currentToken;this.advance(r);const t=r.register(n());if(r.error)return r;i=new re(i.pos,i,e,t)}return r.success(i)}typeExpr(){const e=new ze;if(this.currentToken.type!==b.IDENTIFIER)return e.failure(new Be(this.currentToken.pos.clone,"Expected an identifier"));let t=this.currentToken;return this.advance(e),e.success(new xe(t))}makeFunctionCall(e,t=new Se){const n=new ze;let r=[];const i=this.currentToken.pos;if(this.currentToken.type!==b.OPAREN)return n.failure(new Be(i,"Expected '['"));if(this.advance(n),this.currentToken.type===b.CPAREN)return this.advance(n),n.success(new de(i,e,[]));if(r.push(n.register(this.expr())),n.error)return n.failure(new Be(this.currentToken.pos,"Invalid argument"));for(;this.currentToken.type===b.COMMA;)if(this.advance(n),r.push(n.register(this.expr())),n.error)return n;return this.currentToken.type!==b.CPAREN?n.failure(new Be(this.currentToken.pos,"Expected ',' or ')'")):(this.advance(n),n.success(new de(i,e,r)))}makeIndex(e){const t=new ze,n=this.currentToken.pos,r=e;if(this.currentToken.type!==b.OSQUARE)return t.failure(new Be(n,"Expected '["));if(this.advance(t),this.currentToken.type===b.CSQUARE)return t.failure(new Be(n,"Cannot index without expression"));let i=t.register(this.expr());return t.error?t.failure(new Be(this.currentToken.pos,"Invalid index")):this.currentToken.type!==b.CSQUARE?t.failure(new Be(this.currentToken.pos,"Expected ']'")):(this.advance(t),t.success(new me(n,r,i)))}initiateVar(e){let t=this.currentToken.pos,n=!1,r=!1,i=!1,o=!1;if(this.currentToken.type===b.KEYWORD&&-1!==["var","let"].indexOf(this.currentToken.value)&&(o=!0,r=!0,this.advance(e),e.error))return e;if(this.currentToken.type===b.KEYWORD&&-1!==["global","local"].indexOf(this.currentToken.value)&&(o=!0,"global"===this.currentToken.value?i=!0:r=!0,this.advance(e),e.error))return e;if(this.currentToken.type===b.KEYWORD&&-1!==["const","mutable"].indexOf(this.currentToken.value)&&(o=!0,"const"===this.currentToken.value&&(n=!0),this.advance(e),e.error))return e;if(this.currentToken.type===b.KEYWORD)return e.failure(new Be(this.currentToken.pos,`Expected Identifier 'var', 'let', 'const', 'mutable', 'local', or 'global', not ${this.currentToken.value}`));if(this.currentToken.type!==_.IDENTIFIER)return e.failure(new Be(this.currentToken.pos,"Expected Identifier or Keyword"));const s=this.currentToken;this.advance(e);let a=k.any;if(this.currentToken.type===b.COLON&&(o=!0,this.consume(e,b.COLON),a=e.register(this.typeExpr())),this.currentToken.type!==b.ASSIGN)return n?e.failure(new Be(t,"Cannot initialise constant to undefined")):e.success(new oe(t,s,new Se(this.currentToken.pos),"=",i,r,n,o,a));let u=this.currentToken.value;this.advance(e);const c=e.register(this.expr());return e.error?e:((c instanceof _e||c instanceof pe)&&(c.name=s.value),c instanceof be&&(c.name=s.value,c.mutable=!n),e.success(new oe(t,s,c,u,i,r,n,o,a)))}bracesExp(){const e=new ze;if(this.consume(e,b.OBRACES),e.error)return e;if(this.clearEndStatements(e),this.currentToken.type===b.CBRACES)return this.advance(e),e.success(new Se(this.currentToken.pos));const t=e.register(this.statements());return e.error?e:(this.consume(e,b.CBRACES),e.error?e:e.success(t))}addEndStatement(e){this.tokens.splice(this.tokenIdx,0,new qe(this.currentToken.pos,b.ENDSTATEMENT)),this.reverse(),this.advance(e)}ifExpr(){const e=new ze;let t,n,r;const i=this.currentToken.pos;if(!this.currentToken.matches(b.KEYWORD,"if"))return e.failure(new Be(this.currentToken.pos,"Expected 'if'"));if(this.advance(e),r=e.register(this.expr()),e.error)return e;if(t=e.register(this.bracesExp()),e.error)return e;if(this.clearEndStatements(e),this.currentToken.matches(b.KEYWORD,"else"))if(this.advance(e),this.currentToken.type==b.OBRACES){if(n=e.register(this.bracesExp()),e.error)return e}else if(n=e.register(this.statement()),e.error)return e;return this.addEndStatement(e),e.success(new se(i,r,t,n))}whileExpr(){const e=new ze;let t,n;const r=this.currentToken.pos;return this.currentToken.matches(b.KEYWORD,"while")?(this.advance(e),n=e.register(this.expr()),e.error?e:(t=e.register(this.bracesExp()),e.error?e:(this.addEndStatement(e),e.success(new ae(r,n,t))))):e.failure(new Be(this.currentToken.pos,"Expected 'while'"))}parameter(e){let t,n=new Ee(k.any);if(this.currentToken.type!==b.IDENTIFIER)return new Be(this.currentToken.pos,"Expected identifier");if(t=this.currentToken.value,this.advance(e),this.currentToken.type===b.COLON){if(this.consume(e,b.COLON),e.error)return e.error;if(n=e.register(this.typeExpr()),e.error)return e.error}return{name:t,type:n}}funcCore(){const e=new ze,t=this.currentToken.pos;let n,r=[],i=new Ee(k.any);if(this.consume(e,b.OPAREN),this.currentToken.type===b.CPAREN)this.advance(e);else{let t=this.parameter(e);if(t instanceof Re)return e.failure(t);for(r.push(t);this.currentToken.type===b.COMMA;){this.advance(e);let t=this.parameter(e);if(t instanceof Re)return e.failure(t);r.push(t)}if(this.currentToken.type!==b.CPAREN)return e.failure(new Be(this.currentToken.pos,"Expected ',' or ')'"));this.advance(e)}if(this.currentToken.type===b.COLON&&(this.advance(e),i=e.register(this.typeExpr()),e.error))return e;if(this.currentToken.type!==b.OBRACES){if(n=new ve(this.currentToken.pos,e.register(this.expr())),e.error)return e}else{if(this.consume(e,b.OBRACES),e.error)return e;if(n=this.currentToken.type!==b.CBRACES?e.register(this.statements()):new Se(this.currentToken.pos),this.consume(e,b.CBRACES),e.error)return e}return e.success(new pe(t,n,r,i))}funcExpr(){const e=new ze;if(!this.currentToken.matches(b.KEYWORD,"func"))return e.failure(new Be(this.currentToken.pos,"Expected 'func'"));this.advance(e);const t=e.register(this.funcCore());return e.error?e:e.success(t)}classExpr(e){const t=new ze,n=this.currentToken.pos,r=[];let i,o;if(!this.currentToken.matches(b.KEYWORD,"class"))return t.failure(new Be(this.currentToken.pos,"Expected 'class'"));if(this.advance(t),this.currentToken.matches(b.KEYWORD,"extends")&&(this.advance(t),o=t.register(this.expr()),t.error))return t;if(this.consume(t,b.OBRACES),t.error)return t;if(this.currentToken.type===b.CBRACES)return this.advance(t),t.success(new _e(n,[],void 0,void 0,e));for(;this.currentToken.type===b.IDENTIFIER;){let e=this.currentToken.value;this.advance(t);const n=t.register(this.funcCore());if(t.error)return t;if(!(n instanceof pe))return t.failure(new Re(this.currentToken.pos,"ParseError",`Tried to get function, but got ${n} instead`));n.name=e,"init"===e?i=n:r.push(n)}return this.consume(t,b.CBRACES),t.success(new _e(n,r,o,i,e))}forExpr(){const e=new ze,t=this.currentToken.pos;let n,r,i,o=!1,s=!1;return this.currentToken.matches(b.KEYWORD,"for")?(this.advance(e),this.currentToken.matches(b.KEYWORD,"global")?(o=!0,this.advance(e)):this.currentToken.matches(b.KEYWORD,"const")?(s=!0,this.advance(e)):(this.currentToken.matches(b.KEYWORD,"var")||this.currentToken.matches(b.KEYWORD,"let"))&&this.advance(e),this.currentToken.type!==b.IDENTIFIER?e.failure(new Be(this.currentToken.pos,"Expected identifier")):(i=this.currentToken,this.advance(e),this.currentToken.matches(b.KEYWORD,"in")?(this.advance(e),r=e.register(this.expr()),e.error?e:(n=e.register(this.bracesExp()),e.error?e:(this.addEndStatement(e),e.success(new ue(t,n,r,i,o,s))))):e.failure(new Be(this.currentToken.pos,"Expected keyword 'in")))):e.failure(new Be(this.currentToken.pos,"Expected 'for'"))}array(){const e=new ze;let t=[];const n=this.currentToken.pos;if(this.currentToken.type!==b.OSQUARE)return e.failure(new Be(n,"Expected '["));if(this.advance(e),this.currentToken.type===b.CSQUARE)return this.advance(e),e.success(new ce(n,[]));if(t.push(e.register(this.expr())),e.error)return e.failure(new Be(this.currentToken.pos,"Expected ']', 'var', 'if', 'for', 'while', number, identifier, '+', '-', '(', '[' or '!' 2"));for(;this.currentToken.type===b.COMMA;)if(this.advance(e),t.push(e.register(this.expr())),e.error)return e;return this.currentToken.type!==b.CSQUARE?e.failure(new Be(this.currentToken.pos,"Expected ',' or ']'")):(this.advance(e),e.success(new ce(n,t)))}object(){const e=new ze;let t=[];const n=this.currentToken.pos;if(this.currentToken.type!==b.OBRACES)return e.failure(new Be(n,"Expected '{"));if(this.advance(e),this.currentToken.type===b.CBRACES)return this.advance(e),e.success(new fe(n));for(;;){let n,r,i;if(this.currentToken.type===b.IDENTIFIER)n="id",r=new ge(this.currentToken.pos,this.currentToken),this.advance(e);else if(this.currentToken.type===b.STRING)n="string",r=new ge(this.currentToken.pos,this.currentToken),this.advance(e);else{if(this.currentToken.type!==b.OSQUARE)break;if(n="value",this.advance(e),r=e.register(this.expr()),e.error)return e;if(this.currentToken.type!==b.CSQUARE)return e.failure(new Be(this.currentToken.pos,`Expected ']', got '${w[this.currentToken.type]}'`));this.advance(e)}if(this.currentToken.type===b.COLON){if(this.advance(e),i=e.register(this.expr()),e.error)return e;if(this.currentToken.type!==b.COMMA&&this.currentToken.type!==b.CBRACES)return e.failure(new Be(this.currentToken.pos,`Expected ',' or '}', got '${w[this.currentToken.type]}'`));this.currentToken.type===b.COMMA&&this.advance(e)}else{if(this.currentToken.type!==b.COMMA&&this.currentToken.type!==b.CBRACES)return e.failure(new Be(this.currentToken.pos,`Expected ',' or '}', got '${w[this.currentToken.type]}'`));if("id"!==n)return e.failure(new Be(this.currentToken.pos,"You must specify a value when initialising an object literal with a key that is not an identifier.\n                        Try using `key: value` syntax."));this.reverse(),i=new xe(this.currentToken),this.advance(e),this.currentToken.type===b.COMMA&&this.advance(e)}if(t.push([r,i]),e.error)return e}return this.currentToken.type!==b.CBRACES?e.failure(new Be(this.currentToken.pos,"Expected identifier, ',' or '}'")):(this.advance(e),e.success(new le(n,t)))}namespace(){const e=new ze,t=this.currentToken.pos;if(this.consume(e,b.KEYWORD),e.error)return e;if(this.consume(e,b.OBRACES),e.error)return e;if(this.currentToken.type===b.CBRACES)return this.advance(e),e.success(new be(t,new Se));const n=e.register(this.statements());return e.error?e:(this.consume(e,b.CBRACES),e.error?e:e.success(new be(t,n)))}}function Ke(e=console.log,t,r=!0,i={print:console.log},o=new Z,s=""){var a,l,f,p;return l=this,p=function*(){const l=X(o,e,t);if(l instanceof Re)return l;c(o),null!==(a=i.context)&&void 0!==a||(i.context=o),s&&(o.path=s),i.print&&(d.print=i.print),r&&(h(),yield y(!0),function(e,t){const{fs:r,path:i}=e;for(let t in e)e.hasOwnProperty(t)&&(o=t,s=new B(e[t],t),function(e,t){K[e]={},Q[e]=t}(o,Y(G(s),o)));var o,s;t.set("import",new M((({context:e},t)=>{let o=Ce(t);if(H(o))return J(o);if(o=i.join(e.path,o),o in m)return m[o];try{if(!r.existsSync(o)){if(!r.existsSync("./particles/"+o))return new Re(n.unknown,"ImportError",`Can't find file '${o}' to import.`);if(!r.existsSync("particles/"+o+"/main.es"))return new Re(n.unknown,"ImportError",`Module '${o}' has no entry point. Requires 'main.es'.`);o="particles/"+o+"/main.es"}const e=i.dirname(o),t=r.readFileSync(o,"utf-8"),s=new Z;s.parent=u,s.path=e;const a=new N(new L(o),{});m[o]=a;const c=Qe(t,{env:s,measurePerformance:!1,fileName:o,currentDir:e});return a.__value__=s.getSymbolTableAsDict(),c.error?c.error:a}catch(e){return new Re(n.unknown,"ImportError",e.toString())}}),[{name:"path",type:k.string}],"import",void 0,k.object),{forceThroughConst:!0,isConstant:!0}),t.setOwn("open",new M((({context:e},t,i)=>{const o=Ce(t),s=Ce(i)||"utf-8";return r.existsSync(o)?new R({str:new M((({context:e})=>new L(r.readFileSync(e.path+o,s))),[],"str",void 0,k.string),write:new M((({context:e},t)=>{r.writeFileSync(e.path+o,Ce(t))}),[{name:"path",type:k.string}]),append:new M((({context:e},t)=>{r.appendFileSync(e.path+o,Ce(t))}),[{name:"path",type:k.string}])}):new $e(n.unknown,o)})))}(i,o))},new((f=void 0)||(f=Promise))((function(e,t){function n(e){try{i(p.next(e))}catch(e){t(e)}}function r(e){try{i(p.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof f?i:new f((function(e){e(i)}))).then(n,r)}i((p=p.apply(l,[])).next())}))}function Qe(e,{env:t=u,measurePerformance:r=!1,fileName:i="(unknown)",currentDir:o=""}={}){o&&(t.path=o),ne.maxTime=0,ne.totalTime=0,ne.interprets=0;const s={total:0,lexerTotal:0,parserTotal:0,interpretTotal:0,nodeMax:0,nodeAvg:0,nodeTotal:0,interprets:0};let a=v();if(!t.root.initialisedAsGlobal){const e=new te;return e.error=new Re(n.unknown,"Uninitialised","Global context has not been initialised with global values"),e}const c=new Fe(e,i).generate();if(c instanceof Re){const e=new te;return e.error=c,e}s.lexerTotal=v()-a,a=v();const l=new Ve(c).parse();if(l.error){const e=new te;return e.error=l.error,e}if(s.parserTotal=v()-a,a=v(),!l.node){const e=new te;return e.val=new U([]),e}const f=l.node.interpret(t);return s.interpretTotal=v()-a,s.total=v()-a,s.nodeMax=ne.maxTime,s.nodeTotal=ne.totalTime,s.nodeAvg=ne.totalTime/ne.interprets,s.interprets=ne.interprets,r&&console.log(s),Object.assign(Object.assign({},f),{timeData:s})}return t})()},842:function(e,t,n){var r;r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=21)}([function(e,t){var r={};e.exports=r,function(){r._nextId=0,r._seed=0,r._nowStartTime=+new Date,r._warnedOnce={},r._decomp=null,r.extend=function(e,t){var n,i;"boolean"==typeof t?(n=2,i=t):(n=1,i=!0);for(var o=n;o<arguments.length;o++){var s=arguments[o];if(s)for(var a in s)i&&s[a]&&s[a].constructor===Object?e[a]&&e[a].constructor!==Object?e[a]=s[a]:(e[a]=e[a]||{},r.extend(e[a],i,s[a])):e[a]=s[a]}return e},r.clone=function(e,t){return r.extend({},t,e)},r.keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)t.push(n);return t},r.values=function(e){var t=[];if(Object.keys){for(var n=Object.keys(e),r=0;r<n.length;r++)t.push(e[n[r]]);return t}for(var i in e)t.push(e[i]);return t},r.get=function(e,t,n,r){t=t.split(".").slice(n,r);for(var i=0;i<t.length;i+=1)e=e[t[i]];return e},r.set=function(e,t,n,i,o){var s=t.split(".").slice(i,o);return r.get(e,t,0,-1)[s[s.length-1]]=n,n},r.shuffle=function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(r.random()*(t+1)),i=e[t];e[t]=e[n],e[n]=i}return e},r.choose=function(e){return e[Math.floor(r.random()*e.length)]},r.isElement=function(e){return"undefined"!=typeof HTMLElement?e instanceof HTMLElement:!!(e&&e.nodeType&&e.nodeName)},r.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},r.isFunction=function(e){return"function"==typeof e},r.isPlainObject=function(e){return"object"==typeof e&&e.constructor===Object},r.isString=function(e){return"[object String]"===toString.call(e)},r.clamp=function(e,t,n){return e<t?t:e>n?n:e},r.sign=function(e){return e<0?-1:1},r.now=function(){if("undefined"!=typeof window&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-r._nowStartTime},r.random=function(t,n){return n=void 0!==n?n:1,(t=void 0!==t?t:0)+e()*(n-t)};var e=function(){return r._seed=(9301*r._seed+49297)%233280,r._seed/233280};r.colorToNumber=function(e){return 3==(e=e.replace("#","")).length&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)),parseInt(e,16)},r.logLevel=1,r.log=function(){console&&r.logLevel>0&&r.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},r.info=function(){console&&r.logLevel>0&&r.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},r.warn=function(){console&&r.logLevel>0&&r.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},r.warnOnce=function(){var e=Array.prototype.slice.call(arguments).join(" ");r._warnedOnce[e]||(r.warn(e),r._warnedOnce[e]=!0)},r.deprecated=function(e,t,n){e[t]=r.chain((function(){r.warnOnce("🔅 deprecated 🔅",n)}),e[t])},r.nextId=function(){return r._nextId++},r.indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1},r.map=function(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r+=1)n.push(t(e[r]));return n},r.topologicalSort=function(e){var t=[],n=[],i=[];for(var o in e)n[o]||i[o]||r._topologicalSort(o,n,i,e,t);return t},r._topologicalSort=function(e,t,n,i,o){var s=i[e]||[];n[e]=!0;for(var a=0;a<s.length;a+=1){var u=s[a];n[u]||t[u]||r._topologicalSort(u,t,n,i,o)}n[e]=!1,t[e]=!0,o.push(e)},r.chain=function(){for(var e=[],t=0;t<arguments.length;t+=1){var n=arguments[t];n._chained?e.push.apply(e,n._chained):e.push(n)}var r=function(){for(var t,n=new Array(arguments.length),r=0,i=arguments.length;r<i;r++)n[r]=arguments[r];for(r=0;r<e.length;r+=1){var o=e[r].apply(t,n);void 0!==o&&(t=o)}return t};return r._chained=e,r},r.chainPathBefore=function(e,t,n){return r.set(e,t,r.chain(n,r.get(e,t)))},r.chainPathAfter=function(e,t,n){return r.set(e,t,r.chain(r.get(e,t),n))},r.setDecomp=function(e){r._decomp=e},r.getDecomp=function(){var e=r._decomp;try{e||"undefined"==typeof window||(e=window.decomp),e||void 0===n.g||(e=n.g.decomp)}catch(t){e=null}return e}}()},function(e,t){var n={};e.exports=n,n.create=function(e){var t={min:{x:0,y:0},max:{x:0,y:0}};return e&&n.update(t,e),t},n.update=function(e,t,n){e.min.x=1/0,e.max.x=-1/0,e.min.y=1/0,e.max.y=-1/0;for(var r=0;r<t.length;r++){var i=t[r];i.x>e.max.x&&(e.max.x=i.x),i.x<e.min.x&&(e.min.x=i.x),i.y>e.max.y&&(e.max.y=i.y),i.y<e.min.y&&(e.min.y=i.y)}n&&(n.x>0?e.max.x+=n.x:e.min.x+=n.x,n.y>0?e.max.y+=n.y:e.min.y+=n.y)},n.contains=function(e,t){return t.x>=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y},n.overlaps=function(e,t){return e.min.x<=t.max.x&&e.max.x>=t.min.x&&e.max.y>=t.min.y&&e.min.y<=t.max.y},n.translate=function(e,t){e.min.x+=t.x,e.max.x+=t.x,e.min.y+=t.y,e.max.y+=t.y},n.shift=function(e,t){var n=e.max.x-e.min.x,r=e.max.y-e.min.y;e.min.x=t.x,e.max.x=t.x+n,e.min.y=t.y,e.max.y=t.y+r}},function(e,t){var n={};e.exports=n,n.create=function(e,t){return{x:e||0,y:t||0}},n.clone=function(e){return{x:e.x,y:e.y}},n.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},n.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},n.rotate=function(e,t,n){var r=Math.cos(t),i=Math.sin(t);n||(n={});var o=e.x*r-e.y*i;return n.y=e.x*i+e.y*r,n.x=o,n},n.rotateAbout=function(e,t,n,r){var i=Math.cos(t),o=Math.sin(t);r||(r={});var s=n.x+((e.x-n.x)*i-(e.y-n.y)*o);return r.y=n.y+((e.x-n.x)*o+(e.y-n.y)*i),r.x=s,r},n.normalise=function(e){var t=n.magnitude(e);return 0===t?{x:0,y:0}:{x:e.x/t,y:e.y/t}},n.dot=function(e,t){return e.x*t.x+e.y*t.y},n.cross=function(e,t){return e.x*t.y-e.y*t.x},n.cross3=function(e,t,n){return(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x)},n.add=function(e,t,n){return n||(n={}),n.x=e.x+t.x,n.y=e.y+t.y,n},n.sub=function(e,t,n){return n||(n={}),n.x=e.x-t.x,n.y=e.y-t.y,n},n.mult=function(e,t){return{x:e.x*t,y:e.y*t}},n.div=function(e,t){return{x:e.x/t,y:e.y/t}},n.perp=function(e,t){return{x:(t=!0===t?-1:1)*-e.y,y:t*e.x}},n.neg=function(e){return{x:-e.x,y:-e.y}},n.angle=function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},n._temp=[n.create(),n.create(),n.create(),n.create(),n.create(),n.create()]},function(e,t,n){var r={};e.exports=r;var i=n(2),o=n(0);r.create=function(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r],o={x:i.x,y:i.y,index:r,body:t,isInternal:!1};n.push(o)}return n},r.fromPath=function(e,t){var n=[];return e.replace(/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/gi,(function(e,t,r){n.push({x:parseFloat(t),y:parseFloat(r)})})),r.create(n,t)},r.centre=function(e){for(var t,n,o,s=r.area(e,!0),a={x:0,y:0},u=0;u<e.length;u++)o=(u+1)%e.length,t=i.cross(e[u],e[o]),n=i.mult(i.add(e[u],e[o]),t),a=i.add(a,n);return i.div(a,6*s)},r.mean=function(e){for(var t={x:0,y:0},n=0;n<e.length;n++)t.x+=e[n].x,t.y+=e[n].y;return i.div(t,e.length)},r.area=function(e,t){for(var n=0,r=e.length-1,i=0;i<e.length;i++)n+=(e[r].x-e[i].x)*(e[r].y+e[i].y),r=i;return t?n/2:Math.abs(n)/2},r.inertia=function(e,t){for(var n,r,o=0,s=0,a=e,u=0;u<a.length;u++)r=(u+1)%a.length,o+=(n=Math.abs(i.cross(a[r],a[u])))*(i.dot(a[r],a[r])+i.dot(a[r],a[u])+i.dot(a[u],a[u])),s+=n;return t/6*(o/s)},r.translate=function(e,t,n){n=void 0!==n?n:1;var r,i=e.length,o=t.x*n,s=t.y*n;for(r=0;r<i;r++)e[r].x+=o,e[r].y+=s;return e},r.rotate=function(e,t,n){if(0!==t){var r,i,o,s,a=Math.cos(t),u=Math.sin(t),c=n.x,l=n.y,f=e.length;for(s=0;s<f;s++)i=(r=e[s]).x-c,o=r.y-l,r.x=c+(i*a-o*u),r.y=l+(i*u+o*a);return e}},r.contains=function(e,t){for(var n,r=t.x,i=t.y,o=e.length,s=e[o-1],a=0;a<o;a++){if(n=e[a],(r-s.x)*(n.y-s.y)+(i-s.y)*(s.x-n.x)>0)return!1;s=n}return!0},r.scale=function(e,t,n,o){if(1===t&&1===n)return e;var s,a;o=o||r.centre(e);for(var u=0;u<e.length;u++)s=e[u],a=i.sub(s,o),e[u].x=o.x+a.x*t,e[u].y=o.y+a.y*n;return e},r.chamfer=function(e,t,n,r,s){t="number"==typeof t?[t]:t||[8],n=void 0!==n?n:-1,r=r||2,s=s||14;for(var a=[],u=0;u<e.length;u++){var c=e[u-1>=0?u-1:e.length-1],l=e[u],f=e[(u+1)%e.length],h=t[u<t.length?u:t.length-1];if(0!==h){var d=i.normalise({x:l.y-c.y,y:c.x-l.x}),p=i.normalise({x:f.y-l.y,y:l.x-f.x}),v=Math.sqrt(2*Math.pow(h,2)),y=i.mult(o.clone(d),h),m=i.normalise(i.mult(i.add(d,p),.5)),_=i.sub(l,i.mult(m,v)),b=n;-1===n&&(b=1.75*Math.pow(h,.32)),(b=o.clamp(b,r,s))%2==1&&(b+=1);for(var w=Math.acos(i.dot(d,p))/b,g=0;g<b;g++)a.push(i.add(i.rotate(y,w*g),_))}else a.push(l)}return a},r.clockwiseSort=function(e){var t=r.mean(e);return e.sort((function(e,n){return i.angle(t,e)-i.angle(t,n)})),e},r.isConvex=function(e){var t,n,r,i,o=0,s=e.length;if(s<3)return null;for(t=0;t<s;t++)if(r=(t+2)%s,i=(e[n=(t+1)%s].x-e[t].x)*(e[r].y-e[n].y),(i-=(e[n].y-e[t].y)*(e[r].x-e[n].x))<0?o|=1:i>0&&(o|=2),3===o)return!1;return 0!==o||null},r.hull=function(e){var t,n,r=[],o=[];for((e=e.slice(0)).sort((function(e,t){var n=e.x-t.x;return 0!==n?n:e.y-t.y})),n=0;n<e.length;n+=1){for(t=e[n];o.length>=2&&i.cross3(o[o.length-2],o[o.length-1],t)<=0;)o.pop();o.push(t)}for(n=e.length-1;n>=0;n-=1){for(t=e[n];r.length>=2&&i.cross3(r[r.length-2],r[r.length-1],t)<=0;)r.pop();r.push(t)}return r.pop(),o.pop(),r.concat(o)}},function(e,t,n){var r={};e.exports=r;var i=n(0);r.on=function(e,t,n){for(var r,i=t.split(" "),o=0;o<i.length;o++)r=i[o],e.events=e.events||{},e.events[r]=e.events[r]||[],e.events[r].push(n);return n},r.off=function(e,t,n){if(t){"function"==typeof t&&(n=t,t=i.keys(e.events).join(" "));for(var r=t.split(" "),o=0;o<r.length;o++){var s=e.events[r[o]],a=[];if(n&&s)for(var u=0;u<s.length;u++)s[u]!==n&&a.push(s[u]);e.events[r[o]]=a}}else e.events={}},r.trigger=function(e,t,n){var r,o,s,a,u=e.events;if(u&&i.keys(u).length>0){n||(n={}),r=t.split(" ");for(var c=0;c<r.length;c++)if(s=u[o=r[c]]){(a=i.clone(n,!1)).name=o,a.source=e;for(var l=0;l<s.length;l++)s[l].apply(e,[a])}}}},function(e,t,n){var r={};e.exports=r;var i=n(4),o=n(0),s=n(1),a=n(6);r.create=function(e){return o.extend({id:o.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},e)},r.setModified=function(e,t,n,i){if(e.isModified=t,t&&e.cache&&(e.cache.allBodies=null,e.cache.allConstraints=null,e.cache.allComposites=null),n&&e.parent&&r.setModified(e.parent,t,n,i),i)for(var o=0;o<e.composites.length;o++){var s=e.composites[o];r.setModified(s,t,n,i)}},r.add=function(e,t){var n=[].concat(t);i.trigger(e,"beforeAdd",{object:t});for(var s=0;s<n.length;s++){var a=n[s];switch(a.type){case"body":if(a.parent!==a){o.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}r.addBody(e,a);break;case"constraint":r.addConstraint(e,a);break;case"composite":r.addComposite(e,a);break;case"mouseConstraint":r.addConstraint(e,a.constraint)}}return i.trigger(e,"afterAdd",{object:t}),e},r.remove=function(e,t,n){var o=[].concat(t);i.trigger(e,"beforeRemove",{object:t});for(var s=0;s<o.length;s++){var a=o[s];switch(a.type){case"body":r.removeBody(e,a,n);break;case"constraint":r.removeConstraint(e,a,n);break;case"composite":r.removeComposite(e,a,n);break;case"mouseConstraint":r.removeConstraint(e,a.constraint)}}return i.trigger(e,"afterRemove",{object:t}),e},r.addComposite=function(e,t){return e.composites.push(t),t.parent=e,r.setModified(e,!0,!0,!1),e},r.removeComposite=function(e,t,n){var i=o.indexOf(e.composites,t);if(-1!==i&&r.removeCompositeAt(e,i),n)for(var s=0;s<e.composites.length;s++)r.removeComposite(e.composites[s],t,!0);return e},r.removeCompositeAt=function(e,t){return e.composites.splice(t,1),r.setModified(e,!0,!0,!1),e},r.addBody=function(e,t){return e.bodies.push(t),r.setModified(e,!0,!0,!1),e},r.removeBody=function(e,t,n){var i=o.indexOf(e.bodies,t);if(-1!==i&&r.removeBodyAt(e,i),n)for(var s=0;s<e.composites.length;s++)r.removeBody(e.composites[s],t,!0);return e},r.removeBodyAt=function(e,t){return e.bodies.splice(t,1),r.setModified(e,!0,!0,!1),e},r.addConstraint=function(e,t){return e.constraints.push(t),r.setModified(e,!0,!0,!1),e},r.removeConstraint=function(e,t,n){var i=o.indexOf(e.constraints,t);if(-1!==i&&r.removeConstraintAt(e,i),n)for(var s=0;s<e.composites.length;s++)r.removeConstraint(e.composites[s],t,!0);return e},r.removeConstraintAt=function(e,t){return e.constraints.splice(t,1),r.setModified(e,!0,!0,!1),e},r.clear=function(e,t,n){if(n)for(var i=0;i<e.composites.length;i++)r.clear(e.composites[i],t,!0);return t?e.bodies=e.bodies.filter((function(e){return e.isStatic})):e.bodies.length=0,e.constraints.length=0,e.composites.length=0,r.setModified(e,!0,!0,!1),e},r.allBodies=function(e){if(e.cache&&e.cache.allBodies)return e.cache.allBodies;for(var t=[].concat(e.bodies),n=0;n<e.composites.length;n++)t=t.concat(r.allBodies(e.composites[n]));return e.cache&&(e.cache.allBodies=t),t},r.allConstraints=function(e){if(e.cache&&e.cache.allConstraints)return e.cache.allConstraints;for(var t=[].concat(e.constraints),n=0;n<e.composites.length;n++)t=t.concat(r.allConstraints(e.composites[n]));return e.cache&&(e.cache.allConstraints=t),t},r.allComposites=function(e){if(e.cache&&e.cache.allComposites)return e.cache.allComposites;for(var t=[].concat(e.composites),n=0;n<e.composites.length;n++)t=t.concat(r.allComposites(e.composites[n]));return e.cache&&(e.cache.allComposites=t),t},r.get=function(e,t,n){var i,o;switch(n){case"body":i=r.allBodies(e);break;case"constraint":i=r.allConstraints(e);break;case"composite":i=r.allComposites(e).concat(e)}return i?0===(o=i.filter((function(e){return e.id.toString()===t.toString()}))).length?null:o[0]:null},r.move=function(e,t,n){return r.remove(e,t),r.add(n,t),e},r.rebase=function(e){for(var t=r.allBodies(e).concat(r.allConstraints(e)).concat(r.allComposites(e)),n=0;n<t.length;n++)t[n].id=o.nextId();return e},r.translate=function(e,t,n){for(var i=n?r.allBodies(e):e.bodies,o=0;o<i.length;o++)a.translate(i[o],t);return e},r.rotate=function(e,t,n,i){for(var o=Math.cos(t),s=Math.sin(t),u=i?r.allBodies(e):e.bodies,c=0;c<u.length;c++){var l=u[c],f=l.position.x-n.x,h=l.position.y-n.y;a.setPosition(l,{x:n.x+(f*o-h*s),y:n.y+(f*s+h*o)}),a.rotate(l,t)}return e},r.scale=function(e,t,n,i,o){for(var s=o?r.allBodies(e):e.bodies,u=0;u<s.length;u++){var c=s[u],l=c.position.x-i.x,f=c.position.y-i.y;a.setPosition(c,{x:i.x+l*t,y:i.y+f*n}),a.scale(c,t,n)}return e},r.bounds=function(e){for(var t=r.allBodies(e),n=[],i=0;i<t.length;i+=1){var o=t[i];n.push(o.bounds.min,o.bounds.max)}return s.create(n)}},function(e,t,n){var r={};e.exports=r;var i=n(3),o=n(2),s=n(7),a=(n(16),n(0)),u=n(1),c=n(11);!function(){r._inertiaScale=4,r._nextCollidingGroupId=1,r._nextNonCollidingGroupId=-1,r._nextCategory=1,r.create=function(t){var n={id:a.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:i.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,_original:null},r=a.extend(n,t);return e(r,t),r},r.nextGroup=function(e){return e?r._nextNonCollidingGroupId--:r._nextCollidingGroupId++},r.nextCategory=function(){return r._nextCategory=r._nextCategory<<1,r._nextCategory};var e=function(e,t){t=t||{},r.set(e,{bounds:e.bounds||u.create(e.vertices),positionPrev:e.positionPrev||o.clone(e.position),anglePrev:e.anglePrev||e.angle,vertices:e.vertices,parts:e.parts||[e],isStatic:e.isStatic,isSleeping:e.isSleeping,parent:e.parent||e}),i.rotate(e.vertices,e.angle,e.position),c.rotate(e.axes,e.angle),u.update(e.bounds,e.vertices,e.velocity),r.set(e,{axes:t.axes||e.axes,area:t.area||e.area,mass:t.mass||e.mass,inertia:t.inertia||e.inertia});var n=e.isStatic?"#14151f":a.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),s=e.isStatic?"#555":"#ccc",l=e.isStatic&&null===e.render.fillStyle?1:0;e.render.fillStyle=e.render.fillStyle||n,e.render.strokeStyle=e.render.strokeStyle||s,e.render.lineWidth=e.render.lineWidth||l,e.render.sprite.xOffset+=-(e.bounds.min.x-e.position.x)/(e.bounds.max.x-e.bounds.min.x),e.render.sprite.yOffset+=-(e.bounds.min.y-e.position.y)/(e.bounds.max.y-e.bounds.min.y)};r.set=function(e,t,n){var i;for(i in"string"==typeof t&&(i=t,(t={})[i]=n),t)if(Object.prototype.hasOwnProperty.call(t,i))switch(n=t[i],i){case"isStatic":r.setStatic(e,n);break;case"isSleeping":s.set(e,n);break;case"mass":r.setMass(e,n);break;case"density":r.setDensity(e,n);break;case"inertia":r.setInertia(e,n);break;case"vertices":r.setVertices(e,n);break;case"position":r.setPosition(e,n);break;case"angle":r.setAngle(e,n);break;case"velocity":r.setVelocity(e,n);break;case"angularVelocity":r.setAngularVelocity(e,n);break;case"parts":r.setParts(e,n);break;case"centre":r.setCentre(e,n);break;default:e[i]=n}},r.setStatic=function(e,t){for(var n=0;n<e.parts.length;n++){var r=e.parts[n];r.isStatic=t,t?(r._original={restitution:r.restitution,friction:r.friction,mass:r.mass,inertia:r.inertia,density:r.density,inverseMass:r.inverseMass,inverseInertia:r.inverseInertia},r.restitution=0,r.friction=1,r.mass=r.inertia=r.density=1/0,r.inverseMass=r.inverseInertia=0,r.positionPrev.x=r.position.x,r.positionPrev.y=r.position.y,r.anglePrev=r.angle,r.angularVelocity=0,r.speed=0,r.angularSpeed=0,r.motion=0):r._original&&(r.restitution=r._original.restitution,r.friction=r._original.friction,r.mass=r._original.mass,r.inertia=r._original.inertia,r.density=r._original.density,r.inverseMass=r._original.inverseMass,r.inverseInertia=r._original.inverseInertia,r._original=null)}},r.setMass=function(e,t){var n=e.inertia/(e.mass/6);e.inertia=n*(t/6),e.inverseInertia=1/e.inertia,e.mass=t,e.inverseMass=1/e.mass,e.density=e.mass/e.area},r.setDensity=function(e,t){r.setMass(e,t*e.area),e.density=t},r.setInertia=function(e,t){e.inertia=t,e.inverseInertia=1/e.inertia},r.setVertices=function(e,t){t[0].body===e?e.vertices=t:e.vertices=i.create(t,e),e.axes=c.fromVertices(e.vertices),e.area=i.area(e.vertices),r.setMass(e,e.density*e.area);var n=i.centre(e.vertices);i.translate(e.vertices,n,-1),r.setInertia(e,r._inertiaScale*i.inertia(e.vertices,e.mass)),i.translate(e.vertices,e.position),u.update(e.bounds,e.vertices,e.velocity)},r.setParts=function(e,t,n){var o;for(t=t.slice(0),e.parts.length=0,e.parts.push(e),e.parent=e,o=0;o<t.length;o++){var s=t[o];s!==e&&(s.parent=e,e.parts.push(s))}if(1!==e.parts.length){if(n=void 0===n||n){var a=[];for(o=0;o<t.length;o++)a=a.concat(t[o].vertices);i.clockwiseSort(a);var u=i.hull(a),c=i.centre(u);r.setVertices(e,u),i.translate(e.vertices,c)}var l=r._totalProperties(e);e.area=l.area,e.parent=e,e.position.x=l.centre.x,e.position.y=l.centre.y,e.positionPrev.x=l.centre.x,e.positionPrev.y=l.centre.y,r.setMass(e,l.mass),r.setInertia(e,l.inertia),r.setPosition(e,l.centre)}},r.setCentre=function(e,t,n){n?(e.positionPrev.x+=t.x,e.positionPrev.y+=t.y,e.position.x+=t.x,e.position.y+=t.y):(e.positionPrev.x=t.x-(e.position.x-e.positionPrev.x),e.positionPrev.y=t.y-(e.position.y-e.positionPrev.y),e.position.x=t.x,e.position.y=t.y)},r.setPosition=function(e,t){var n=o.sub(t,e.position);e.positionPrev.x+=n.x,e.positionPrev.y+=n.y;for(var r=0;r<e.parts.length;r++){var s=e.parts[r];s.position.x+=n.x,s.position.y+=n.y,i.translate(s.vertices,n),u.update(s.bounds,s.vertices,e.velocity)}},r.setAngle=function(e,t){var n=t-e.angle;e.anglePrev+=n;for(var r=0;r<e.parts.length;r++){var s=e.parts[r];s.angle+=n,i.rotate(s.vertices,n,e.position),c.rotate(s.axes,n),u.update(s.bounds,s.vertices,e.velocity),r>0&&o.rotateAbout(s.position,n,e.position,s.position)}},r.setVelocity=function(e,t){e.positionPrev.x=e.position.x-t.x,e.positionPrev.y=e.position.y-t.y,e.velocity.x=t.x,e.velocity.y=t.y,e.speed=o.magnitude(e.velocity)},r.setAngularVelocity=function(e,t){e.anglePrev=e.angle-t,e.angularVelocity=t,e.angularSpeed=Math.abs(e.angularVelocity)},r.translate=function(e,t){r.setPosition(e,o.add(e.position,t))},r.rotate=function(e,t,n){if(n){var i=Math.cos(t),o=Math.sin(t),s=e.position.x-n.x,a=e.position.y-n.y;r.setPosition(e,{x:n.x+(s*i-a*o),y:n.y+(s*o+a*i)}),r.setAngle(e,e.angle+t)}else r.setAngle(e,e.angle+t)},r.scale=function(e,t,n,o){var s=0,a=0;o=o||e.position;for(var l=0;l<e.parts.length;l++){var f=e.parts[l];i.scale(f.vertices,t,n,o),f.axes=c.fromVertices(f.vertices),f.area=i.area(f.vertices),r.setMass(f,e.density*f.area),i.translate(f.vertices,{x:-f.position.x,y:-f.position.y}),r.setInertia(f,r._inertiaScale*i.inertia(f.vertices,f.mass)),i.translate(f.vertices,{x:f.position.x,y:f.position.y}),l>0&&(s+=f.area,a+=f.inertia),f.position.x=o.x+(f.position.x-o.x)*t,f.position.y=o.y+(f.position.y-o.y)*n,u.update(f.bounds,f.vertices,e.velocity)}e.parts.length>1&&(e.area=s,e.isStatic||(r.setMass(e,e.density*s),r.setInertia(e,a))),e.circleRadius&&(t===n?e.circleRadius*=t:e.circleRadius=null)},r.update=function(e,t,n,r){var s=Math.pow(t*n*e.timeScale,2),a=1-e.frictionAir*n*e.timeScale,l=e.position.x-e.positionPrev.x,f=e.position.y-e.positionPrev.y;e.velocity.x=l*a*r+e.force.x/e.mass*s,e.velocity.y=f*a*r+e.force.y/e.mass*s,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.position.x+=e.velocity.x,e.position.y+=e.velocity.y,e.angularVelocity=(e.angle-e.anglePrev)*a*r+e.torque/e.inertia*s,e.anglePrev=e.angle,e.angle+=e.angularVelocity,e.speed=o.magnitude(e.velocity),e.angularSpeed=Math.abs(e.angularVelocity);for(var h=0;h<e.parts.length;h++){var d=e.parts[h];i.translate(d.vertices,e.velocity),h>0&&(d.position.x+=e.velocity.x,d.position.y+=e.velocity.y),0!==e.angularVelocity&&(i.rotate(d.vertices,e.angularVelocity,e.position),c.rotate(d.axes,e.angularVelocity),h>0&&o.rotateAbout(d.position,e.angularVelocity,e.position,d.position)),u.update(d.bounds,d.vertices,e.velocity)}},r.applyForce=function(e,t,n){e.force.x+=n.x,e.force.y+=n.y;var r=t.x-e.position.x,i=t.y-e.position.y;e.torque+=r*n.y-i*n.x},r._totalProperties=function(e){for(var t={mass:0,area:0,inertia:0,centre:{x:0,y:0}},n=1===e.parts.length?0:1;n<e.parts.length;n++){var r=e.parts[n],i=r.mass!==1/0?r.mass:1;t.mass+=i,t.area+=r.area,t.inertia+=r.inertia,t.centre=o.add(t.centre,o.mult(r.position,i))}return t.centre=o.div(t.centre,t.mass),t}}()},function(e,t,n){var r={};e.exports=r;var i=n(4);r._motionWakeThreshold=.18,r._motionSleepThreshold=.08,r._minBias=.9,r.update=function(e,t){for(var n=t*t*t,i=0;i<e.length;i++){var o=e[i],s=o.speed*o.speed+o.angularSpeed*o.angularSpeed;if(0===o.force.x&&0===o.force.y){var a=Math.min(o.motion,s),u=Math.max(o.motion,s);o.motion=r._minBias*a+(1-r._minBias)*u,o.sleepThreshold>0&&o.motion<r._motionSleepThreshold*n?(o.sleepCounter+=1,o.sleepCounter>=o.sleepThreshold&&r.set(o,!0)):o.sleepCounter>0&&(o.sleepCounter-=1)}else r.set(o,!1)}},r.afterCollisions=function(e,t){for(var n=t*t*t,i=0;i<e.length;i++){var o=e[i];if(o.isActive){var s=o.collision,a=s.bodyA.parent,u=s.bodyB.parent;if(!(a.isSleeping&&u.isSleeping||a.isStatic||u.isStatic)&&(a.isSleeping||u.isSleeping)){var c=a.isSleeping&&!a.isStatic?a:u,l=c===a?u:a;!c.isStatic&&l.motion>r._motionWakeThreshold*n&&r.set(c,!1)}}}},r.set=function(e,t){var n=e.isSleeping;t?(e.isSleeping=!0,e.sleepCounter=e.sleepThreshold,e.positionImpulse.x=0,e.positionImpulse.y=0,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.anglePrev=e.angle,e.speed=0,e.angularSpeed=0,e.motion=0,n||i.trigger(e,"sleepStart")):(e.isSleeping=!1,e.sleepCounter=0,n&&i.trigger(e,"sleepEnd"))}},function(e,t,n){var r={};e.exports=r;var i,o,s,a=n(3),u=n(9);i=[],o={overlap:0,axis:null},s={overlap:0,axis:null},r.create=function(e,t){return{pair:null,collided:!1,bodyA:e,bodyB:t,parentA:e.parent,parentB:t.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[]}},r.collides=function(e,t,n){if(r._overlapAxes(o,e.vertices,t.vertices,e.axes),o.overlap<=0)return null;if(r._overlapAxes(s,t.vertices,e.vertices,t.axes),s.overlap<=0)return null;var i,c,l=n&&n.table[u.id(e,t)];l?i=l.collision:((i=r.create(e,t)).collided=!0,i.bodyA=e.id<t.id?e:t,i.bodyB=e.id<t.id?t:e,i.parentA=i.bodyA.parent,i.parentB=i.bodyB.parent),e=i.bodyA,t=i.bodyB,c=o.overlap<s.overlap?o:s;var f=i.normal,h=i.supports,d=c.axis,p=d.x,v=d.y;p*(t.position.x-e.position.x)+v*(t.position.y-e.position.y)<0?(f.x=p,f.y=v):(f.x=-p,f.y=-v),i.tangent.x=-f.y,i.tangent.y=f.x,i.depth=c.overlap,i.penetration.x=f.x*i.depth,i.penetration.y=f.y*i.depth;var y=r._findSupports(e,t,f,1),m=0;if(a.contains(e.vertices,y[0])&&(h[m++]=y[0]),a.contains(e.vertices,y[1])&&(h[m++]=y[1]),m<2){var _=r._findSupports(t,e,f,-1);a.contains(t.vertices,_[0])&&(h[m++]=_[0]),m<2&&a.contains(t.vertices,_[1])&&(h[m++]=_[1])}return 0===m&&(h[m++]=y[0]),h.length=m,i},r._overlapAxes=function(e,t,n,r){var i,o,s,a,u,c,l=t.length,f=n.length,h=t[0].x,d=t[0].y,p=n[0].x,v=n[0].y,y=r.length,m=Number.MAX_VALUE,_=0;for(u=0;u<y;u++){var b=r[u],w=b.x,g=b.y,x=h*w+d*g,S=p*w+v*g,T=x,k=S;for(c=1;c<l;c+=1)(a=t[c].x*w+t[c].y*g)>T?T=a:a<x&&(x=a);for(c=1;c<f;c+=1)(a=n[c].x*w+n[c].y*g)>k?k=a:a<S&&(S=a);if((i=(o=T-S)<(s=k-x)?o:s)<m&&(m=i,_=u,i<=0))break}e.axis=r[_],e.overlap=m},r._projectToAxis=function(e,t,n){for(var r=t[0].x*n.x+t[0].y*n.y,i=r,o=1;o<t.length;o+=1){var s=t[o].x*n.x+t[o].y*n.y;s>i?i=s:s<r&&(r=s)}e.min=r,e.max=i},r._findSupports=function(e,t,n,r){var o,s,a,u,c,l=t.vertices,f=l.length,h=e.position.x,d=e.position.y,p=n.x*r,v=n.y*r,y=Number.MAX_VALUE;for(c=0;c<f;c+=1)(u=p*(h-(s=l[c]).x)+v*(d-s.y))<y&&(y=u,o=s);return y=p*(h-(a=l[(f+o.index-1)%f]).x)+v*(d-a.y),p*(h-(s=l[(o.index+1)%f]).x)+v*(d-s.y)<y?(i[0]=o,i[1]=s,i):(i[0]=o,i[1]=a,i)}},function(e,t,n){var r={};e.exports=r;var i=n(17);r.create=function(e,t){var n=e.bodyA,i=e.bodyB,o={id:r.id(n,i),bodyA:n,bodyB:i,collision:e,contacts:[],activeContacts:[],separation:0,isActive:!0,confirmedActive:!0,isSensor:n.isSensor||i.isSensor,timeCreated:t,timeUpdated:t,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return r.update(o,e,t),o},r.update=function(e,t,n){var r=e.contacts,o=t.supports,s=e.activeContacts,a=t.parentA,u=t.parentB,c=a.vertices.length;e.isActive=!0,e.timeUpdated=n,e.collision=t,e.separation=t.depth,e.inverseMass=a.inverseMass+u.inverseMass,e.friction=a.friction<u.friction?a.friction:u.friction,e.frictionStatic=a.frictionStatic>u.frictionStatic?a.frictionStatic:u.frictionStatic,e.restitution=a.restitution>u.restitution?a.restitution:u.restitution,e.slop=a.slop>u.slop?a.slop:u.slop,t.pair=e,s.length=0;for(var l=0;l<o.length;l++){var f=o[l],h=f.body===a?f.index:c+f.index,d=r[h];d?s.push(d):s.push(r[h]=i.create(f))}},r.setActive=function(e,t,n){t?(e.isActive=!0,e.timeUpdated=n):(e.isActive=!1,e.activeContacts.length=0)},r.id=function(e,t){return e.id<t.id?"A"+e.id+"B"+t.id:"A"+t.id+"B"+e.id}},function(e,t,n){var r={};e.exports=r;var i=n(3),o=n(2),s=n(7),a=n(1),u=n(11),c=n(0);r._warming=.4,r._torqueDampen=1,r._minLength=1e-6,r.create=function(e){var t=e;t.bodyA&&!t.pointA&&(t.pointA={x:0,y:0}),t.bodyB&&!t.pointB&&(t.pointB={x:0,y:0});var n=t.bodyA?o.add(t.bodyA.position,t.pointA):t.pointA,r=t.bodyB?o.add(t.bodyB.position,t.pointB):t.pointB,i=o.magnitude(o.sub(n,r));t.length=void 0!==t.length?t.length:i,t.id=t.id||c.nextId(),t.label=t.label||"Constraint",t.type="constraint",t.stiffness=t.stiffness||(t.length>0?1:.7),t.damping=t.damping||0,t.angularStiffness=t.angularStiffness||0,t.angleA=t.bodyA?t.bodyA.angle:t.angleA,t.angleB=t.bodyB?t.bodyB.angle:t.angleB,t.plugin={};var s={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return 0===t.length&&t.stiffness>.1?(s.type="pin",s.anchors=!1):t.stiffness<.9&&(s.type="spring"),t.render=c.extend(s,t.render),t},r.preSolveAll=function(e){for(var t=0;t<e.length;t+=1){var n=e[t],r=n.constraintImpulse;n.isStatic||0===r.x&&0===r.y&&0===r.angle||(n.position.x+=r.x,n.position.y+=r.y,n.angle+=r.angle)}},r.solveAll=function(e,t){for(var n=0;n<e.length;n+=1){var i=e[n],o=!i.bodyA||i.bodyA&&i.bodyA.isStatic,s=!i.bodyB||i.bodyB&&i.bodyB.isStatic;(o||s)&&r.solve(e[n],t)}for(n=0;n<e.length;n+=1)o=!(i=e[n]).bodyA||i.bodyA&&i.bodyA.isStatic,s=!i.bodyB||i.bodyB&&i.bodyB.isStatic,o||s||r.solve(e[n],t)},r.solve=function(e,t){var n=e.bodyA,i=e.bodyB,s=e.pointA,a=e.pointB;if(n||i){n&&!n.isStatic&&(o.rotate(s,n.angle-e.angleA,s),e.angleA=n.angle),i&&!i.isStatic&&(o.rotate(a,i.angle-e.angleB,a),e.angleB=i.angle);var u=s,c=a;if(n&&(u=o.add(n.position,s)),i&&(c=o.add(i.position,a)),u&&c){var l=o.sub(u,c),f=o.magnitude(l);f<r._minLength&&(f=r._minLength);var h,d,p,v,y,m=(f-e.length)/f,_=e.stiffness<1?e.stiffness*t:e.stiffness,b=o.mult(l,m*_),w=(n?n.inverseMass:0)+(i?i.inverseMass:0),g=w+((n?n.inverseInertia:0)+(i?i.inverseInertia:0));if(e.damping){var x=o.create();p=o.div(l,f),y=o.sub(i&&o.sub(i.position,i.positionPrev)||x,n&&o.sub(n.position,n.positionPrev)||x),v=o.dot(p,y)}n&&!n.isStatic&&(d=n.inverseMass/w,n.constraintImpulse.x-=b.x*d,n.constraintImpulse.y-=b.y*d,n.position.x-=b.x*d,n.position.y-=b.y*d,e.damping&&(n.positionPrev.x-=e.damping*p.x*v*d,n.positionPrev.y-=e.damping*p.y*v*d),h=o.cross(s,b)/g*r._torqueDampen*n.inverseInertia*(1-e.angularStiffness),n.constraintImpulse.angle-=h,n.angle-=h),i&&!i.isStatic&&(d=i.inverseMass/w,i.constraintImpulse.x+=b.x*d,i.constraintImpulse.y+=b.y*d,i.position.x+=b.x*d,i.position.y+=b.y*d,e.damping&&(i.positionPrev.x+=e.damping*p.x*v*d,i.positionPrev.y+=e.damping*p.y*v*d),h=o.cross(a,b)/g*r._torqueDampen*i.inverseInertia*(1-e.angularStiffness),i.constraintImpulse.angle+=h,i.angle+=h)}}},r.postSolveAll=function(e){for(var t=0;t<e.length;t++){var n=e[t],c=n.constraintImpulse;if(!(n.isStatic||0===c.x&&0===c.y&&0===c.angle)){s.set(n,!1);for(var l=0;l<n.parts.length;l++){var f=n.parts[l];i.translate(f.vertices,c),l>0&&(f.position.x+=c.x,f.position.y+=c.y),0!==c.angle&&(i.rotate(f.vertices,c.angle,n.position),u.rotate(f.axes,c.angle),l>0&&o.rotateAbout(f.position,c.angle,n.position,f.position)),a.update(f.bounds,f.vertices,n.velocity)}c.angle*=r._warming,c.x*=r._warming,c.y*=r._warming}}},r.pointAWorld=function(e){return{x:(e.bodyA?e.bodyA.position.x:0)+e.pointA.x,y:(e.bodyA?e.bodyA.position.y:0)+e.pointA.y}},r.pointBWorld=function(e){return{x:(e.bodyB?e.bodyB.position.x:0)+e.pointB.x,y:(e.bodyB?e.bodyB.position.y:0)+e.pointB.y}}},function(e,t,n){var r={};e.exports=r;var i=n(2),o=n(0);r.fromVertices=function(e){for(var t={},n=0;n<e.length;n++){var r=(n+1)%e.length,s=i.normalise({x:e[r].y-e[n].y,y:e[n].x-e[r].x}),a=0===s.y?1/0:s.x/s.y;t[a=a.toFixed(3).toString()]=s}return o.values(t)},r.rotate=function(e,t){if(0!==t)for(var n=Math.cos(t),r=Math.sin(t),i=0;i<e.length;i++){var o,s=e[i];o=s.x*n-s.y*r,s.y=s.x*r+s.y*n,s.x=o}}},function(e,t,n){var r={};e.exports=r;var i=n(3),o=n(0),s=n(6),a=n(1),u=n(2);r.rectangle=function(e,t,n,r,a){a=a||{};var u={label:"Rectangle Body",position:{x:e,y:t},vertices:i.fromPath("L 0 0 L "+n+" 0 L "+n+" "+r+" L 0 "+r)};if(a.chamfer){var c=a.chamfer;u.vertices=i.chamfer(u.vertices,c.radius,c.quality,c.qualityMin,c.qualityMax),delete a.chamfer}return s.create(o.extend({},u,a))},r.trapezoid=function(e,t,n,r,a,u){u=u||{};var c,l=n*(a*=.5),f=l+(1-2*a)*n,h=f+l;c=a<.5?"L 0 0 L "+l+" "+-r+" L "+f+" "+-r+" L "+h+" 0":"L 0 0 L "+f+" "+-r+" L "+h+" 0";var d={label:"Trapezoid Body",position:{x:e,y:t},vertices:i.fromPath(c)};if(u.chamfer){var p=u.chamfer;d.vertices=i.chamfer(d.vertices,p.radius,p.quality,p.qualityMin,p.qualityMax),delete u.chamfer}return s.create(o.extend({},d,u))},r.circle=function(e,t,n,i,s){i=i||{};var a={label:"Circle Body",circleRadius:n};s=s||25;var u=Math.ceil(Math.max(10,Math.min(s,n)));return u%2==1&&(u+=1),r.polygon(e,t,u,n,o.extend({},a,i))},r.polygon=function(e,t,n,a,u){if(u=u||{},n<3)return r.circle(e,t,a,u);for(var c=2*Math.PI/n,l="",f=.5*c,h=0;h<n;h+=1){var d=f+h*c,p=Math.cos(d)*a,v=Math.sin(d)*a;l+="L "+p.toFixed(3)+" "+v.toFixed(3)+" "}var y={label:"Polygon Body",position:{x:e,y:t},vertices:i.fromPath(l)};if(u.chamfer){var m=u.chamfer;y.vertices=i.chamfer(y.vertices,m.radius,m.quality,m.qualityMin,m.qualityMax),delete u.chamfer}return s.create(o.extend({},y,u))},r.fromVertices=function(e,t,n,r,c,l,f,h){var d,p,v,y,m,_,b,w,g,x,S=o.getDecomp();for(d=Boolean(S&&S.quickDecomp),r=r||{},v=[],c=void 0!==c&&c,l=void 0!==l?l:.01,f=void 0!==f?f:10,h=void 0!==h?h:.01,o.isArray(n[0])||(n=[n]),g=0;g<n.length;g+=1)if(m=n[g],!(y=i.isConvex(m))&&!d&&o.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),y||!d)m=y?i.clockwiseSort(m):i.hull(m),v.push({position:{x:e,y:t},vertices:m});else{var T=m.map((function(e){return[e.x,e.y]}));S.makeCCW(T),!1!==l&&S.removeCollinearPoints(T,l),!1!==h&&S.removeDuplicatePoints&&S.removeDuplicatePoints(T,h);var k=S.quickDecomp(T);for(_=0;_<k.length;_++){var E=k[_].map((function(e){return{x:e[0],y:e[1]}}));f>0&&i.area(E)<f||v.push({position:i.centre(E),vertices:E})}}for(_=0;_<v.length;_++)v[_]=s.create(o.extend(v[_],r));if(c)for(_=0;_<v.length;_++){var O=v[_];for(b=_+1;b<v.length;b++){var C=v[b];if(a.overlaps(O.bounds,C.bounds)){var P=O.vertices,A=C.vertices;for(w=0;w<O.vertices.length;w++)for(x=0;x<C.vertices.length;x++){var I=u.magnitudeSquared(u.sub(P[(w+1)%P.length],A[x])),R=u.magnitudeSquared(u.sub(P[w],A[(x+1)%A.length]));I<5&&R<5&&(P[w].isInternal=!0,A[x].isInternal=!0)}}}}return v.length>1?(p=s.create(o.extend({parts:v.slice(0)},r)),s.setPosition(p,{x:e,y:t}),p):v[0]}},function(e,t,n){var r={};e.exports=r;var i=n(0);r.create=function(e){var t={};return e||i.log("Mouse.create: element was undefined, defaulting to document.body","warn"),t.element=e||document.body,t.absolute={x:0,y:0},t.position={x:0,y:0},t.mousedownPosition={x:0,y:0},t.mouseupPosition={x:0,y:0},t.offset={x:0,y:0},t.scale={x:1,y:1},t.wheelDelta=0,t.button=-1,t.pixelRatio=parseInt(t.element.getAttribute("data-pixel-ratio"),10)||1,t.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},t.mousemove=function(e){var n=r._getRelativeMousePosition(e,t.element,t.pixelRatio);e.changedTouches&&(t.button=0,e.preventDefault()),t.absolute.x=n.x,t.absolute.y=n.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y,t.sourceEvents.mousemove=e},t.mousedown=function(e){var n=r._getRelativeMousePosition(e,t.element,t.pixelRatio);e.changedTouches?(t.button=0,e.preventDefault()):t.button=e.button,t.absolute.x=n.x,t.absolute.y=n.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y,t.mousedownPosition.x=t.position.x,t.mousedownPosition.y=t.position.y,t.sourceEvents.mousedown=e},t.mouseup=function(e){var n=r._getRelativeMousePosition(e,t.element,t.pixelRatio);e.changedTouches&&e.preventDefault(),t.button=-1,t.absolute.x=n.x,t.absolute.y=n.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y,t.mouseupPosition.x=t.position.x,t.mouseupPosition.y=t.position.y,t.sourceEvents.mouseup=e},t.mousewheel=function(e){t.wheelDelta=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail)),e.preventDefault()},r.setElement(t,t.element),t},r.setElement=function(e,t){e.element=t,t.addEventListener("mousemove",e.mousemove),t.addEventListener("mousedown",e.mousedown),t.addEventListener("mouseup",e.mouseup),t.addEventListener("mousewheel",e.mousewheel),t.addEventListener("DOMMouseScroll",e.mousewheel),t.addEventListener("touchmove",e.mousemove),t.addEventListener("touchstart",e.mousedown),t.addEventListener("touchend",e.mouseup)},r.clearSourceEvents=function(e){e.sourceEvents.mousemove=null,e.sourceEvents.mousedown=null,e.sourceEvents.mouseup=null,e.sourceEvents.mousewheel=null,e.wheelDelta=0},r.setOffset=function(e,t){e.offset.x=t.x,e.offset.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},r.setScale=function(e,t){e.scale.x=t.x,e.scale.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},r._getRelativeMousePosition=function(e,t,n){var r,i,o=t.getBoundingClientRect(),s=document.documentElement||document.body.parentNode||document.body,a=void 0!==window.pageXOffset?window.pageXOffset:s.scrollLeft,u=void 0!==window.pageYOffset?window.pageYOffset:s.scrollTop,c=e.changedTouches;return c?(r=c[0].pageX-o.left-a,i=c[0].pageY-o.top-u):(r=e.pageX-o.left-a,i=e.pageY-o.top-u),{x:r/(t.clientWidth/(t.width||t.clientWidth)*n),y:i/(t.clientHeight/(t.height||t.clientHeight)*n)}}},function(e,t,n){var r={};e.exports=r;var i=n(0),o=n(8);r.create=function(e){return i.extend({bodies:[],pairs:null},e)},r.setBodies=function(e,t){e.bodies=t.slice(0)},r.clear=function(e){e.bodies=[]},r.collisions=function(e){var t,n,i=[],s=e.pairs,a=e.bodies,u=a.length,c=r.canCollide,l=o.collides;for(a.sort(r._compareBoundsX),t=0;t<u;t++){var f=a[t],h=f.bounds,d=f.bounds.max.x,p=f.bounds.max.y,v=f.bounds.min.y,y=f.isStatic||f.isSleeping,m=f.parts.length,_=1===m;for(n=t+1;n<u;n++){var b=a[n];if((O=b.bounds).min.x>d)break;if(!(p<O.min.y||v>O.max.y)&&(!y||!b.isStatic&&!b.isSleeping)&&c(f.collisionFilter,b.collisionFilter)){var w=b.parts.length;if(_&&1===w)(k=l(f,b,s))&&i.push(k);else for(var g=w>1?1:0,x=m>1?1:0;x<m;x++)for(var S=f.parts[x],T=(h=S.bounds,g);T<w;T++){var k,E=b.parts[T],O=E.bounds;h.min.x>O.max.x||h.max.x<O.min.x||h.max.y<O.min.y||h.min.y>O.max.y||(k=l(S,E,s))&&i.push(k)}}}}return i},r.canCollide=function(e,t){return e.group===t.group&&0!==e.group?e.group>0:0!=(e.mask&t.category)&&0!=(t.mask&e.category)},r._compareBoundsX=function(e,t){return e.bounds.min.x-t.bounds.min.x}},function(e,t,n){var r={};e.exports=r;var i=n(0);r._registry={},r.register=function(e){if(r.isPlugin(e)||i.warn("Plugin.register:",r.toString(e),"does not implement all required fields."),e.name in r._registry){var t=r._registry[e.name],n=r.versionParse(e.version).number,o=r.versionParse(t.version).number;n>o?(i.warn("Plugin.register:",r.toString(t),"was upgraded to",r.toString(e)),r._registry[e.name]=e):n<o?i.warn("Plugin.register:",r.toString(t),"can not be downgraded to",r.toString(e)):e!==t&&i.warn("Plugin.register:",r.toString(e),"is already registered to different plugin object")}else r._registry[e.name]=e;return e},r.resolve=function(e){return r._registry[r.dependencyParse(e).name]},r.toString=function(e){return"string"==typeof e?e:(e.name||"anonymous")+"@"+(e.version||e.range||"0.0.0")},r.isPlugin=function(e){return e&&e.name&&e.version&&e.install},r.isUsed=function(e,t){return e.used.indexOf(t)>-1},r.isFor=function(e,t){var n=e.for&&r.dependencyParse(e.for);return!e.for||t.name===n.name&&r.versionSatisfies(t.version,n.range)},r.use=function(e,t){if(e.uses=(e.uses||[]).concat(t||[]),0!==e.uses.length){for(var n=r.dependencies(e),o=i.topologicalSort(n),s=[],a=0;a<o.length;a+=1)if(o[a]!==e.name){var u=r.resolve(o[a]);u?r.isUsed(e,u.name)||(r.isFor(u,e)||(i.warn("Plugin.use:",r.toString(u),"is for",u.for,"but installed on",r.toString(e)+"."),u._warned=!0),u.install?u.install(e):(i.warn("Plugin.use:",r.toString(u),"does not specify an install function."),u._warned=!0),u._warned?(s.push("🔶 "+r.toString(u)),delete u._warned):s.push("✅ "+r.toString(u)),e.used.push(u.name)):s.push("❌ "+o[a])}s.length>0&&i.info(s.join("  "))}else i.warn("Plugin.use:",r.toString(e),"does not specify any dependencies to install.")},r.dependencies=function(e,t){var n=r.dependencyParse(e),o=n.name;if(!(o in(t=t||{}))){e=r.resolve(e)||e,t[o]=i.map(e.uses||[],(function(t){r.isPlugin(t)&&r.register(t);var o=r.dependencyParse(t),s=r.resolve(t);return s&&!r.versionSatisfies(s.version,o.range)?(i.warn("Plugin.dependencies:",r.toString(s),"does not satisfy",r.toString(o),"used by",r.toString(n)+"."),s._warned=!0,e._warned=!0):s||(i.warn("Plugin.dependencies:",r.toString(t),"used by",r.toString(n),"could not be resolved."),e._warned=!0),o.name}));for(var s=0;s<t[o].length;s+=1)r.dependencies(t[o][s],t);return t}},r.dependencyParse=function(e){return i.isString(e)?(/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/.test(e)||i.warn("Plugin.dependencyParse:",e,"is not a valid dependency string."),{name:e.split("@")[0],range:e.split("@")[1]||"*"}):{name:e.name,range:e.range||e.version}},r.versionParse=function(e){var t=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;t.test(e)||i.warn("Plugin.versionParse:",e,"is not a valid version or range.");var n=t.exec(e),r=Number(n[4]),o=Number(n[5]),s=Number(n[6]);return{isRange:Boolean(n[1]||n[2]),version:n[3],range:e,operator:n[1]||n[2]||"",major:r,minor:o,patch:s,parts:[r,o,s],prerelease:n[7],number:1e8*r+1e4*o+s}},r.versionSatisfies=function(e,t){t=t||"*";var n=r.versionParse(t),i=r.versionParse(e);if(n.isRange){if("*"===n.operator||"*"===e)return!0;if(">"===n.operator)return i.number>n.number;if(">="===n.operator)return i.number>=n.number;if("~"===n.operator)return i.major===n.major&&i.minor===n.minor&&i.patch>=n.patch;if("^"===n.operator)return n.major>0?i.major===n.major&&i.number>=n.number:n.minor>0?i.minor===n.minor&&i.patch>=n.patch:i.patch===n.patch}return e===t||"*"===e}},function(e,t,n){var r={};e.exports=r;var i=n(0),o=n(5),s=n(1),a=n(4),u=n(2),c=n(13);!function(){var e,t;"undefined"!=typeof window&&(e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout((function(){e(i.now())}),1e3/60)},t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),r._goodFps=30,r._goodDelta=1e3/60,r.create=function(e){var t={controller:r,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",hasBounds:!!e.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},n=i.extend(t,e);return n.canvas&&(n.canvas.width=n.options.width||n.canvas.width,n.canvas.height=n.options.height||n.canvas.height),n.mouse=e.mouse,n.engine=e.engine,n.canvas=n.canvas||f(n.options.width,n.options.height),n.context=n.canvas.getContext("2d"),n.textures={},n.bounds=n.bounds||{min:{x:0,y:0},max:{x:n.canvas.width,y:n.canvas.height}},n.options.showBroadphase=!1,1!==n.options.pixelRatio&&r.setPixelRatio(n,n.options.pixelRatio),i.isElement(n.element)?n.element.appendChild(n.canvas):n.canvas.parentNode||i.log("Render.create: options.element was undefined, render.canvas was created but not appended","warn"),n},r.run=function(t){!function i(o){t.frameRequestId=e(i),n(t,o),r.world(t,o),(t.options.showStats||t.options.showDebug)&&r.stats(t,t.context,o),(t.options.showPerformance||t.options.showDebug)&&r.performance(t,t.context,o)}()},r.stop=function(e){t(e.frameRequestId)},r.setPixelRatio=function(e,t){var n=e.options,r=e.canvas;"auto"===t&&(t=h(r)),n.pixelRatio=t,r.setAttribute("data-pixel-ratio",t),r.width=n.width*t,r.height=n.height*t,r.style.width=n.width+"px",r.style.height=n.height+"px"},r.lookAt=function(e,t,n,r){r=void 0===r||r,t=i.isArray(t)?t:[t],n=n||{x:0,y:0};for(var o={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},s=0;s<t.length;s+=1){var a=t[s],u=a.bounds?a.bounds.min:a.min||a.position||a,l=a.bounds?a.bounds.max:a.max||a.position||a;u&&l&&(u.x<o.min.x&&(o.min.x=u.x),l.x>o.max.x&&(o.max.x=l.x),u.y<o.min.y&&(o.min.y=u.y),l.y>o.max.y&&(o.max.y=l.y))}var f=o.max.x-o.min.x+2*n.x,h=o.max.y-o.min.y+2*n.y,d=e.canvas.height,p=e.canvas.width/d,v=f/h,y=1,m=1;v>p?m=v/p:y=p/v,e.options.hasBounds=!0,e.bounds.min.x=o.min.x,e.bounds.max.x=o.min.x+f*y,e.bounds.min.y=o.min.y,e.bounds.max.y=o.min.y+h*m,r&&(e.bounds.min.x+=.5*f-f*y*.5,e.bounds.max.x+=.5*f-f*y*.5,e.bounds.min.y+=.5*h-h*m*.5,e.bounds.max.y+=.5*h-h*m*.5),e.bounds.min.x-=n.x,e.bounds.max.x-=n.x,e.bounds.min.y-=n.y,e.bounds.max.y-=n.y,e.mouse&&(c.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.canvas.width,y:(e.bounds.max.y-e.bounds.min.y)/e.canvas.height}),c.setOffset(e.mouse,e.bounds.min))},r.startViewTransform=function(e){var t=e.bounds.max.x-e.bounds.min.x,n=e.bounds.max.y-e.bounds.min.y,r=t/e.options.width,i=n/e.options.height;e.context.setTransform(e.options.pixelRatio/r,0,0,e.options.pixelRatio/i,0,0),e.context.translate(-e.bounds.min.x,-e.bounds.min.y)},r.endViewTransform=function(e){e.context.setTransform(e.options.pixelRatio,0,0,e.options.pixelRatio,0,0)},r.world=function(e,t){var n,l=i.now(),f=e.engine,h=f.world,d=e.canvas,v=e.context,y=e.options,m=e.timing,_=o.allBodies(h),b=o.allConstraints(h),w=y.wireframes?y.wireframeBackground:y.background,g=[],x=[],S={timestamp:f.timing.timestamp};if(a.trigger(e,"beforeRender",S),e.currentBackground!==w&&p(e,w),v.globalCompositeOperation="source-in",v.fillStyle="transparent",v.fillRect(0,0,d.width,d.height),v.globalCompositeOperation="source-over",y.hasBounds){for(n=0;n<_.length;n++){var T=_[n];s.overlaps(T.bounds,e.bounds)&&g.push(T)}for(n=0;n<b.length;n++){var k=b[n],E=k.bodyA,O=k.bodyB,C=k.pointA,P=k.pointB;E&&(C=u.add(E.position,k.pointA)),O&&(P=u.add(O.position,k.pointB)),C&&P&&(s.contains(e.bounds,C)||s.contains(e.bounds,P))&&x.push(k)}r.startViewTransform(e),e.mouse&&(c.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.options.width,y:(e.bounds.max.y-e.bounds.min.y)/e.options.height}),c.setOffset(e.mouse,e.bounds.min))}else x=b,g=_,1!==e.options.pixelRatio&&e.context.setTransform(e.options.pixelRatio,0,0,e.options.pixelRatio,0,0);!y.wireframes||f.enableSleeping&&y.showSleeping?r.bodies(e,g,v):(y.showConvexHulls&&r.bodyConvexHulls(e,g,v),r.bodyWireframes(e,g,v)),y.showBounds&&r.bodyBounds(e,g,v),(y.showAxes||y.showAngleIndicator)&&r.bodyAxes(e,g,v),y.showPositions&&r.bodyPositions(e,g,v),y.showVelocity&&r.bodyVelocity(e,g,v),y.showIds&&r.bodyIds(e,g,v),y.showSeparations&&r.separations(e,f.pairs.list,v),y.showCollisions&&r.collisions(e,f.pairs.list,v),y.showVertexNumbers&&r.vertexNumbers(e,g,v),y.showMousePosition&&r.mousePosition(e,e.mouse,v),r.constraints(x,v),y.hasBounds&&r.endViewTransform(e),a.trigger(e,"afterRender",S),m.lastElapsed=i.now()-l},r.stats=function(e,t,n){for(var r=e.engine,i=r.world,s=o.allBodies(i),a=0,u=0,c=0;c<s.length;c+=1)a+=s[c].parts.length;var l={Part:a,Body:s.length,Cons:o.allConstraints(i).length,Comp:o.allComposites(i).length,Pair:r.pairs.list.length};for(var f in t.fillStyle="#0e0f19",t.fillRect(u,0,302.5,44),t.font="12px Arial",t.textBaseline="top",t.textAlign="right",l){var h=l[f];t.fillStyle="#aaa",t.fillText(f,u+55,8),t.fillStyle="#eee",t.fillText(h,u+55,26),u+=55}},r.performance=function(e,t){var n=e.engine,i=e.timing,o=i.deltaHistory,s=i.elapsedHistory,a=i.timestampElapsedHistory,u=i.engineDeltaHistory,c=i.engineElapsedHistory,f=n.timing.lastDelta,h=l(o),d=l(s),p=l(u),v=l(c),y=l(a)/h||0,m=1e3/h||0;t.fillStyle="#0e0f19",t.fillRect(0,50,370,34),r.status(t,10,69,60,4,o.length,Math.round(m)+" fps",m/r._goodFps,(function(e){return o[e]/h-1})),r.status(t,82,69,60,4,u.length,f.toFixed(2)+" dt",r._goodDelta/f,(function(e){return u[e]/p-1})),r.status(t,154,69,60,4,c.length,v.toFixed(2)+" ut",1-v/r._goodFps,(function(e){return c[e]/v-1})),r.status(t,226,69,60,4,s.length,d.toFixed(2)+" rt",1-d/r._goodFps,(function(e){return s[e]/d-1})),r.status(t,298,69,60,4,a.length,y.toFixed(2)+" x",y*y*y,(function(e){return(a[e]/o[e]/y||0)-1}))},r.status=function(e,t,n,r,o,s,a,u,c){e.strokeStyle="#888",e.fillStyle="#444",e.lineWidth=1,e.fillRect(t,n+7,r,1),e.beginPath(),e.moveTo(t,n+7-o*i.clamp(.4*c(0),-2,2));for(var l=0;l<r;l+=1)e.lineTo(t+l,n+7-(l<s?o*i.clamp(.4*c(l),-2,2):0));e.stroke(),e.fillStyle="hsl("+i.clamp(25+95*u,0,120)+",100%,60%)",e.fillRect(t,n-7,4,4),e.font="12px Arial",e.textBaseline="middle",e.textAlign="right",e.fillStyle="#eee",e.fillText(a,t+r,n-5)},r.constraints=function(e,t){for(var n=t,r=0;r<e.length;r++){var o=e[r];if(o.render.visible&&o.pointA&&o.pointB){var s,a,c=o.bodyA,l=o.bodyB;if(s=c?u.add(c.position,o.pointA):o.pointA,"pin"===o.render.type)n.beginPath(),n.arc(s.x,s.y,3,0,2*Math.PI),n.closePath();else{if(a=l?u.add(l.position,o.pointB):o.pointB,n.beginPath(),n.moveTo(s.x,s.y),"spring"===o.render.type)for(var f,h=u.sub(a,s),d=u.perp(u.normalise(h)),p=Math.ceil(i.clamp(o.length/5,12,20)),v=1;v<p;v+=1)f=v%2==0?1:-1,n.lineTo(s.x+h.x*(v/p)+d.x*f*4,s.y+h.y*(v/p)+d.y*f*4);n.lineTo(a.x,a.y)}o.render.lineWidth&&(n.lineWidth=o.render.lineWidth,n.strokeStyle=o.render.strokeStyle,n.stroke()),o.render.anchors&&(n.fillStyle=o.render.strokeStyle,n.beginPath(),n.arc(s.x,s.y,3,0,2*Math.PI),n.arc(a.x,a.y,3,0,2*Math.PI),n.closePath(),n.fill())}}},r.bodies=function(e,t,n){var r,i,o,s,a=n,u=(e.engine,e.options),c=u.showInternalEdges||!u.wireframes;for(o=0;o<t.length;o++)if((r=t[o]).render.visible)for(s=r.parts.length>1?1:0;s<r.parts.length;s++)if((i=r.parts[s]).render.visible){if(u.showSleeping&&r.isSleeping?a.globalAlpha=.5*i.render.opacity:1!==i.render.opacity&&(a.globalAlpha=i.render.opacity),i.render.sprite&&i.render.sprite.texture&&!u.wireframes){var l=i.render.sprite,f=d(e,l.texture);a.translate(i.position.x,i.position.y),a.rotate(i.angle),a.drawImage(f,f.width*-l.xOffset*l.xScale,f.height*-l.yOffset*l.yScale,f.width*l.xScale,f.height*l.yScale),a.rotate(-i.angle),a.translate(-i.position.x,-i.position.y)}else{if(i.circleRadius)a.beginPath(),a.arc(i.position.x,i.position.y,i.circleRadius,0,2*Math.PI);else{a.beginPath(),a.moveTo(i.vertices[0].x,i.vertices[0].y);for(var h=1;h<i.vertices.length;h++)!i.vertices[h-1].isInternal||c?a.lineTo(i.vertices[h].x,i.vertices[h].y):a.moveTo(i.vertices[h].x,i.vertices[h].y),i.vertices[h].isInternal&&!c&&a.moveTo(i.vertices[(h+1)%i.vertices.length].x,i.vertices[(h+1)%i.vertices.length].y);a.lineTo(i.vertices[0].x,i.vertices[0].y),a.closePath()}u.wireframes?(a.lineWidth=1,a.strokeStyle="#bbb",a.stroke()):(a.fillStyle=i.render.fillStyle,i.render.lineWidth&&(a.lineWidth=i.render.lineWidth,a.strokeStyle=i.render.strokeStyle,a.stroke()),a.fill())}a.globalAlpha=1}},r.bodyWireframes=function(e,t,n){var r,i,o,s,a,u=n,c=e.options.showInternalEdges;for(u.beginPath(),o=0;o<t.length;o++)if((r=t[o]).render.visible)for(a=r.parts.length>1?1:0;a<r.parts.length;a++){for(i=r.parts[a],u.moveTo(i.vertices[0].x,i.vertices[0].y),s=1;s<i.vertices.length;s++)!i.vertices[s-1].isInternal||c?u.lineTo(i.vertices[s].x,i.vertices[s].y):u.moveTo(i.vertices[s].x,i.vertices[s].y),i.vertices[s].isInternal&&!c&&u.moveTo(i.vertices[(s+1)%i.vertices.length].x,i.vertices[(s+1)%i.vertices.length].y);u.lineTo(i.vertices[0].x,i.vertices[0].y)}u.lineWidth=1,u.strokeStyle="#bbb",u.stroke()},r.bodyConvexHulls=function(e,t,n){var r,i,o,s=n;for(s.beginPath(),i=0;i<t.length;i++)if((r=t[i]).render.visible&&1!==r.parts.length){for(s.moveTo(r.vertices[0].x,r.vertices[0].y),o=1;o<r.vertices.length;o++)s.lineTo(r.vertices[o].x,r.vertices[o].y);s.lineTo(r.vertices[0].x,r.vertices[0].y)}s.lineWidth=1,s.strokeStyle="rgba(255,255,255,0.2)",s.stroke()},r.vertexNumbers=function(e,t,n){var r,i,o,s=n;for(r=0;r<t.length;r++){var a=t[r].parts;for(o=a.length>1?1:0;o<a.length;o++){var u=a[o];for(i=0;i<u.vertices.length;i++)s.fillStyle="rgba(255,255,255,0.2)",s.fillText(r+"_"+i,u.position.x+.8*(u.vertices[i].x-u.position.x),u.position.y+.8*(u.vertices[i].y-u.position.y))}}},r.mousePosition=function(e,t,n){var r=n;r.fillStyle="rgba(255,255,255,0.8)",r.fillText(t.position.x+"  "+t.position.y,t.position.x+5,t.position.y-5)},r.bodyBounds=function(e,t,n){var r=n,i=(e.engine,e.options);r.beginPath();for(var o=0;o<t.length;o++)if(t[o].render.visible)for(var s=t[o].parts,a=s.length>1?1:0;a<s.length;a++){var u=s[a];r.rect(u.bounds.min.x,u.bounds.min.y,u.bounds.max.x-u.bounds.min.x,u.bounds.max.y-u.bounds.min.y)}i.wireframes?r.strokeStyle="rgba(255,255,255,0.08)":r.strokeStyle="rgba(0,0,0,0.1)",r.lineWidth=1,r.stroke()},r.bodyAxes=function(e,t,n){var r,i,o,s,a=n,u=(e.engine,e.options);for(a.beginPath(),i=0;i<t.length;i++){var c=t[i],l=c.parts;if(c.render.visible)if(u.showAxes)for(o=l.length>1?1:0;o<l.length;o++)for(r=l[o],s=0;s<r.axes.length;s++){var f=r.axes[s];a.moveTo(r.position.x,r.position.y),a.lineTo(r.position.x+20*f.x,r.position.y+20*f.y)}else for(o=l.length>1?1:0;o<l.length;o++)for(r=l[o],s=0;s<r.axes.length;s++)a.moveTo(r.position.x,r.position.y),a.lineTo((r.vertices[0].x+r.vertices[r.vertices.length-1].x)/2,(r.vertices[0].y+r.vertices[r.vertices.length-1].y)/2)}u.wireframes?(a.strokeStyle="indianred",a.lineWidth=1):(a.strokeStyle="rgba(255, 255, 255, 0.4)",a.globalCompositeOperation="overlay",a.lineWidth=2),a.stroke(),a.globalCompositeOperation="source-over"},r.bodyPositions=function(e,t,n){var r,i,o,s,a=n,u=(e.engine,e.options);for(a.beginPath(),o=0;o<t.length;o++)if((r=t[o]).render.visible)for(s=0;s<r.parts.length;s++)i=r.parts[s],a.arc(i.position.x,i.position.y,3,0,2*Math.PI,!1),a.closePath();for(u.wireframes?a.fillStyle="indianred":a.fillStyle="rgba(0,0,0,0.5)",a.fill(),a.beginPath(),o=0;o<t.length;o++)(r=t[o]).render.visible&&(a.arc(r.positionPrev.x,r.positionPrev.y,2,0,2*Math.PI,!1),a.closePath());a.fillStyle="rgba(255,165,0,0.8)",a.fill()},r.bodyVelocity=function(e,t,n){var r=n;r.beginPath();for(var i=0;i<t.length;i++){var o=t[i];o.render.visible&&(r.moveTo(o.position.x,o.position.y),r.lineTo(o.position.x+2*(o.position.x-o.positionPrev.x),o.position.y+2*(o.position.y-o.positionPrev.y)))}r.lineWidth=3,r.strokeStyle="cornflowerblue",r.stroke()},r.bodyIds=function(e,t,n){var r,i,o=n;for(r=0;r<t.length;r++)if(t[r].render.visible){var s=t[r].parts;for(i=s.length>1?1:0;i<s.length;i++){var a=s[i];o.font="12px Arial",o.fillStyle="rgba(255,255,255,0.5)",o.fillText(a.id,a.position.x+10,a.position.y-10)}}},r.collisions=function(e,t,n){var r,i,o,s,a=n,u=e.options;for(a.beginPath(),o=0;o<t.length;o++)if((r=t[o]).isActive)for(i=r.collision,s=0;s<r.activeContacts.length;s++){var c=r.activeContacts[s].vertex;a.rect(c.x-1.5,c.y-1.5,3.5,3.5)}for(u.wireframes?a.fillStyle="rgba(255,255,255,0.7)":a.fillStyle="orange",a.fill(),a.beginPath(),o=0;o<t.length;o++)if((r=t[o]).isActive&&(i=r.collision,r.activeContacts.length>0)){var l=r.activeContacts[0].vertex.x,f=r.activeContacts[0].vertex.y;2===r.activeContacts.length&&(l=(r.activeContacts[0].vertex.x+r.activeContacts[1].vertex.x)/2,f=(r.activeContacts[0].vertex.y+r.activeContacts[1].vertex.y)/2),i.bodyB===i.supports[0].body||!0===i.bodyA.isStatic?a.moveTo(l-8*i.normal.x,f-8*i.normal.y):a.moveTo(l+8*i.normal.x,f+8*i.normal.y),a.lineTo(l,f)}u.wireframes?a.strokeStyle="rgba(255,165,0,0.7)":a.strokeStyle="orange",a.lineWidth=1,a.stroke()},r.separations=function(e,t,n){var r,i,o,s,a,u=n,c=e.options;for(u.beginPath(),a=0;a<t.length;a++)if((r=t[a]).isActive){o=(i=r.collision).bodyA;var l=1;(s=i.bodyB).isStatic||o.isStatic||(l=.5),s.isStatic&&(l=0),u.moveTo(s.position.x,s.position.y),u.lineTo(s.position.x-i.penetration.x*l,s.position.y-i.penetration.y*l),l=1,s.isStatic||o.isStatic||(l=.5),o.isStatic&&(l=0),u.moveTo(o.position.x,o.position.y),u.lineTo(o.position.x+i.penetration.x*l,o.position.y+i.penetration.y*l)}c.wireframes?u.strokeStyle="rgba(255,165,0,0.5)":u.strokeStyle="orange",u.stroke()},r.inspector=function(e,t){e.engine;var n,r=e.selected,i=e.render,o=i.options;if(o.hasBounds){var s=i.bounds.max.x-i.bounds.min.x,a=i.bounds.max.y-i.bounds.min.y,u=s/i.options.width,c=a/i.options.height;t.scale(1/u,1/c),t.translate(-i.bounds.min.x,-i.bounds.min.y)}for(var l=0;l<r.length;l++){var f=r[l].data;switch(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.9)",t.setLineDash([1,2]),f.type){case"body":n=f.bounds,t.beginPath(),t.rect(Math.floor(n.min.x-3),Math.floor(n.min.y-3),Math.floor(n.max.x-n.min.x+6),Math.floor(n.max.y-n.min.y+6)),t.closePath(),t.stroke();break;case"constraint":var h=f.pointA;f.bodyA&&(h=f.pointB),t.beginPath(),t.arc(h.x,h.y,10,0,2*Math.PI),t.closePath(),t.stroke()}t.setLineDash([]),t.translate(-.5,-.5)}null!==e.selectStart&&(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.6)",t.fillStyle="rgba(255,165,0,0.1)",n=e.selectBounds,t.beginPath(),t.rect(Math.floor(n.min.x),Math.floor(n.min.y),Math.floor(n.max.x-n.min.x),Math.floor(n.max.y-n.min.y)),t.closePath(),t.stroke(),t.fill(),t.translate(-.5,-.5)),o.hasBounds&&t.setTransform(1,0,0,1,0,0)};var n=function(e,t){var n=e.engine,i=e.timing,o=i.historySize,s=n.timing.timestamp;i.delta=t-i.lastTime||r._goodDelta,i.lastTime=t,i.timestampElapsed=s-i.lastTimestamp||0,i.lastTimestamp=s,i.deltaHistory.unshift(i.delta),i.deltaHistory.length=Math.min(i.deltaHistory.length,o),i.engineDeltaHistory.unshift(n.timing.lastDelta),i.engineDeltaHistory.length=Math.min(i.engineDeltaHistory.length,o),i.timestampElapsedHistory.unshift(i.timestampElapsed),i.timestampElapsedHistory.length=Math.min(i.timestampElapsedHistory.length,o),i.engineElapsedHistory.unshift(n.timing.lastElapsed),i.engineElapsedHistory.length=Math.min(i.engineElapsedHistory.length,o),i.elapsedHistory.unshift(i.lastElapsed),i.elapsedHistory.length=Math.min(i.elapsedHistory.length,o)},l=function(e){for(var t=0,n=0;n<e.length;n+=1)t+=e[n];return t/e.length||0},f=function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n.oncontextmenu=function(){return!1},n.onselectstart=function(){return!1},n},h=function(e){var t=e.getContext("2d");return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)},d=function(e,t){var n=e.textures[t];return n||((n=e.textures[t]=new Image).src=t,n)},p=function(e,t){var n=t;/(jpg|gif|png)$/.test(t)&&(n="url("+t+")"),e.canvas.style.background=n,e.canvas.style.backgroundSize="contain",e.currentBackground=t}}()},function(e,t){var n={};e.exports=n,n.create=function(e){return{vertex:e,normalImpulse:0,tangentImpulse:0}}},function(e,t,n){var r={};e.exports=r;var i=n(7),o=n(19),s=n(14),a=n(20),u=n(4),c=n(5),l=n(10),f=n(0),h=n(6);r.create=function(e){e=e||{};var t=f.extend({positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0}},e);return t.world=e.world||c.create({label:"World"}),t.pairs=e.pairs||a.create(),t.detector=e.detector||s.create(),t.grid={buckets:[]},t.world.gravity=t.gravity,t.broadphase=t.grid,t.metrics={},t},r.update=function(e,t,n){var h=f.now();t=t||1e3/60,n=n||1;var d,p=e.world,v=e.detector,y=e.pairs,m=e.timing,_=m.timestamp;m.timestamp+=t*m.timeScale,m.lastDelta=t*m.timeScale;var b={timestamp:m.timestamp};u.trigger(e,"beforeUpdate",b);var w=c.allBodies(p),g=c.allConstraints(p);for(p.isModified&&s.setBodies(v,w),p.isModified&&c.setModified(p,!1,!1,!0),e.enableSleeping&&i.update(w,m.timeScale),r._bodiesApplyGravity(w,e.gravity),r._bodiesUpdate(w,t,m.timeScale,n,p.bounds),l.preSolveAll(w),d=0;d<e.constraintIterations;d++)l.solveAll(g,m.timeScale);l.postSolveAll(w),v.pairs=e.pairs;var x=s.collisions(v);for(a.update(y,x,_),e.enableSleeping&&i.afterCollisions(y.list,m.timeScale),y.collisionStart.length>0&&u.trigger(e,"collisionStart",{pairs:y.collisionStart}),o.preSolvePosition(y.list),d=0;d<e.positionIterations;d++)o.solvePosition(y.list,m.timeScale);for(o.postSolvePosition(w),l.preSolveAll(w),d=0;d<e.constraintIterations;d++)l.solveAll(g,m.timeScale);for(l.postSolveAll(w),o.preSolveVelocity(y.list),d=0;d<e.velocityIterations;d++)o.solveVelocity(y.list,m.timeScale);return y.collisionActive.length>0&&u.trigger(e,"collisionActive",{pairs:y.collisionActive}),y.collisionEnd.length>0&&u.trigger(e,"collisionEnd",{pairs:y.collisionEnd}),r._bodiesClearForces(w),u.trigger(e,"afterUpdate",b),e.timing.lastElapsed=f.now()-h,e},r.merge=function(e,t){if(f.extend(e,t),t.world){e.world=t.world,r.clear(e);for(var n=c.allBodies(e.world),o=0;o<n.length;o++){var s=n[o];i.set(s,!1),s.id=f.nextId()}}},r.clear=function(e){a.clear(e.pairs),s.clear(e.detector)},r._bodiesClearForces=function(e){for(var t=0;t<e.length;t++){var n=e[t];n.force.x=0,n.force.y=0,n.torque=0}},r._bodiesApplyGravity=function(e,t){var n=void 0!==t.scale?t.scale:.001;if((0!==t.x||0!==t.y)&&0!==n)for(var r=0;r<e.length;r++){var i=e[r];i.isStatic||i.isSleeping||(i.force.y+=i.mass*t.y*n,i.force.x+=i.mass*t.x*n)}},r._bodiesUpdate=function(e,t,n,r,i){for(var o=0;o<e.length;o++){var s=e[o];s.isStatic||s.isSleeping||h.update(s,t,n,r)}}},function(e,t,n){var r={};e.exports=r;var i=n(3),o=n(1);r._restingThresh=4,r._restingThreshTangent=6,r._positionDampen=.9,r._positionWarming=.8,r._frictionNormalMultiplier=5,r.preSolvePosition=function(e){var t,n,r,i=e.length;for(t=0;t<i;t++)(n=e[t]).isActive&&(r=n.activeContacts.length,n.collision.parentA.totalContacts+=r,n.collision.parentB.totalContacts+=r)},r.solvePosition=function(e,t){var n,i,o,s,a,u,c,l,f=r._positionDampen,h=e.length;for(n=0;n<h;n++)(i=e[n]).isActive&&!i.isSensor&&(s=(o=i.collision).parentA,a=o.parentB,u=o.normal,i.separation=u.x*(a.positionImpulse.x+o.penetration.x-s.positionImpulse.x)+u.y*(a.positionImpulse.y+o.penetration.y-s.positionImpulse.y));for(n=0;n<h;n++)(i=e[n]).isActive&&!i.isSensor&&(s=(o=i.collision).parentA,a=o.parentB,u=o.normal,l=(i.separation-i.slop)*t,(s.isStatic||a.isStatic)&&(l*=2),s.isStatic||s.isSleeping||(c=f/s.totalContacts,s.positionImpulse.x+=u.x*l*c,s.positionImpulse.y+=u.y*l*c),a.isStatic||a.isSleeping||(c=f/a.totalContacts,a.positionImpulse.x-=u.x*l*c,a.positionImpulse.y-=u.y*l*c))},r.postSolvePosition=function(e){for(var t=r._positionWarming,n=e.length,s=i.translate,a=o.update,u=0;u<n;u++){var c=e[u],l=c.positionImpulse,f=l.x,h=l.y,d=c.velocity;if(c.totalContacts=0,0!==f||0!==h){for(var p=0;p<c.parts.length;p++){var v=c.parts[p];s(v.vertices,l),a(v.bounds,v.vertices,d),v.position.x+=f,v.position.y+=h}c.positionPrev.x+=f,c.positionPrev.y+=h,f*d.x+h*d.y<0?(l.x=0,l.y=0):(l.x*=t,l.y*=t)}}},r.preSolveVelocity=function(e){var t,n,r=e.length;for(t=0;t<r;t++){var i=e[t];if(i.isActive&&!i.isSensor){var o=i.activeContacts,s=o.length,a=i.collision,u=a.parentA,c=a.parentB,l=a.normal,f=a.tangent;for(n=0;n<s;n++){var h=o[n],d=h.vertex,p=h.normalImpulse,v=h.tangentImpulse;if(0!==p||0!==v){var y=l.x*p+f.x*v,m=l.y*p+f.y*v;u.isStatic||u.isSleeping||(u.positionPrev.x+=y*u.inverseMass,u.positionPrev.y+=m*u.inverseMass,u.anglePrev+=u.inverseInertia*((d.x-u.position.x)*m-(d.y-u.position.y)*y)),c.isStatic||c.isSleeping||(c.positionPrev.x-=y*c.inverseMass,c.positionPrev.y-=m*c.inverseMass,c.anglePrev-=c.inverseInertia*((d.x-c.position.x)*m-(d.y-c.position.y)*y))}}}}},r.solveVelocity=function(e,t){var n,i,o,s,a=t*t,u=r._restingThresh*a,c=r._frictionNormalMultiplier,l=r._restingThreshTangent*a,f=Number.MAX_VALUE,h=e.length;for(o=0;o<h;o++){var d=e[o];if(d.isActive&&!d.isSensor){var p=d.collision,v=p.parentA,y=p.parentB,m=v.velocity,_=y.velocity,b=p.normal.x,w=p.normal.y,g=p.tangent.x,x=p.tangent.y,S=d.activeContacts,T=S.length,k=1/T,E=v.inverseMass+y.inverseMass,O=d.friction*d.frictionStatic*c*a;for(m.x=v.position.x-v.positionPrev.x,m.y=v.position.y-v.positionPrev.y,_.x=y.position.x-y.positionPrev.x,_.y=y.position.y-y.positionPrev.y,v.angularVelocity=v.angle-v.anglePrev,y.angularVelocity=y.angle-y.anglePrev,s=0;s<T;s++){var C=S[s],P=C.vertex,A=P.x-v.position.x,I=P.y-v.position.y,R=P.x-y.position.x,N=P.y-y.position.y,B=m.x-I*v.angularVelocity,M=m.y+A*v.angularVelocity,D=B-(_.x-N*y.angularVelocity),$=M-(_.y+R*y.angularVelocity),U=b*D+w*$,L=g*D+x*$,j=d.separation+U,G=Math.min(j,1),W=(G=j<0?0:G)*O;L>W||-L>W?(i=L>0?L:-L,(n=d.friction*(L>0?1:-1)*a)<-i?n=-i:n>i&&(n=i)):(n=L,i=f);var q=A*w-I*b,F=R*w-N*b,z=k/(E+v.inverseInertia*q*q+y.inverseInertia*F*F),V=(1+d.restitution)*U*z;if(n*=z,U*U>u&&U<0)C.normalImpulse=0;else{var K=C.normalImpulse;C.normalImpulse+=V,C.normalImpulse=Math.min(C.normalImpulse,0),V=C.normalImpulse-K}if(L*L>l)C.tangentImpulse=0;else{var Q=C.tangentImpulse;C.tangentImpulse+=n,C.tangentImpulse<-i&&(C.tangentImpulse=-i),C.tangentImpulse>i&&(C.tangentImpulse=i),n=C.tangentImpulse-Q}var Y=b*V+g*n,H=w*V+x*n;v.isStatic||v.isSleeping||(v.positionPrev.x+=Y*v.inverseMass,v.positionPrev.y+=H*v.inverseMass,v.anglePrev+=(A*H-I*Y)*v.inverseInertia),y.isStatic||y.isSleeping||(y.positionPrev.x-=Y*y.inverseMass,y.positionPrev.y-=H*y.inverseMass,y.anglePrev-=(R*H-N*Y)*y.inverseInertia)}}}}},function(e,t,n){var r={};e.exports=r;var i=n(9),o=n(0);r.create=function(e){return o.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},e)},r.update=function(e,t,n){var r,o,s,a,u=e.list,c=u.length,l=e.table,f=t.length,h=e.collisionStart,d=e.collisionEnd,p=e.collisionActive;for(h.length=0,d.length=0,p.length=0,a=0;a<c;a++)u[a].confirmedActive=!1;for(a=0;a<f;a++)(s=(r=t[a]).pair)?(s.isActive?p.push(s):h.push(s),i.update(s,r,n),s.confirmedActive=!0):(l[(s=i.create(r,n)).id]=s,h.push(s),u.push(s));var v=[];for(c=u.length,a=0;a<c;a++)(s=u[a]).confirmedActive||(i.setActive(s,!1,n),d.push(s),s.collision.bodyA.isSleeping||s.collision.bodyB.isSleeping||v.push(a));for(a=0;a<v.length;a++)s=u[o=v[a]-a],u.splice(o,1),delete l[s.id]},r.clear=function(e){return e.table={},e.list.length=0,e.collisionStart.length=0,e.collisionActive.length=0,e.collisionEnd.length=0,e}},function(e,t,n){var r=e.exports=n(22);r.Axes=n(11),r.Bodies=n(12),r.Body=n(6),r.Bounds=n(1),r.Collision=n(8),r.Common=n(0),r.Composite=n(5),r.Composites=n(23),r.Constraint=n(10),r.Contact=n(17),r.Detector=n(14),r.Engine=n(18),r.Events=n(4),r.Grid=n(24),r.Mouse=n(13),r.MouseConstraint=n(25),r.Pair=n(9),r.Pairs=n(20),r.Plugin=n(15),r.Query=n(26),r.Render=n(16),r.Resolver=n(19),r.Runner=n(27),r.SAT=n(28),r.Sleeping=n(7),r.Svg=n(29),r.Vector=n(2),r.Vertices=n(3),r.World=n(30),r.Engine.run=r.Runner.run,r.Common.deprecated(r.Engine,"run","Engine.run ➤ use Matter.Runner.run(engine) instead")},function(e,t,n){var r={};e.exports=r;var i=n(15),o=n(0);r.name="matter-js",r.version="0.18.0",r.uses=[],r.used=[],r.use=function(){i.use(r,Array.prototype.slice.call(arguments))},r.before=function(e,t){return e=e.replace(/^Matter./,""),o.chainPathBefore(r,e,t)},r.after=function(e,t){return e=e.replace(/^Matter./,""),o.chainPathAfter(r,e,t)}},function(e,t,n){var r={};e.exports=r;var i=n(5),o=n(10),s=n(0),a=n(6),u=n(12),c=s.deprecated;r.stack=function(e,t,n,r,o,s,u){for(var c,l=i.create({label:"Stack"}),f=e,h=t,d=0,p=0;p<r;p++){for(var v=0,y=0;y<n;y++){var m=u(f,h,y,p,c,d);if(m){var _=m.bounds.max.y-m.bounds.min.y,b=m.bounds.max.x-m.bounds.min.x;_>v&&(v=_),a.translate(m,{x:.5*b,y:.5*_}),f=m.bounds.max.x+o,i.addBody(l,m),c=m,d+=1}else f+=o}h+=v+s,f=e}return l},r.chain=function(e,t,n,r,a,u){for(var c=e.bodies,l=1;l<c.length;l++){var f=c[l-1],h=c[l],d=f.bounds.max.y-f.bounds.min.y,p=f.bounds.max.x-f.bounds.min.x,v=h.bounds.max.y-h.bounds.min.y,y={bodyA:f,pointA:{x:p*t,y:d*n},bodyB:h,pointB:{x:(h.bounds.max.x-h.bounds.min.x)*r,y:v*a}},m=s.extend(y,u);i.addConstraint(e,o.create(m))}return e.label+=" Chain",e},r.mesh=function(e,t,n,r,a){var u,c,l,f,h,d=e.bodies;for(u=0;u<n;u++){for(c=1;c<t;c++)l=d[c-1+u*t],f=d[c+u*t],i.addConstraint(e,o.create(s.extend({bodyA:l,bodyB:f},a)));if(u>0)for(c=0;c<t;c++)l=d[c+(u-1)*t],f=d[c+u*t],i.addConstraint(e,o.create(s.extend({bodyA:l,bodyB:f},a))),r&&c>0&&(h=d[c-1+(u-1)*t],i.addConstraint(e,o.create(s.extend({bodyA:h,bodyB:f},a)))),r&&c<t-1&&(h=d[c+1+(u-1)*t],i.addConstraint(e,o.create(s.extend({bodyA:h,bodyB:f},a))))}return e.label+=" Mesh",e},r.pyramid=function(e,t,n,i,o,s,u){return r.stack(e,t,n,i,o,s,(function(t,r,s,c,l,f){var h=Math.min(i,Math.ceil(n/2)),d=l?l.bounds.max.x-l.bounds.min.x:0;if(!(c>h||s<(c=h-c)||s>n-1-c))return 1===f&&a.translate(l,{x:(s+(n%2==1?1:-1))*d,y:0}),u(e+(l?s*d:0)+s*o,r,s,c,l,f)}))},r.newtonsCradle=function(e,t,n,r,s){for(var a=i.create({label:"Newtons Cradle"}),c=0;c<n;c++){var l=u.circle(e+c*(1.9*r),t+s,r,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),f=o.create({pointA:{x:e+c*(1.9*r),y:t},bodyB:l});i.addBody(a,l),i.addConstraint(a,f)}return a},c(r,"newtonsCradle","Composites.newtonsCradle ➤ moved to newtonsCradle example"),r.car=function(e,t,n,r,s){var c=a.nextGroup(!0),l=.5*-n+20,f=.5*n-20,h=i.create({label:"Car"}),d=u.rectangle(e,t,n,r,{collisionFilter:{group:c},chamfer:{radius:.5*r},density:2e-4}),p=u.circle(e+l,t+0,s,{collisionFilter:{group:c},friction:.8}),v=u.circle(e+f,t+0,s,{collisionFilter:{group:c},friction:.8}),y=o.create({bodyB:d,pointB:{x:l,y:0},bodyA:p,stiffness:1,length:0}),m=o.create({bodyB:d,pointB:{x:f,y:0},bodyA:v,stiffness:1,length:0});return i.addBody(h,d),i.addBody(h,p),i.addBody(h,v),i.addConstraint(h,y),i.addConstraint(h,m),h},c(r,"car","Composites.car ➤ moved to car example"),r.softBody=function(e,t,n,i,o,a,c,l,f,h){f=s.extend({inertia:1/0},f),h=s.extend({stiffness:.2,render:{type:"line",anchors:!1}},h);var d=r.stack(e,t,n,i,o,a,(function(e,t){return u.circle(e,t,l,f)}));return r.mesh(d,n,i,c,h),d.label="Soft Body",d},c(r,"softBody","Composites.softBody ➤ moved to softBody and cloth examples")},function(e,t,n){var r={};e.exports=r;var i=n(9),o=n(0),s=o.deprecated;r.create=function(e){return o.extend({buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48},e)},r.update=function(e,t,n,i){var o,s,a,u,c,l=n.world,f=e.buckets,h=!1;for(o=0;o<t.length;o++){var d=t[o];if((!d.isSleeping||i)&&(!l.bounds||!(d.bounds.max.x<l.bounds.min.x||d.bounds.min.x>l.bounds.max.x||d.bounds.max.y<l.bounds.min.y||d.bounds.min.y>l.bounds.max.y))){var p=r._getRegion(e,d);if(!d.region||p.id!==d.region.id||i){d.region&&!i||(d.region=p);var v=r._regionUnion(p,d.region);for(s=v.startCol;s<=v.endCol;s++)for(a=v.startRow;a<=v.endRow;a++){u=f[c=r._getBucketId(s,a)];var y=s>=p.startCol&&s<=p.endCol&&a>=p.startRow&&a<=p.endRow,m=s>=d.region.startCol&&s<=d.region.endCol&&a>=d.region.startRow&&a<=d.region.endRow;!y&&m&&m&&u&&r._bucketRemoveBody(e,u,d),(d.region===p||y&&!m||i)&&(u||(u=r._createBucket(f,c)),r._bucketAddBody(e,u,d))}d.region=p,h=!0}}}h&&(e.pairsList=r._createActivePairsList(e))},s(r,"update","Grid.update ➤ replaced by Matter.Detector"),r.clear=function(e){e.buckets={},e.pairs={},e.pairsList=[]},s(r,"clear","Grid.clear ➤ replaced by Matter.Detector"),r._regionUnion=function(e,t){var n=Math.min(e.startCol,t.startCol),i=Math.max(e.endCol,t.endCol),o=Math.min(e.startRow,t.startRow),s=Math.max(e.endRow,t.endRow);return r._createRegion(n,i,o,s)},r._getRegion=function(e,t){var n=t.bounds,i=Math.floor(n.min.x/e.bucketWidth),o=Math.floor(n.max.x/e.bucketWidth),s=Math.floor(n.min.y/e.bucketHeight),a=Math.floor(n.max.y/e.bucketHeight);return r._createRegion(i,o,s,a)},r._createRegion=function(e,t,n,r){return{id:e+","+t+","+n+","+r,startCol:e,endCol:t,startRow:n,endRow:r}},r._getBucketId=function(e,t){return"C"+e+"R"+t},r._createBucket=function(e,t){return e[t]=[]},r._bucketAddBody=function(e,t,n){var r,o=e.pairs,s=i.id,a=t.length;for(r=0;r<a;r++){var u=t[r];if(!(n.id===u.id||n.isStatic&&u.isStatic)){var c=s(n,u),l=o[c];l?l[2]+=1:o[c]=[n,u,1]}}t.push(n)},r._bucketRemoveBody=function(e,t,n){var r,s=e.pairs,a=i.id;t.splice(o.indexOf(t,n),1);var u=t.length;for(r=0;r<u;r++){var c=s[a(n,t[r])];c&&(c[2]-=1)}},r._createActivePairsList=function(e){var t,n,r=e.pairs,i=o.keys(r),s=i.length,a=[];for(n=0;n<s;n++)(t=r[i[n]])[2]>0?a.push(t):delete r[i[n]];return a}},function(e,t,n){var r={};e.exports=r;var i=n(3),o=n(7),s=n(13),a=n(4),u=n(14),c=n(10),l=n(5),f=n(0),h=n(1);r.create=function(e,t){var n=(e?e.mouse:null)||(t?t.mouse:null);n||(e&&e.render&&e.render.canvas?n=s.create(e.render.canvas):t&&t.element?n=s.create(t.element):(n=s.create(),f.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var i={type:"mouseConstraint",mouse:n,element:null,body:null,constraint:c.create({label:"Mouse Constraint",pointA:n.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),collisionFilter:{category:1,mask:4294967295,group:0}},o=f.extend(i,t);return a.on(e,"beforeUpdate",(function(){var t=l.allBodies(e.world);r.update(o,t),r._triggerEvents(o)})),o},r.update=function(e,t){var n=e.mouse,r=e.constraint,s=e.body;if(0===n.button){if(r.bodyB)o.set(r.bodyB,!1),r.pointA=n.position;else for(var c=0;c<t.length;c++)if(s=t[c],h.contains(s.bounds,n.position)&&u.canCollide(s.collisionFilter,e.collisionFilter))for(var l=s.parts.length>1?1:0;l<s.parts.length;l++){var f=s.parts[l];if(i.contains(f.vertices,n.position)){r.pointA=n.position,r.bodyB=e.body=s,r.pointB={x:n.position.x-s.position.x,y:n.position.y-s.position.y},r.angleB=s.angle,o.set(s,!1),a.trigger(e,"startdrag",{mouse:n,body:s});break}}}else r.bodyB=e.body=null,r.pointB=null,s&&a.trigger(e,"enddrag",{mouse:n,body:s})},r._triggerEvents=function(e){var t=e.mouse,n=t.sourceEvents;n.mousemove&&a.trigger(e,"mousemove",{mouse:t}),n.mousedown&&a.trigger(e,"mousedown",{mouse:t}),n.mouseup&&a.trigger(e,"mouseup",{mouse:t}),s.clearSourceEvents(t)}},function(e,t,n){var r={};e.exports=r;var i=n(2),o=n(8),s=n(1),a=n(12),u=n(3);r.collides=function(e,t){for(var n=[],r=t.length,i=e.bounds,a=o.collides,u=s.overlaps,c=0;c<r;c++){var l=t[c],f=l.parts.length,h=1===f?0:1;if(u(l.bounds,i))for(var d=h;d<f;d++){var p=l.parts[d];if(u(p.bounds,i)){var v=a(p,e);if(v){n.push(v);break}}}}return n},r.ray=function(e,t,n,o){o=o||1e-100;for(var s=i.angle(t,n),u=i.magnitude(i.sub(t,n)),c=.5*(n.x+t.x),l=.5*(n.y+t.y),f=a.rectangle(c,l,u,o,{angle:s}),h=r.collides(f,e),d=0;d<h.length;d+=1){var p=h[d];p.body=p.bodyB=p.bodyA}return h},r.region=function(e,t,n){for(var r=[],i=0;i<e.length;i++){var o=e[i],a=s.overlaps(o.bounds,t);(a&&!n||!a&&n)&&r.push(o)}return r},r.point=function(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r];if(s.contains(i.bounds,t))for(var o=1===i.parts.length?0:1;o<i.parts.length;o++){var a=i.parts[o];if(s.contains(a.bounds,t)&&u.contains(a.vertices,t)){n.push(i);break}}}return n}},function(e,t,n){var r={};e.exports=r;var i,o,s,a=n(4),u=n(18),c=n(0);"undefined"!=typeof window&&(i=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,o=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),i||(i=function(e){s=setTimeout((function(){e(c.now())}),1e3/60)},o=function(){clearTimeout(s)}),r.create=function(e){var t=c.extend({fps:60,correction:1,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:!1,enabled:!0},e);return t.delta=t.delta||1e3/t.fps,t.deltaMin=t.deltaMin||1e3/t.fps,t.deltaMax=t.deltaMax||1e3/(.5*t.fps),t.fps=1e3/t.delta,t},r.run=function(e,t){return void 0!==e.positionIterations&&(t=e,e=r.create()),function n(o){e.frameRequestId=i(n),o&&e.enabled&&r.tick(e,t,o)}(),e},r.tick=function(e,t,n){var r,i=t.timing,o=1,s={timestamp:i.timestamp};a.trigger(e,"beforeTick",s),e.isFixed?r=e.delta:(r=n-e.timePrev||e.delta,e.timePrev=n,e.deltaHistory.push(r),e.deltaHistory=e.deltaHistory.slice(-e.deltaSampleSize),o=(r=(r=(r=Math.min.apply(null,e.deltaHistory))<e.deltaMin?e.deltaMin:r)>e.deltaMax?e.deltaMax:r)/e.delta,e.delta=r),0!==e.timeScalePrev&&(o*=i.timeScale/e.timeScalePrev),0===i.timeScale&&(o=0),e.timeScalePrev=i.timeScale,e.correction=o,e.frameCounter+=1,n-e.counterTimestamp>=1e3&&(e.fps=e.frameCounter*((n-e.counterTimestamp)/1e3),e.counterTimestamp=n,e.frameCounter=0),a.trigger(e,"tick",s),a.trigger(e,"beforeUpdate",s),u.update(t,r,o),a.trigger(e,"afterUpdate",s),a.trigger(e,"afterTick",s)},r.stop=function(e){o(e.frameRequestId)},r.start=function(e,t){r.run(e,t)}},function(e,t,n){var r={};e.exports=r;var i=n(8),o=n(0).deprecated;r.collides=function(e,t){return i.collides(e,t)},o(r,"collides","SAT.collides ➤ replaced by Collision.collides")},function(e,t,n){var r={};e.exports=r,n(1);var i=n(0);r.pathToVertices=function(e,t){"undefined"==typeof window||"SVGPathSeg"in window||i.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var n,o,s,a,u,c,l,f,h,d,p,v=[],y=0,m=0,_=0;t=t||15;var b=function(e,t,n){var r=n%2==1&&n>1;if(!h||e!=h.x||t!=h.y){h&&r?(d=h.x,p=h.y):(d=0,p=0);var i={x:d+e,y:p+t};!r&&h||(h=i),v.push(i),m=d+e,_=p+t}},w=function(e){var t=e.pathSegTypeAsLetter.toUpperCase();if("Z"!==t){switch(t){case"M":case"L":case"T":case"C":case"S":case"Q":m=e.x,_=e.y;break;case"H":m=e.x;break;case"V":_=e.y}b(m,_,e.pathSegType)}};for(r._svgPathToAbsolute(e),s=e.getTotalLength(),c=[],n=0;n<e.pathSegList.numberOfItems;n+=1)c.push(e.pathSegList.getItem(n));for(l=c.concat();y<s;){if((u=c[e.getPathSegAtLength(y)])!=f){for(;l.length&&l[0]!=u;)w(l.shift());f=u}switch(u.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":a=e.getPointAtLength(y),b(a.x,a.y,0)}y+=t}for(n=0,o=l.length;n<o;++n)w(l[n]);return v},r._svgPathToAbsolute=function(e){for(var t,n,r,i,o,s,a=e.pathSegList,u=0,c=0,l=a.numberOfItems,f=0;f<l;++f){var h=a.getItem(f),d=h.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(d))"x"in h&&(u=h.x),"y"in h&&(c=h.y);else switch("x1"in h&&(r=u+h.x1),"x2"in h&&(o=u+h.x2),"y1"in h&&(i=c+h.y1),"y2"in h&&(s=c+h.y2),"x"in h&&(u+=h.x),"y"in h&&(c+=h.y),d){case"m":a.replaceItem(e.createSVGPathSegMovetoAbs(u,c),f);break;case"l":a.replaceItem(e.createSVGPathSegLinetoAbs(u,c),f);break;case"h":a.replaceItem(e.createSVGPathSegLinetoHorizontalAbs(u),f);break;case"v":a.replaceItem(e.createSVGPathSegLinetoVerticalAbs(c),f);break;case"c":a.replaceItem(e.createSVGPathSegCurvetoCubicAbs(u,c,r,i,o,s),f);break;case"s":a.replaceItem(e.createSVGPathSegCurvetoCubicSmoothAbs(u,c,o,s),f);break;case"q":a.replaceItem(e.createSVGPathSegCurvetoQuadraticAbs(u,c,r,i),f);break;case"t":a.replaceItem(e.createSVGPathSegCurvetoQuadraticSmoothAbs(u,c),f);break;case"a":a.replaceItem(e.createSVGPathSegArcAbs(u,c,h.r1,h.r2,h.angle,h.largeArcFlag,h.sweepFlag),f);break;case"z":case"Z":u=t,c=n}"M"!=d&&"m"!=d||(t=u,n=c)}}},function(e,t,n){var r={};e.exports=r;var i=n(5);n(0),r.create=i.create,r.add=i.add,r.remove=i.remove,r.clear=i.clear,r.addComposite=i.addComposite,r.addBody=i.addBody,r.addConstraint=i.addConstraint}])},e.exports=r()}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var o=n[e]={exports:{}};return t[e].call(o.exports,o,o.exports,r),o.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};(()=>{"use strict";r.r(i),r.d(i,{Body:()=>O,Camera:()=>Y,CircleCollider:()=>v,CircleRenderer:()=>U,Collider:()=>p,Component:()=>l,Entity:()=>ue,EntropyEngine:()=>Ce,GUIBox:()=>W,GUICircle:()=>q,GUIElement:()=>G,GUIImage:()=>F,GUIPolygon:()=>z,GUIRect:()=>V,GUIText:()=>K,GUITextBox:()=>Q,ImageRenderer2D:()=>j,JSONifyComponent:()=>x,MeshV2:()=>ve,MeshV3:()=>me,RectCollider:()=>y,RectRenderer:()=>L,Scene:()=>J,Script:()=>h,Systems:()=>de,Transform:()=>X,TriangleV2:()=>pe,TriangleV3:()=>ye,circle:()=>I,colour:()=>n,cullString:()=>T,defaultSceneSettings:()=>H,drawCameraViewArea:()=>Te,drawCameras:()=>Se,entitiesFromJSON:()=>se,genCacheBust:()=>E,getCanvasSize:()=>_,getCanvasStuff:()=>w,getMousePos:()=>le,getZoomScaledPosition:()=>b,image:()=>M,initialiseEntropyScript:()=>be,initialiseScenes:()=>ae,input:()=>fe,nameFromScriptURL:()=>k,polygon:()=>N,rect:()=>R,renderAll:()=>ge,renderBackground:()=>we,renderDebug:()=>ke,renderSelectedOutline:()=>Ee,reset:()=>C,rgb:()=>o,rgbValToHex:()=>u,rgba:()=>a,rotateAroundPointWrapper:()=>P,roundedRect:()=>A,runFromJSON:()=>Ie,scaleMeshV2:()=>S,setCanvasSize:()=>g,sleep:()=>m,startAnimation:()=>ce,text:()=>B,v2:()=>t,v3:()=>e});class e{constructor(n,r=n,i=n,o=1){this.add=e=>(this.x+=(null==e?void 0:e.x)||0,this.y+=(null==e?void 0:e.y)||0,this.z+=(null==e?void 0:e.z)||0,this),this.sub=e=>(this.x-=e.x||0,this.y-=e.y||0,this.z-=e.z||0,this),this.mul=e=>(this.x*=e.x,this.y*=e.y,this.z*=e.z,this),this.scale=e=>(this.x*=e,this.y*=e,this.z*=e,this),this.div=e=>(0!==e.x&&(this.x/=e.x),0!==e.y&&(this.y/=e.y),0!==e.z&&(this.z/=e.z),this),this.distTo=e=>this.clone.sub(e).magnitude,this.diff=t=>new e(Math.abs(this.x-t.x),Math.abs(this.y-t.y),Math.abs(this.z-t.z)),this.normalise=()=>{const e=this.magnitude;return 0!==e?this.scale(1/e):console.error("Cannot normalise vector with magnitude 0"),this},this.equals=e=>e.x===this.x&&e.y===this.y&&e.z===this.z,this.isInCuboid=(e,n)=>new t(this.x,this.y).isInRect(new t(e.x,e.y),new t(n.x,n.y))&&new t(this.y,this.z).isInRect(new t(e.y,e.z),new t(n.y,n.z))&&new t(this.x,this.z).isInRect(new t(e.x,e.z),new t(n.x,n.z)),this.set=e=>(this.x=e.x,this.y=e.y,this.z=e.z,this),this.apply=e=>{this.x=e(this.x),this.y=e(this.y),this.z=e(this.z)},this.dot=e=>this.x*e.x+this.y*e.y+this.z*e.z,this.cross=e=>this.x*e.y-this.y*e.x-this.z*e.z,this.toInt=()=>(this.apply(Math.round),this),this.x=n,this.y=r,this.z=i,this.w=o}get magnitude(){let e=Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2);return 0===e?0:Math.sqrt(e)}get clone(){return new e(this.x,this.y,this.z)}get str(){return`x: ${this.x} \ny: ${this.y} \nz: ${this.z}`}get negative(){return this.clone.scale(-1)}get v2(){return new t(this.x,this.y)}get array(){return[this.x,this.y,this.z]}static get up(){return new e(0,1,0)}static get down(){return new e(0,-1,0)}static get right(){return new e(1,0,0)}static get left(){return new e(-1,0,0)}static get forward(){return new e(0,0,1)}static get back(){return new e(0,0,-1)}static get zero(){return new e(0,0,0)}static avPoint(t){let n=e.zero;for(let e of t)n.add(e);return n.scale(1/t.length)}static fromArray(t){return new e(t[0],t[1],t[2])}}class t{constructor(e,t=e){this.x=e,this.y=t}add(e){return this.x+=e.x,this.y+=e.y,this}sub(e){return this.x-=e.x,this.y-=e.y,this}mul(e){return this.x*=e.x,this.y*=e.y,this}scale(e){return this.x*=e,this.y*=e,this}div(e){return 0!==e.x&&(this.x/=e.x),0!==e.y&&(this.y/=e.y),this}distTo(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}diff(e){return new t(Math.abs(this.x-e.x),Math.abs(this.y-e.y))}get magnitude(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}normalise(){const e=this.magnitude;return 0!==e?this.scale(1/e):console.error("Cannot normalise vector with magnitude 0"),this}get clone(){return new t(this.x,this.y)}get angle(){return-Math.atan2(-this.y,this.x)}get str(){return`x: ${this.x} \ny: ${this.y}`}equals(e){return e.x===this.x&&e.y===this.y}isInRect(e,t){return this.x>e.x&&this.x<e.x+t.x&&this.y>e.y&&this.y<e.y+t.y}set(e){return this.x=Number(e.x),this.y=Number(e.y),this}apply(e){this.x=Number(e(this.x)),this.y=Number(e(this.y))}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}get negative(){return this.clone.scale(-1)}toInt(){return this.apply(Math.round),this}get v3(){return new e(this.x,this.y,0)}get array(){return[this.x,this.y]}static fromAngleMagnitude(e,n){for(;e<0;)e+=360;return e%=360,new t(Math.sin(e),Math.cos(e)).normalise().scale(n)}static fromArray(e){return new t(e[0],e[1])}static get up(){return new t(0,1)}static get down(){return new t(0,-1)}static get right(){return new t(1,0)}static get left(){return new t(-1,0)}static get zero(){return new t(0,0)}static avPoint(e){let n=t.zero;for(let t of e)n.add(t);return n.scale(1/e.length)}}class n{constructor(e=0,t=e,n=e,r=1){this.red=e,this.green=t,this.blue=n,this.alpha=r,this.isColour=!0}get hex(){return`#${u(this.red)}${u(this.green)}${u(this.blue)}`}get rgb(){return`rgb(${this.red}, ${this.green}, ${this.blue})`}get rgba(){return`rgba(${this.red}, ${this.green}, ${this.blue}, ${this.alpha})`}get clone(){return new n(this.red,this.green,this.blue,this.alpha)}get json(){return{r:this.red,g:this.green,b:this.blue,a:this.alpha}}static parse(e){let t;return t=e.match(/^#([0-9a-f]{3})$/i),t&&t[1]?o(17*parseInt(t[1].charAt(0),16),17*parseInt(t[1].charAt(1),16),17*parseInt(t[1].charAt(2),16)):(t=e.match(/^#([0-9a-f]{6})$/i),t?o(parseInt(t[1].substr(0,2),16),parseInt(t[1].substr(2,2),16),parseInt(t[1].substr(4,2),16)):(t=e.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i),t?o(parseInt(t[1]),parseInt(t[2]),parseInt(t[3])):s[e]||o(0,0,0)))}}function o(e=0,t=e,r=e){return new n(e,t,r)}const s={red:o(255,0,0),green:o(0,255,0),blue:o(0,0,255),white:o(255,255,255)};function a(e,t,r,i){return new n(e,t,r,i)}function u(e){let t=Number(e).toString(16);return t.length<2&&(t="0"+t),t}o.parse=n.parse;class c{constructor(e){this.array=e.array||!1,this.type=e.type||typeof e.value||"string",this.value=e.value,this.name=e.name,this.description=e.description||"",this.default=e.default,this.assetType=e.assetType,this.array&&(this.value?Array.isArray(this.value)||(this.value=[this.value]):this.value=[])}}class l{constructor(e,t=""){this.type=e,this.subtype=t,this.public=[]}addPublic(e){if(!e.name)return void console.error("Public fields must have 'name' property");if(this.hasPublic(e.name))return void console.error("Cannot add property with existing name: "+e.name);if(void 0===e.value&&void 0===e.default)return void console.error("Public fields must have 'value' property");void 0===e.value&&(e.value=e.default);const t=new c(e);return this.public.push(t),Object.defineProperty(this,e.name,{enumerable:!0,get(){return void 0===e.overrideGet?this.getPublic(e.name):e.overrideGet()},set(t){void 0!==e.overrideSet?e.overrideSet(t):this.setPublicTypeCheck(e.name,t)}}),t}getPublic(e){for(let t of this.public)if(t.name===e)return t.value}getPublicField(e){for(let t of this.public)if(t.name===e)return t}hasPublic(e){for(let t of this.public)if(t.name===e)return!0;return!1}setPublic(e,t){for(let n of this.public)n.name===e&&(n.value=t)}setPublicTypeCheck(n,r){if(!this.hasPublic(n))return void console.log(`No public variable found  with name ${n}`);const i=typeof r,s=this.getPublicField(n);if(void 0!==s)switch(s.type){case"rgb":if("string"==typeof r){this.setPublic(n,o.parse(r));break}if(r&&(null==r?void 0:r.isColour)){this.setPublic(n,r);break}console.error(`Cannot set property '${n}' of type '${i}' to:`,r);break;case"Transform":this.setPublic(n,r);break;case"v2":if(r instanceof t){this.setPublic(n,r);break}if(Array.isArray(r)&&2===r.length){this.setPublic(n,t.fromArray(r));break}if("number"==typeof r.x&&"number"==typeof r.y){this.setPublic(n,new t(r.x,r.y));break}console.error(`Cannot set public property '${n}' of type v2 to value '${r}' of type '${i}'`);break;case"v3":if(r instanceof e){this.setPublic(n,r);break}if(Array.isArray(r)&&(3===r.length||4===r.length)){this.setPublic(n,e.fromArray(r));break}if("number"==typeof r.x&&"number"==typeof r.y&&"number"==typeof r.z){this.setPublic(n,new e(r.x,r.y,r.z,r.w));break}console.error(`Cannot set public property '${n}' of type v3 to value '${r}' of type '${i}'`);break;default:if(i!==s.type)return void console.error(`Tried to set public variable '${n}' of type '${s.type}' to '${r}' of type '${i}'`);this.setPublic(n,r)}else console.log(`No public variable found  with name ${n}`)}}var f=r(768);class h extends l{constructor({path:e,script:t}){super("Script",e.split("/").pop()||"noscript"),this.name="",this.runMethod=(e,t,n=[])=>{var r;n=[new f.ESJSBinding(t),...n];const i=null===(r=this.script)||void 0===r?void 0:r.__getProperty__({context:f.global},new f.ESString(e));i instanceof f.ESFunction?i.__call__({context:f.global},...n):console.error(`Cannot run method '${e}'`)},this.path=e,this.script=t}jsonPublic(){let n=[];for(let r of this.public){const i={};let o=r;for(const n in r)"value"===n&&(o[n]instanceof t||o[n]instanceof e)?i[n]=o[n].array:i[n]=o[n];n.push(i)}return n}json(){return{type:"Script",path:"scripts.js",name:this.name,public:this.jsonPublic()}}Update(){}}var d=r(842);class p extends l{constructor(e,n,r,i){super("Collider",e),this.offset=t.zero,this.solid=!0,this.addPublic({name:"solid",value:n,description:"If the collider should interact with other colliders or not",default:!0,type:"boolean"}),this.addPublic({name:"offset",value:r,type:"v2",description:"Offsets the renderer from the transform of the entity",default:t.zero}),this.MatterBody=i}}class v extends p{constructor({radius:e=1,solid:n=!0,offset:r=new t(0,0)}){super("CircleCollider",n,r,d.Bodies.circle(0,0,e,{})),this.radius=0,this.addPublic({name:"radius",value:e,default:1})}overlapsPoint(e,t){const n=d.Bodies.circle(e.position.x,e.position.y,this.radius*e.scale.x,{angle:e.rotation.z});return d.Query.point([n],d.Vector.create(t.x,t.y)).length>0}json(){return{type:"CircleCollider",radius:this.radius,solid:this.solid,offset:this.offset.array}}}class y extends p{constructor({width:e=1,height:n=1,solid:r=!0,offset:i=new t(0,0)}){super("RectCollider",r,i,d.Bodies.rectangle(0,0,e,n,{})),this.width=0,this.height=0,this.addPublic({name:"height",value:n}),this.addPublic({name:"width",value:e})}overlapsPoint(e,t){const n=d.Bodies.rectangle(e.position.x,e.position.y,this.width*e.scale.x,this.height*e.scale.y,{angle:e.rotation.z});return d.Query.point([n],d.Vector.create(t.x,t.y)).length>0}json(){return{type:"RectCollider",height:this.height,width:this.width,solid:this.solid,offset:this.offset.array}}}function m(e){return new Promise((t=>setTimeout(t,e)))}function _(e){return new t(e.width,e.height)}function b(e,t,n){return e.sub(n).scale(t).add(n)}function w(e){const t=document.getElementById(e);if(!(t instanceof HTMLCanvasElement))throw"Canvas element is not instance of HTMLCanvasElement";const n=t.getContext("2d");if(!n)throw"Canvas doesn't have 2d context";return{canvas:t,ctx:n}}function g(e){e.style.width="100%",e.style.height="100%",e.width=e.offsetWidth,e.height=e.offsetHeight}function x(n,r){let i={};for(const r in n){if(-1!==["type","subtype","hasSubType","public"].indexOf(r))continue;let o=n[r];o instanceof t||o instanceof e?o=o.array:o.isColour&&(o=o.json),i[r]=o}return i.type=r||n.subtype,i}function S(e,n){const r=e.map((e=>e.clone));let i=t.avPoint(r);for(let e of r){const t=e.clone.sub(i);t.mul(n);const r=i.clone.add(t);e.set(r)}return r}function T(e,t){if(t>=e.length)return e;let n="";for(let r=0;r<t;r++)n+=e[r]||"";return n.length<e.length&&(n+="..."),n}function k(e){let t=e.substring(e.lastIndexOf("/")+1);return t.substring(0,t.length-3)}function E(){return Math.ceil(1e4*Math.random())}class O extends l{constructor({velocity:t=e.zero,mass:n=1,friction:r=.1,airResistance:i=.1,bounciness:o=.2}){super("Body"),this.velocity=e.zero,this.mass=0,this.friction=0,this.airResistance=0,this.bounciness=0,this.addPublic({name:"velocity",value:t,description:"The speed and direction of the object at the first frame",type:"v3"}),this.addPublic({name:"mass",value:n,description:"The mass of the object affects collisions, forces and more."}),this.addPublic({name:"friction",value:r,description:"When colliding, this is applied to the velocity. Higher values slow it down more."}),this.addPublic({name:"airResistance",value:i,description:"Velocity is scaled by this every Update. Larger values give higher resistance and more slowing"}),this.addPublic({name:"bounciness",value:o,description:"When dynamically colliding, the velocity is reversed and multiplied by this. Higher values give a higher bounce."})}json(){return x(this,"Body")}applyForce(e){return this.velocity.add(e.clone.scale(1/this.mass)),this.velocity}}function C(e){e.transform(1,0,0,-1,0,e.canvas.height)}function P(e,t,n,r){e.translate(t.x,t.y),e.rotate(n*Math.PI/180),e.translate(-t.x,-t.y),r(),e.translate(t.x,t.y),e.rotate(-n*Math.PI/180),e.translate(-t.x,-t.y)}function A(e,t,n,r,i,o){e.beginPath(),e.moveTo(r.x+o,r.y),e.lineTo(r.x+t-o,r.y),e.quadraticCurveTo(r.x+t,r.y,r.x+t,r.y+o),e.lineTo(r.x+t,r.y+n-o),e.quadraticCurveTo(r.x+t,r.y+n,r.x+t-o,r.y+n),e.lineTo(r.x+o,r.y+n),e.quadraticCurveTo(r.x,r.y+n,r.x,r.y+n-o),e.lineTo(r.x,r.y+o),e.quadraticCurveTo(r.x,r.y,r.x+o,r.y),e.closePath(),e.fillStyle=i,e.fill(),e.closePath()}function I(e,t,n,r){e.beginPath(),e.arc(t.x,t.y,n,0,2*Math.PI),e.fillStyle=r,e.fill(),e.closePath()}function R(e,n,r,i,o,s=0){P(e,n.clone.add(new t(r/2,i/2)),s,(()=>{e.beginPath(),e.rect(n.x,n.y,r,i),e.fillStyle=o,e.fill(),e.closePath()}))}function N(e,n,r,i=!0,o=0){P(e,t.avPoint(n),o,(()=>{e.beginPath(),e.moveTo(n[0].x,n[0].y),e.strokeStyle=r;for(let t of n.slice(1,n.length))e.lineTo(t.x,t.y);i?(e.fillStyle=r,e.fill(),e.closePath()):e.stroke()}))}function B(e,n,r,i,o,s,a="center",u=0){const c=new t(e.measureText(n).width,r),l=s.clone.add(c.clone.scale(.5));P(e,l,u,(()=>{e.beginPath(),e.font=`${r}px ${i}`,e.fillStyle=o,e.textBaseline="middle",e.textAlign=a,e.translate(l.x,l.y),e.rotate(Math.PI),e.scale(-1,1),e.translate(-l.x,-l.y),e.fillText(n,s.x,s.y),e.translate(l.x,l.y),e.rotate(-Math.PI),e.scale(-1,1),e.translate(-l.x,-l.y),e.closePath()}))}function M(e,t,n,r,i=0){P(e,t.clone.add(n.clone.scale(.5)),i,(()=>{t=t.clone,e.beginPath();let i=new Image;i.src=r;const o=t.clone.add(n.clone.scale(.5));e.translate(o.x,o.y),e.rotate(Math.PI),e.scale(-1,1),e.translate(-o.x,-o.y),e.drawImage(i,t.x,t.y,n.x,n.y),e.translate(o.x,o.y),e.rotate(-Math.PI),e.scale(-1,1),e.translate(-o.x,-o.y),e.closePath()}))}class D extends l{constructor(e){super("Renderer",e)}Update(){}json(){return x(this)}}class $ extends D{constructor(e,n){super(e),this.offset=t.zero,this.addPublic({name:"offset",value:n,type:"v2",description:"offset from entity's transforms position"})}Update(){}json(){return x(this)}}class U extends ${constructor({radius:e=1,offset:n=new t(0,0),colour:r=o()}){super("CircleRenderer",n),this.radius=1,this.colour=o(),this.addPublic({name:"radius",value:e,type:"number",array:!1}),this.addPublic({name:"colour",value:r,type:"rgb",overrideSet:e=>{"string"!=typeof e?this.setPublic("colour",e):this.setPublic("colour",o.parse(e))}})}draw({zoom:e,transform:t,ctx:n,position:r,center:i}){const o=this.radius*e*t.scale.x;o<=0||I(n,b(r.clone.add(this.offset),e,i),o,this.colour.rgb)}}class L extends ${constructor({height:e=1,offset:n=new t(0,0),width:r=1,colour:i=o(0,0,0)}){super("RectRenderer",n),this.height=1,this.width=1,this.colour=o(),this.addPublic({name:"height",value:e}),this.addPublic({name:"width",value:r}),this.addPublic({name:"colour",value:i,type:"rgb",overrideSet:e=>{"string"!=typeof e?"number"!=typeof e.r?this.setPublic("colour",e):this.setPublic("colour",a(e.r,e.g,e.b,e.a)):this.setPublic("colour",o.parse(e))}})}Start(){}draw(e){const n=this.width*e.transform.scale.x*e.zoom,r=this.height*e.transform.scale.y*e.zoom;if(r<=0||n<=0)return;let i=this.offset.clone.add(e.position);i.sub(new t(n/(2*e.zoom),r/(2*e.zoom))),R(e.ctx,b(i,e.zoom,e.center),n,r,this.colour.rgb,e.transform.rotation.z)}}class j extends ${constructor({height:e=1,offset:n=new t(0,0),width:r=1,url:i=""}){super("ImageRenderer2D",n),this.height=1,this.width=1,this.url="",this.addPublic({name:"height",value:e}),this.addPublic({name:"width",value:r}),this.addPublic({name:"url",value:i,type:"string",description:"The path to the image to be rendered - always start with ../projects/{yourProjectID}/assets/"})}Start(){}draw(e){if(!this.url)return;const n=this.width*e.transform.scale.x*e.zoom,r=this.height*e.transform.scale.y*e.zoom;if(r<=0||n<=0)return;let i=this.offset.clone.add(e.position);i.sub(new t(n/(2*e.zoom),r/(2*e.zoom))),M(e.ctx,b(i,e.zoom,e.center),new t(n,r),this.url,e.transform.rotation.z)}}class G extends l{constructor(e,t){super("GUIElement",e),this.hovered=!1,this.zLayer=0,this.hovered=!1,this.addPublic({name:"zLayer",value:t,description:"Determines what appears on top of what in the GUI"})}json(){return x(this)}}class W extends G{constructor({height:e=30,width:t=60,radius:n=0,innerColour:r=o(230,230,230),outerColour:i=o(90,90,90),borderThickness:s=1,zLayer:a=1}){super("GUIBox",a),this.height=0,this.width=0,this.radius=0,this.innerColour=o(),this.outerColour=o(),this.borderThickness=0,this.addPublic({name:"height",value:e,default:30}),this.addPublic({name:"width",value:t,default:60}),this.addPublic({name:"radius",value:Math.min(n,t/2,e/2),description:"Radius of the bod - maxed at (size of smaller dimension)/2",default:0,overrideSet:e=>{const t=Math.min(e,this.width/2,this.height/2);this.setPublic("radius",t)}}),this.addPublic({name:"innerColour",value:r,description:"Colour of background of box",type:"rgb"}),this.addPublic({name:"outerColour",value:i,description:"Colour of border of box",type:"rgb"}),this.addPublic({name:"borderThickness",value:s,default:1})}Start(){}draw(e,n){if(0===this.width||0===this.height)return;this.borderThickness>0&&A(e,this.width*n.scale.x,this.height*n.scale.y,n.position.v2,this.outerColour.rgba,this.radius);const r=this.borderThickness;A(e,this.width*n.scale.x-2*r,this.height*n.scale.y-2*r,n.position.v2.add(new t(r,r)),this.innerColour.rgba,this.radius-r)}touchingPoint(e,n,r){return e.isInRect(r.position.v2,new t(this.width*r.scale.x,this.height*r.scale.y))}}class q extends G{constructor({zLayer:e=1,colour:t=o(150,150,150),radius:n=1}){super("GUIRect",e),this.colour=o(),this.radius=0,this.addPublic({name:"colour",value:t,type:"rgb"}),this.addPublic({name:"radius",value:n})}draw(e,t){const n=this.radius*t.scale.x;n<=0||I(e,t.position.v2,n,this.colour.rgba)}touchingPoint(e,t,n){return e.clone.distTo(n.position.v2)<=this.radius*n.scale.x}}class F extends G{constructor({zLayer:e=1,width:t=100,height:n=100,url:r=""}){super("GUIImage",e),this.width=0,this.height=0,this.url="",this.addPublic({name:"height",value:n}),this.addPublic({name:"width",value:t}),this.addPublic({name:"url",value:r})}draw(e,n){if(!this.url)return;const r=this.width*n.scale.x,i=this.height*n.scale.y;i<=0||r<=0||M(e,n.position.v2,new t(r,i),this.url,n.rotation.z)}touchingPoint(e,n,r){const i=this.width*r.scale.x,o=this.height*r.scale.y;return e.isInRect(r.position.v2,new t(i,o))}}class z extends G{constructor({zLayer:e=1,colour:n=o(150,150,150),points:r=[t.zero]}){super("GUIPolygon",e),this.colour=o(),this.points=[],this.addPublic({name:"colour",value:n,type:"rgb"}),this.addPublic({name:"points",value:r,type:"v2",array:!0})}draw(e,t){this.points.length<=1||N(e,S(this.points,t.scale.v2),this.colour.hex,!0,t.rotation.z)}touchingPoint(e,t,n){return function(e,t){if(e.length<=1)return!1;let n=[[e[0],e[e.length-1]],[e[0],e[1]]];for(let t=1;t<e.length-1;t++)n.push([e[t],e[t+1]]);let r=0;for(let e of n){if(e[0].y>t.y&&e[1].y>t.y)continue;if(e[0].y<t.y&&e[1].y<t.y)continue;let n=e[0].y<t.y?e[0]:e[1],i=e[0].y>t.y?e[0]:e[1];Object.is(n,i)||n.x+(t.y-n.y)*(i.x-n.x)/(i.y-n.y)<t.x||r++}return r%2==1}(this.points,e)}}class V extends G{constructor({zLayer:e=1,width:t=10,height:n=10,colour:r=o(150,150,150),radius:i=1}){super("GUIRect",e),this.width=0,this.height=0,this.colour=o(),this.radius=0,this.addPublic({name:"height",value:n}),this.addPublic({name:"width",value:t}),this.addPublic({name:"radius",value:Math.min(i,t/2,n/2),description:"Radius of the bod - maxed at (size of smaller dimension)/2",default:0,overrideSet:e=>{const t=Math.min(e,this.width/2,this.height/2);this.setPublic("radius",t)}}),this.addPublic({name:"colour",value:r,type:"rgb"})}draw(e,t){const n=this.width*t.scale.x,r=this.height*t.scale.y;r<=0||n<=0||A(e,n,r,t.position.v2,this.colour.hex,this.radius)}touchingPoint(e,n,r){const i=this.width*r.scale.x,o=this.height*r.scale.y;return e.isInRect(r.position.v2,new t(i,o))}}class K extends G{constructor({text:e="",fontSize:t=12,font:n="Arial",colour:r=o(0,0,0),alignment:i="center",fill:s=!0,zLayer:a=1}){super("GUIText",a),this.text="",this.fontSize=0,this.font="",this.colour=o(),this.alignment="",this.fill=!1,this.addPublic({name:"text",value:e,default:""}),this.addPublic({name:"fontSize",value:t,description:"In px",default:12}),this.addPublic({name:"font",value:n,default:"Arial"}),this.addPublic({name:"colour",value:r,type:"rgb"}),this.addPublic({name:"alignment",value:i,description:"Center, left or right. Default center",type:"string",default:"center"}),this.addPublic({name:"fill",value:s,description:"Should the text be filled or hollow",type:"boolean",default:!0})}draw(e,t){B(e,this.text,this.fontSize*t.scale.x,this.font,this.colour.rgba,t.position.v2)}touchingPoint(e,n,r){n.font=`${this.fontSize}px ${this.font}`;const i=n.measureText(this.text);return e.isInRect(r.position.v2,new t(i.width,this.fontSize*r.scale.x))}}class Q extends G{constructor({zLayer:e=1,initialText:t="text",fontSize:n=12,font:r="Arial",textColour:i=o(0,0,0),textAlignment:s="center",fillText:a=!0,limiter:u=(e=>e),maxLength:c=100}){super("GUITextBox",e),this.maxLength=0,this.text=new K({text:t,fontSize:n,colour:i,font:r,alignment:s,fill:a}),this.selected=!1,this.limiter=u,this.addPublic({name:"maxLength",value:c,default:100})}draw(e,t){this.text.draw(e,t)}touchingPoint(e,t,n){return this.text.touchingPoint(e,t,n)}limit(){this.text.text=this.limiter(this.text.text)}keyPress(e){const t=this.text.text;13!==e.keyCode?t.length>=this.maxLength||(this.text.text=`${t}${String.fromCharCode(e.keyCode)}`,this.limit()):this.selected=!1}backspace(){this.text.text=this.text.text.slice(0,-1),this.limit()}get innerText(){return this.text.text}set innerText(e){this.text.text=e}}class Y extends l{constructor({zoom:e=1,far:t=1e3,near:n=.1,fov:r=90}){super("Camera"),this.zoom=1,this.far=1e3,this.near=.1,this.fov=90,this.addPublic({name:"zoom",value:e,description:"2D only camera zoom - does not affect 3D rendering"}),this.addPublic({name:"far",value:t,description:"The far clipping plane. Does not affect 2D rendering."}),this.addPublic({name:"near",value:n,description:"The near clipping plane. Does not affect 2D rendering."}),this.addPublic({name:"fov",value:r,description:"Field of view - like zoom for 3D"})}json(){return x(this,"Camera")}screenSpaceToWorldSpace(e,t,n){e=e.clone;const r=_(t).scale(.5);return e.set(b(e,1/this.zoom,r)),e.add(n.v2),e.sub(r),e}worldSpaceToScreenSpace(e,t,n){const r=_(t).clone.scale(.5);return n=n.clone.sub(r.v3),b(e.clone.sub(n.v2),this.zoom,r)}}const H=()=>({license:"0000",version:"0.0.0",gameName:"Entropy Engine Game",canvasID:"myCanvas",maxFrameRate:60,timeScale:1,backgroundTint:o.parse("white"),globalGravity:new e(0,0,0),collisionIterations:5,globalVolume:1});class J{constructor(e,t){if(this.id=J.scenes.length,this.name=e,this.settings=t,!t.ctx){const{ctx:e}=w(t.canvasID);t.ctx=e}}json(){var e;return{name:this.name,settings:{license:this.settings.license,version:this.settings.version,gameName:this.settings.gameName,canvasID:this.settings.canvasID,maxFrameRate:this.settings.maxFrameRate,timeScale:this.settings.timeScale,backgroundTint:(null===(e=this.settings.backgroundTint)||void 0===e?void 0:e.json)||o.parse("white").json,backgroundImage:this.settings.backgroundImage,globalGravity:this.settings.globalGravity.array,collisionIterations:this.settings.collisionIterations,globalVolume:this.settings.globalVolume}}}get entities(){const e=[],t=[];for(const t of ue.entities)t.transform.isChild()||t.transform.parent===this.id&&e.push(t);for(;e.length>0;){for(let t of e[0].transform.children)e.push(t);t.push(e.shift())}return t}findMainCamera(){for(const e of this.entities)if(e.hasComponent("Camera"))return void(Y.main=e);console.error(`\n            No sprites with component of type 'camera' can be found.\n            Make sure that there is at least one sprite in the scene '${J.activeScene.name}' with a 'Camera' component attached\n        `)}loopThroughScripts(e){for(const t of this.entities)for(const n of t.getComponents("Script"))e(n,t)}broadcast(e,t=[]){this.loopThroughScripts(((n,r)=>{n.runMethod(e,r,t)}))}static loopThroughAllScripts(e){ue.loop((t=>{for(const n of t.getComponents("Script"))e(n,t)}))}static set active(e){J.active_=e instanceof J?e.id:e}static get active(){return J.active_}static get activeScene(){if(this.scenes.length<1)throw new Error("No scenes found");return J.sceneByID(J.active)}static set activeScene(e){J.active=e.id}static sceneByName(e){const t=J.scenes.filter((t=>t.name===e));if(!(void 0!==t&&t[0]&&t[0]instanceof J))throw console.error(`Cannot find scene name: ${e}`),Error();return t[0]}static sceneExistsWithID(e){return void 0!==J.scenes.filter((t=>t.id===e))[0]}static sceneByID(e){const t=J.scenes.filter((t=>t.id===e))[0];if(void 0===t){console.error(`Cannot find scene ID: ${e} of type ${typeof e}. Creating empty scene to compensate. Scenes: ${J.scenes}`);const t=new J("Example Scene",H());return J.scenes.push(t),t}return t}static create(t){const r=new J(t.name||"Scene",t.settings||H());if(J.scenes.push(r),J.scenes.length>0&&!t.settings){const t=J.scenes[J.scenes.length-1].json().settings;t.backgroundTint=new n(255,255,255),t.globalGravity=e.fromArray(t.globalGravity),r.settings=t}return r}static next(e){J.active++,J.active>J.scenes.length-1&&(J.active=0);for(let t of e)"number"==typeof t.transform.parent&&(t.transform.parent=J.active);J.activeScene.findMainCamera()}static previous(e){J.active--,J.active<0&&(J.active=J.scenes.length-1);for(let t of e)"number"==typeof t.transform.parent&&(t.transform.parent=J.active);J.activeScene.findMainCamera()}static get sceneCount(){return J.scenes.length}}J.scenes=[],J.active_=0;class X extends l{constructor({position:t=e.zero,scale:n=new e(1,1,1),rotation:r=e.zero,parent:i=J.active}){super("Transform"),this.position=e.zero,this.scale=new e(1),this.rotation=e.zero,this.parent=0,this.addPublic({name:"position",value:t,type:"v3",overrideGet:()=>{if("number"==typeof this.parent)return this.getPublic("position")||e.zero;const t=this.getPublic("position");return t?t.add(this.parent.position):e.zero},overrideSet:t=>{var n,r;const i=t||e.zero;null!==(n=i.x)&&void 0!==n||(i.x=0),null!==(r=i.y)&&void 0!==r||(i.y=0),this.setPublic("position",i)}}),this.addPublic({name:"rotation",value:r,type:"v3",overrideGet:()=>{if("number"==typeof this.parent)return this.getPublic("rotation")||e.zero;const t=this.getPublic("rotation");return t?t.clone.add(this.parent.rotation):e.zero},overrideSet:t=>{var n,r;const i=t||e.zero;null!==(n=i.x)&&void 0!==n||(i.x=0),null!==(r=i.y)&&void 0!==r||(i.y=0),this.setPublic("rotation",i)}}),this.addPublic({name:"scale",value:n,type:"v3",overrideGet:()=>{if("number"==typeof this.parent)return this.getPublic("scale")||new e(1);const t=this.getPublic("scale");return t?t.add(this.parent.scale):e.zero},overrideSet:t=>{var n,r;const i=t||e.zero;null!==(n=i.x)&&void 0!==n||(i.x=1),null!==(r=i.y)&&void 0!==r||(i.y=1),this.setPublic("scale",i)}}),this.addPublic({name:"parent",value:i,type:"Transform"})}setParentDirty(e){var t;if(e instanceof X||"number"==typeof e)if("number"!=typeof e){if(this.recursiveChildren.includes(e.sprite))for(const e of this.children)e.transform.parent=this.parent;this.parent=e}else this.parent=e;else null!==(t=this.parent)&&void 0!==t||(this.parent=J.active)}json(){let e={type:"",name:""};return this.parent instanceof X?(e.type="Transform",e.name=this.parent.sprite.name):(e.type="Scene",e.name=this.parent.toString()),{type:"Transform",position:this.position.array,scale:this.scale.array,rotation:this.rotation.array,parent:e}}Update(){}get localRotation(){return this.getPublic("rotation")||new e(1)}set localRotation(e){this.setPublic("rotation",e)}get localPosition(){return this.getPublic("position")||e.zero}set localPosition(e){this.setPublic("position",e)}get localScale(){return this.getPublic("scale")||e.zero}set localScale(e){this.setPublic("position",e)}detachFromParent(){this.parent=J.active}get children(){let e=[];for(let t of ue.entities)Object.is(t.transform.parent,this)&&e.push(t);return e}get recursiveChildren(){const e=this.children,t=[];for(;e.length>0;){for(let t of e[0].transform.children)e.push(t);t.push(e.shift())}return t}get childCount(){let e=0;for(let t of ue.entities)Object.is(t.transform.parent,this)&&e++;return e}makeChildOf(e){this.parent=e}makeParentOf(e){for(const t of e)t.parent=this}isRoot(){return"number"==typeof this.parent}isChild(){return this.parent instanceof X}get sprite(){return ue.entities.find((e=>Object.is(e.transform,this)))}get root(){return function e(t){return"number"==typeof t.parent?t:e(t.parent)}(this)}get scene(){const e=this.root.parent;if("number"!=typeof e)throw"root is not scene";return J.sceneByID(e)}get forwards(){return this.rotation}get right(){let e=this.forwards;return new t(e.y,-e.x)}getChild(e){return this.children.find((t=>t.name===e))}}var Z=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))};const ee={CircleCollider:v,RectCollider:y,Body:O,CircleRenderer:U,RectRenderer:L,ImageRenderer2D:j,GUIBox:W,GUIText:K,GUITextBox:Q,GUIRect:V,GUICircle:q,GUIPolygon:z,GUIImage:F,Camera:Y},te=Math.floor(200001*Math.random());function ne(n,r,i){if("type"!==n&&"subType"!==n)if("object"!=typeof(o=r[n])||"number"!=typeof o.r||"number"!=typeof o.g||"number"!=typeof o.b){var o;Array.isArray(r[n])?function(e){return"object"==typeof e&&!!Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]}(r[n])?i[n]=t.fromArray(r[n]):function(e){return"object"==typeof e&&!!Array.isArray(e)&&3===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&"number"==typeof e[2]}(r[n])?i[n]=e.fromArray(r[n]):i[n]=r[n]:i[n]=r[n]}else{const e=r[n];i[n]=a(e.r,e.g,e.b,e.a)}}function re(n){return Z(this,void 0,void 0,(function*(){let r;if("Script"===n.type)return function(n){return Z(this,void 0,void 0,(function*(){const r=n.path;let i;const o=r.split("/").pop();let s=yield fetch(`${r}?${te}`),a=yield s.text();const u=new f.Context;u.parent=f.global,u.path=r;const c=new f.ESNamespace(new f.ESString(o),{}),l=(0,f.run)(a,{env:u,measurePerformance:!1,fileName:o,currentDir:r});if(c.__value__=u.getSymbolTableAsDict(),l.error)console.log(l.error.str);else{i=c;try{const o=new h({script:i,path:r});if(Array.isArray(n.public))for(let r of n.public){if(!o.hasPublic(r.name))continue;let n=r.value;"v2"===r.type?n=t.fromArray(r.value):"v3"===r.type&&(n=e.fromArray(r.value)),o.setPublic(r.name,n)}return o}catch(e){throw`Error initialising script '${o}': ${e}`}}}))}(n);const i=ee[n.type];if(!i)throw`No component of type '${n.type}' found`;r=new i({});for(let e in n)n.hasOwnProperty(e)&&ne(e,n,r);return r}))}function ie(t){var n,r,i,o;return Z(this,void 0,void 0,(function*(){const s=null!==(n=t.name)&&void 0!==n?n:`entity ${ue.entities.length}`,a=null!==(r=t.tag)&&void 0!==r?r:"entity",u=null!==(i=t.Static)&&void 0!==i&&i,c=null!==(o=t.components)&&void 0!==o?o:[];let l=[];const f=t.transform,{parentInfo:h,transform:d}=function(t){let n=t.parent;const r=new X({});return t.position&&(r.position=e.fromArray(t.position)),t.scale&&(r.scale=e.fromArray(t.scale)),t.rotation&&(r.rotation=e.fromArray(t.rotation)),{parentInfo:n,transform:r}}(f||{});for(let e of c){const t=yield re(e);t&&l.push(t)}return{entity:new ue({name:s,components:l,transform:d,tag:a,Static:u}),parentInfo:h}}))}function oe(e,t){var n;let r;"Transform"===e.type?r=null===(n=ue.find(e.name))||void 0===n?void 0:n.transform:"Scene"===e.type&&(r=J.sceneByID(parseInt(e.name)).id),null==r&&(r=J.active),null==t||t.makeChildOf(r)}function se(e){var t;return Z(this,void 0,void 0,(function*(){let n={};if(Array.isArray(e)){for(let t of e){let e=yield ie(t);n[e.entity.name]=e.parentInfo,ue.entities.push(e.entity)}for(let e in n)n[e]&&oe(n[e],null===(t=ue.find(e))||void 0===t?void 0:t.transform)}else console.error("Cannot initialise entities from JSON ",e)}))}function ae(e){var t;for(let n of e){const e=H(),r=null!==(t=n.settings)&&void 0!==t?t:{};for(let t in r)ne(t,n.settings||{},e);J.create({name:n.name,settings:e})}}class ue{constructor(e){var t,n,r,i,o;this.getComponent=(e,t="")=>{if(!(this instanceof ue))throw`Running getComponent method in invalid context. this: ${this}`;if("transform"===e.toLowerCase())return this.transform;let n=this.components.find((n=>n.type===e&&(n.subtype===t||""===t)||n.subtype===e));if(void 0===n&&(n=this.getComponents("Script").find((n=>n.subtype===t||n.subtype===e))),void 0===n)throw`Cannot find component of type ${e} on entity ${this.name}`;return n},this.getSceneID=()=>this.sceneID,this.getClone=()=>{return e=this,n=function*(){const{entity:e,parentInfo:t}=yield ie(this.json());return oe(t,e.transform),e},new((t=void 0)||(t=Promise))((function(r,i){function o(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,s)}a((n=n.apply(e,[])).next())}));var e,t,n},this.addComponent=e=>{if("transform"===e.type)return!1;for(const t of this.components){if("GUIElement"===t.type){if("Renderer"!==e.type)continue;if(!["Renderer","Body","Camera"].includes(e.type))continue}if("GUIElement"===e.type&&["Renderer","Body","Camera","Collider"].includes(t.type))return!1;t.type===e.type&&t.subtype===e.subtype&&this.components.splice(this.components.indexOf(t),1)}return this.components.push(e),!0},this.add=this.addComponent,this.hasComponent=(e,t="")=>{if("transform"===e.toLowerCase())return!0;for(let n of this.components){if(n.type===e&&(n.subtype===t||""===t))return!0;if(n.subtype===e)return!0}return!1},this.getComponents=(e,t="")=>{let n=[];for(const r of this.components)r.type!==e||r.subtype!==t&&""!==t||n.push(r);return n},this.generateID=()=>{let e=0,t=ue.entities.map((e=>e.id));for(;t.indexOf(e)>-1;)e=Math.floor(Math.random()*Math.pow(10,5));return e},this.delete=()=>{for(let e=0;e<ue.entities.length;e++){const t=ue.entities[e];Object.is(t,this)&&delete ue.entities.splice(e,1)[0]}},this.json=()=>({name:this.name,tag:this.tag,Static:this.Static,transform:this.transform.json(),components:this.components.map((e=>e.json()))}),this.tag=null!==(t=e.tag)&&void 0!==t?t:"entity",this.name=null!==(n=e.name)&&void 0!==n?n:"new entity",this.components=null!==(r=e.components)&&void 0!==r?r:[],this.transform=null!==(i=e.transform)&&void 0!==i?i:new X({}),this.Static=null!==(o=e.Static)&&void 0!==o&&o,this.id=this.generateID()}get sceneID(){let e=this.transform;for(;"number"!=typeof e;)e=e.parent;return e}static newEntity(e){const t=new ue(e);return ue.entities.push(t),t}static add(e){ue.entities.push(e)}static find(e=""){const t=ue.entities.find((t=>t.name===e));if(t)return t}static findWithTag(e){let t=[];return ue.loop((n=>{n.tag===e&&t.push(n)})),t}static loop(e){for(const t of ue.entities)e(t)}}function ce(e){return n=this,i=function*(){const{canvas:n,ctx:r}=w(e),i=.1*n.width,o=_(n);function s(){R(r,t.zero,o.x,o.y,"#EEEEEE",0),B(r,"made with",i/2.5,"Nunito","rgb(60, 60, 60)",new t(n.width/2-i/1.6,n.height/2+i/1.5)),B(r,"Entropy Engine",i,"Nunito","rgb(0, 0, 0)",new t(n.width/2,n.height/2-i/2.5))}R(r,t.zero,o.x,o.y,"#EEEEEE",0),s(),yield m(500);const a=performance.now();for(;performance.now()-a<1e3&&r.globalAlpha>0;)r.globalAlpha-=.005,s(),yield m(1);r.globalAlpha=1},new((r=void 0)||(r=Promise))((function(e,t){function o(e){try{a(i.next(e))}catch(e){t(e)}}function s(e){try{a(i.throw(e))}catch(e){t(e)}}function a(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(o,s)}a((i=i.apply(n,[])).next())}));var n,r,i}function le(e,n){let r=e.getBoundingClientRect();const i=new t(n.pageX-r.left-scrollX,r.height-(n.pageY-r.top-scrollY)),o=new t(e.width/r.width,e.height/r.height);return i.mul(o),i}ue.entities=[],ue.new=ue.newEntity;const fe={listen:(e,t)=>{document.addEventListener(e,t)},mouseDown:!1,cursorPosition:t.zero,cursorPosWorldSpace:t.zero};for(let e=8;e<123;e++)fe[e]=!1,fe[String.fromCharCode(e)]=e;function he(e,t){fe.cursorPosition=le(t,e),fe.cursorPosWorldSpace=function(e,t){const n=le(e,t);return Y.main.getComponent("Camera").screenSpaceToWorldSpace(n,e,Y.main.transform.position)}(t,e)}fe.Space=32,fe.Enter=13,fe.Shift=16,fe.Backspace=8,fe.Ctrl=17,fe.Alt=18,fe.CmdR=93,fe.CmdL=91,fe.WindowsKey=91,fe.Left=37,fe.Right=39,fe.Up=38,fe.Down=40,document.addEventListener("keydown",(e=>{fe[e.keyCode]=!0})),document.addEventListener("keyup",(e=>{fe[e.keyCode]=!1})),document.addEventListener("keypress",(e=>{ue.loop((t=>{if(!t.hasComponent("GUIElement","GUITextBox"))return;const n=t.getComponent("GUIElement","GUITextBox");n.selected&&n.keyPress(e)}))})),document.addEventListener("keydown",(e=>{8===e.keyCode&&ue.loop((e=>{if(!e.hasComponent("GUIElement","GUITextBox"))return;const t=e.getComponent("GUIElement","GUITextBox");t.selected&&t.backspace()}))}));const de=new class{constructor(){this.systems=[]}sortByOrder(){de.systems=de.systems.sort(((e,t)=>e.order-t.order))}getByName(e){for(let t of de.systems)if(t.name===e)return t}Start(e){de.sortByOrder();for(let t of de.systems)t.Start(e)}Update(e){for(let t of de.systems)t.Update(e)}};class pe{constructor(e){this.points=e}move(e){for(const t of this.points)t.add(e)}}class ve{constructor(e){this.triangles=e}move(e){for(const t of this.triangles)t.move(e)}}class ye{constructor(e,t,n){this.points=[e,t,n]}move(e){for(const t of this.points)t.add(e)}apply(e){for(let t=0;t<3;t++)this.points[t]=e(this.points[t].clone)}get clone(){return new ye(...this.points.map((e=>e.clone)))}get triangleV2(){return new pe([this.points[0].v2,this.points[1].v2,this.points[2].v2])}get json(){let e=[];for(const t of this.points)e.push(t.array);return e}}class me{constructor(e){this.triangles=e}move(e){for(const t of this.triangles)t.move(e)}get json(){let e=[];for(const t of this.triangles)e.push(t.json);return e}get clone(){return new me(this.triangles.map((e=>e.clone)))}static fromArray(t){let n=new me([]);for(let r of t){const t=[];for(let n of r)t.push(e.fromArray(n));n.triangles.push(new ye(...t))}return n}static get cube(){return new me([new ye(new e(0,0,0),new e(0,1,0),new e(1,1,0)),new ye(new e(0,0,0),new e(1,1,0),new e(1,0,0)),new ye(new e(1,0,0),new e(1,1,0),new e(1,1,1)),new ye(new e(1,0,0),new e(1,1,1),new e(1,0,1)),new ye(new e(1,0,1),new e(1,1,1),new e(0,1,1)),new ye(new e(1,0,1),new e(0,1,1),new e(0,0,1)),new ye(new e(0,0,1),new e(0,1,1),new e(0,1,0)),new ye(new e(0,0,1),new e(0,1,0),new e(0,0,0)),new ye(new e(0,1,0),new e(0,1,1),new e(1,1,1)),new ye(new e(0,1,0),new e(1,1,1),new e(1,1,0)),new ye(new e(1,0,1),new e(0,0,1),new e(0,0,0)),new ye(new e(1,0,1),new e(0,0,0),new e(1,0,0))])}}let _e=!1;function be(){return e=this,n=function*(){_e||(_e=!0,yield f.init(console.log,(()=>{}),!1,{print:console.log,ee:{CircleCollider:v,RectCollider:y,Script:h,TriangleV2:pe,TriangleV3:ye,MeshV2:ve,MeshV3:me,Body:O,CircleRenderer:U,ImageRenderer2D:j,RectRenderer:L,GUIBox:W,GUIText:K,GUITextBox:Q,GUIRect:V,GUICircle:q,GUIPolygon:z,GUIImage:F,Camera:Y,Transform:X}},f.global))},new((t=void 0)||(t=Promise))((function(r,i){function o(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,s)}a((n=n.apply(e,[])).next())}));var e,t,n}function we(e,n,r,i){function s(t){let i=r||o.parse("white");i=i.clone,i.alpha=t,e.beginPath(),e.rect(0,0,n.x,n.y),e.fillStyle=i.rgba,e.fill(),e.closePath()}if(i)try{M(e,t.zero,n,i,0)}catch(e){s(.1)}else s(1)}function ge(e,t,n,r,i,o=Y.main){const s=_(t),a=s.clone.scale(.5);if(we(n,s,r,i),!e)return;if(!o)return void console.error("Camera was not passed to renderAll function! Main camera: "+Y.main.name);const u=o.getComponent("Camera");if(!u)return;const c=o.transform.position.clone.sub(s.clone.scale(.5).v3);if(c){e=e.filter((e=>e.hasComponent("Renderer")||e.hasComponent("GUIElement")));for(let t of function(e){const t=e.sort(((e,t)=>e.transform.position.z-t.transform.position.z));let n=[],r=[];for(let e of t)e.hasComponent("GUIElement")?r.push(e):n.push(e);return[...n,...r]}(e)){if(t.hasComponent("GUIElement")){t.getComponent("GUIElement").draw(n,t.transform);continue}const e=t.transform.position.clone.sub(c);t.getComponent("Renderer").draw({position:e,transform:t.transform,ctx:n,zoom:u.zoom,center:a,camera:u,cameraSprite:o})}}}function xe(e,n,r,i,o,s){const a=r.getComponent("Camera"),u=r.getComponent("Camera").zoom;e.beginPath(),e.strokeStyle=i;let c=a.worldSpaceToScreenSpace(s.position.clone.v2.add(o.offset),n,r.transform.position);if(o instanceof y){const n=new t(o.width,o.height),r=s.scale.v2.mul(n);r.scale(u);const i=c.clone;c=c.clone.sub(r.clone.scale(.5)),P(e,i,s.rotation.z,(()=>{e.rect(c.x,c.y,r.x,r.y),e.stroke()}))}else o instanceof v&&(e.arc(c.x,c.y,o.radius*s.scale.x*u,0,2*Math.PI),e.stroke())}function Se(e,n,r,i){const o=r.getComponent("Camera");for(const s of i){if(!s.hasComponent("Camera"))continue;let i=o.worldSpaceToScreenSpace(s.transform.position.v2,n,r.transform.position);i.sub(new t(2)),M(e,i,new t(80,40),"https://entropyengine.dev/svg/camera.png",0)}}function Te(e,n,r,i,o){const s=_(n),a=r.getComponent("Camera"),u=i.getComponent("Camera"),c=u.screenSpaceToWorldSpace(new t(0,0),n,i.transform.position),l=u.screenSpaceToWorldSpace(s,n,i.transform.position),f=a.worldSpaceToScreenSpace(c,n,r.transform.position),h=a.worldSpaceToScreenSpace(l,n,r.transform.position),d=Math.abs(f.y-h.y),p=Math.abs(f.x-h.x);R(e,f,1,d,o,0),R(e,new t(h.x,f.y),1,d,o,0),R(e,f,p,1,o,0),R(e,new t(f.x,h.y),p,1,o,0)}function ke(e,n,r,i){!function(e,n,r,i){const{step:o,min:s,max:a}=function(e,n,r){const i=r.getComponent("Camera"),o=i.zoom,s=_(n);let a=Math.floor(Math.log(o)/Math.LN10+1e-9),u=1/Math.pow(10,a)*50;const c=i.screenSpaceToWorldSpace(new t(0,0),n,r.transform.position),l=i.screenSpaceToWorldSpace(s,n,r.transform.position);(l.x-c.x)/u<5&&(u/=2);const f=e=>Math.ceil(e/u)*u;return c.apply(f),l.apply(f),{step:u,min:c,max:l,zoom:o}}(0,n,r),u=_(n),c=r.getComponent("Camera");for(let l=s.y;l<a.y;l+=o){const o=c.worldSpaceToScreenSpace(new t(0,l),n,r.transform.position);o.x=-1,R(e,o,u.x+2,1,i,0)}for(let l=s.x;l<a.x;l+=o){const o=c.worldSpaceToScreenSpace(new t(l,0),n,r.transform.position);o.y=-1,R(e,o,1,u.y+2,i,0)}}(n,e,r,"rgba(150, 150, 150, 0.3)"),function(e,n,r,i,o){I(e,r.getComponent("Camera").worldSpaceToScreenSpace(t.zero,n,r.transform.position),2,"rgba(150, 150, 150, 0.6)")}(n,e,r),function(e,t,n,r,i){for(const r of i)r.hasComponent("Collider")&&xe(e,t,n,"rgba(255, 230, 0, 0.6)",r.getComponent("Collider"),r.transform)}(n,e,r,0,i),Se(n,e,r,i)}function Ee(e,t,n,r){r.hasComponent("Collider")&&xe(t,e,n,"rgba(21,229,21,0.76)",r.getComponent("Collider"),r.transform)}de.systems.push({name:"Physics",order:0,engine:d.Engine.create(),runner:d.Runner.create(),Start:function(e){for(let t of e.entities){if(!t.hasComponent("Body"))continue;if(!t.hasComponent("Collider"))continue;let e=t.getComponent("Collider"),n=t.getComponent("Body");this.updateMBodyOptions(e,t,n,!0),d.World.addBody(this.engine.world,e.MatterBody)}},updateMBodyOptions:(e,t,n,r=!1)=>{const i=e.MatterBody,o=t.transform;i.position=d.Vector.create(o.position.x,o.position.y),i.angle=o.rotation.z,i.isStatic=t.Static,i.isSensor=!e.solid,i.friction=n.friction,i.velocity=d.Vector.create(n.velocity.x,n.velocity.y),i.frictionAir=n.airResistance,i.mass=n.mass,i.restitution=Math.max(Math.min(n.bounciness,1),0);let s=[];if(e instanceof y){const t=e.width*o.scale.x,n=e.height*o.scale.y;s=d.Bodies.rectangle(o.position.x,o.position.y,t,n).vertices}else{if(!(e instanceof v))throw Error("Unkown Collider type");{const t=e.radius*o.scale.x;s=d.Bodies.circle(o.position.x,o.position.y,t).vertices}}for(let e of s);i.vertices=s,i.bounds=d.Bounds.create(i.vertices),t.Static&&(i.velocity=d.Vector.create(0,0),i.force=d.Vector.create(0,0))},callCollides:function(e,t){for(let t of e.components)t.type},updateScripts:function(e){const t=[];for(let[n]of e)t.push(n);for(let[n,r]of e){const i=[...t];let o=i.indexOf(n);if(-1===o)throw Error();i.splice(o,1);let s=d.Query.collides(n,i);if(s.length>0)for(let t of s){let i=t.bodyB;Object.is(i,n)&&(i=t.bodyA);const o=e.find((([e])=>Object.is(e,i)));if(void 0===o)throw Error();this.callCollides(r,o[1])}}},Update:function(t){const n=[];this.time||(this.time=performance.now());for(let e of t.entities){if(!e.hasComponent("Collider"))continue;let t=e.getComponent("Collider");if(e.hasComponent("Body")){let n=e.getComponent("Body");this.updateMBodyOptions(t,e,n)}n.push([t.MatterBody,e])}this.engine.gravity.x=t.settings.globalGravity.x,this.engine.gravity.y=t.settings.globalGravity.y,d.Runner.tick(this.runner,this.engine,performance.now());for(let n of t.entities){if(!n.hasComponent("Body")||!n.hasComponent("Collider"))continue;let t=n.getComponent("Collider").MatterBody,r=n.getComponent("Body");n?(n.transform.rotation.z=t.angle,n.transform.position.set(new e(t.position.x,t.position.y,0)),r.velocity.set(new e(t.velocity.x,t.velocity.y,0))):console.error("EEInstance not attached to Matter.Body instance")}this.updateScripts(n)}}),de.systems.push({name:"Renderer",Start:()=>{},Update:e=>{const t=e.settings.ctx;t&&ge(e.entities,t.canvas,t,e.settings.backgroundTint,e.settings.backgroundImage)},order:10}),de.systems.push({name:"Scripts",Start:e=>{e.broadcast("Start",[])},Update:e=>{e.broadcast("Update",[])},order:0});var Oe=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))};function Ce({canvasID:e="canvas",performanceDebug:t=0}){var n;let r=!1;const i="EE-"!==(o="").substr(0,3)||12!==o.length?0:1;var o;const{canvas:s,ctx:a}=w(e);function u(){return Oe(this,void 0,void 0,(function*(){de.Update(J.activeScene),window.requestAnimationFrame(u)}))}return g(s),null===(n=null==s?void 0:s.parentNode)||void 0===n||n.addEventListener("resize",(()=>{g(s)})),a.transform(1,0,0,-1,0,s.height),a.save(),s.addEventListener("mousemove",(e=>{r&&(he(e,s),ue.loop((e=>{if(e.sceneID===J.active)for(const t of e.components){if("GUIElement"!==t.type)return;const n=t;n.hovered=n.touchingPoint(fe.cursorPosition,a,e.transform)}})))}),!1),s.addEventListener("mousedown",(e=>{r&&(fe.mouseDown=!0,he(e,s),J.activeScene.loopThroughScripts(((t,n)=>{if(n.sceneID!==J.active)return;if(!n.hasComponent("Collider"))return;let r=n.getComponent("Collider");const i=le(s,e);r.overlapsPoint(n.transform,i)})))}),!1),s.addEventListener("keydown",(e=>{he(e,s)})),s.addEventListener("keyup",(e=>{he(e,s)})),s.addEventListener("mouseup",(e=>{r&&(fe.mouseDown=!1,he(e,s),J.activeScene.loopThroughScripts(((t,n)=>{if(n.sceneID===J.active)if(n.hasComponent("Collider")){let r=n.getComponent("Collider");const i=le(s,e);if(!r.overlapsPoint(n.transform,i))return;t.runMethod("onMouseUp",n,[])}else if(n.hasComponent("GUIElement")){const e=n.getComponent("GUIElement");if(e.hovered&&t.runMethod("onClick",n,[]),"GUITextBox"!==e.subtype)return;let r=e;r.selected=r.hovered}})))}),!1),{run:function(){return Oe(this,void 0,void 0,(function*(){yield function(){return Oe(this,void 0,void 0,(function*(){i<2&&(yield ce(e)),yield be(),J.activeScene.findMainCamera(),de.Start(J.activeScene),r=!0}))}(),window.requestAnimationFrame(u)}))}}}const Pe=new Headers;Pe.append("pragma","no-cache"),Pe.append("cache-control","no-cache");const Ae={method:"GET",headers:Pe};function Ie(e,t={}){return Oe(this,void 0,void 0,(function*(){yield be();const n=yield fetch(e,Ae),r=yield n.json();for(let e in r)["entities","scenes"].includes(e)||(t[e]=r[e]);t.shouldInitEES=!1,ae(r.scenes);const i=Ce(t);return yield se(r.entities),yield i.run(),i}))}})(),e.exports=i})()},216:(e,t,n)=>{"use strict";var r=n(745);n.o(r,"Body")&&n.d(t,{Body:function(){return r.Body}}),n.o(r,"Camera")&&n.d(t,{Camera:function(){return r.Camera}}),n.o(r,"CircleCollider")&&n.d(t,{CircleCollider:function(){return r.CircleCollider}}),n.o(r,"CircleRenderer")&&n.d(t,{CircleRenderer:function(){return r.CircleRenderer}}),n.o(r,"Entity")&&n.d(t,{Entity:function(){return r.Entity}}),n.o(r,"EntropyEngine")&&n.d(t,{EntropyEngine:function(){return r.EntropyEngine}}),n.o(r,"GUIBox")&&n.d(t,{GUIBox:function(){return r.GUIBox}}),n.o(r,"GUICircle")&&n.d(t,{GUICircle:function(){return r.GUICircle}}),n.o(r,"GUIImage")&&n.d(t,{GUIImage:function(){return r.GUIImage}}),n.o(r,"GUIPolygon")&&n.d(t,{GUIPolygon:function(){return r.GUIPolygon}}),n.o(r,"GUIRect")&&n.d(t,{GUIRect:function(){return r.GUIRect}}),n.o(r,"GUIText")&&n.d(t,{GUIText:function(){return r.GUIText}}),n.o(r,"GUITextBox")&&n.d(t,{GUITextBox:function(){return r.GUITextBox}}),n.o(r,"ImageRenderer2D")&&n.d(t,{ImageRenderer2D:function(){return r.ImageRenderer2D}}),n.o(r,"RectCollider")&&n.d(t,{RectCollider:function(){return r.RectCollider}}),n.o(r,"RectRenderer")&&n.d(t,{RectRenderer:function(){return r.RectRenderer}}),n.o(r,"Scene")&&n.d(t,{Scene:function(){return r.Scene}}),n.o(r,"Script")&&n.d(t,{Script:function(){return r.Script}}),n.o(r,"Systems")&&n.d(t,{Systems:function(){return r.Systems}}),n.o(r,"Transform")&&n.d(t,{Transform:function(){return r.Transform}}),n.o(r,"cullString")&&n.d(t,{cullString:function(){return r.cullString}}),n.o(r,"drawCameraViewArea")&&n.d(t,{drawCameraViewArea:function(){return r.drawCameraViewArea}}),n.o(r,"entitiesFromJSON")&&n.d(t,{entitiesFromJSON:function(){return r.entitiesFromJSON}}),n.o(r,"getMousePos")&&n.d(t,{getMousePos:function(){return r.getMousePos}}),n.o(r,"initialiseEntropyScript")&&n.d(t,{initialiseEntropyScript:function(){return r.initialiseEntropyScript}}),n.o(r,"initialiseScenes")&&n.d(t,{initialiseScenes:function(){return r.initialiseScenes}}),n.o(r,"rect")&&n.d(t,{rect:function(){return r.rect}}),n.o(r,"renderDebug")&&n.d(t,{renderDebug:function(){return r.renderDebug}}),n.o(r,"renderSelectedOutline")&&n.d(t,{renderSelectedOutline:function(){return r.renderSelectedOutline}}),n.o(r,"v2")&&n.d(t,{v2:function(){return r.v2}}),n.o(r,"v3")&&n.d(t,{v3:function(){return r.v3}})},768:function(e){e.exports=(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Context:()=>Z,ESArray:()=>U,ESBoolean:()=>$,ESError:()=>Re,ESErrorPrimitive:()=>O,ESFunction:()=>M,ESJSBinding:()=>B,ESNamespace:()=>N,ESNumber:()=>D,ESObject:()=>R,ESPrimitive:()=>E,ESString:()=>L,ESSymbol:()=>j,ESType:()=>A,ESUndefined:()=>I,ExpectedCharError:()=>Me,IS_NODE_INSTANCE:()=>f,IllegalCharError:()=>Ne,ImportError:()=>$e,IndexError:()=>Le,InvalidOperationError:()=>je,InvalidRuntimeError:()=>Ge,InvalidSyntaxError:()=>Be,KEYWORDS:()=>p,N_array:()=>ce,N_binOp:()=>re,N_break:()=>Te,N_class:()=>_e,N_continue:()=>ke,N_emptyObject:()=>fe,N_for:()=>ue,N_functionCall:()=>de,N_functionDefinition:()=>pe,N_if:()=>se,N_indexed:()=>me,N_namespace:()=>be,N_number:()=>we,N_objectLiteral:()=>le,N_primWrapper:()=>Ee,N_return:()=>ve,N_statements:()=>he,N_string:()=>ge,N_unaryOp:()=>ie,N_undefined:()=>Se,N_varAssign:()=>oe,N_variable:()=>xe,N_while:()=>ae,N_yield:()=>ye,Node:()=>ne,ReferenceError:()=>Ue,TestFailed:()=>We,TypeError:()=>De,colours:()=>z,deepClone:()=>Oe,digits:()=>r,doubleCharTokens:()=>x,global:()=>u,identifierChars:()=>i,importCache:()=>m,indent:()=>Ae,init:()=>Ke,interpretResult:()=>te,libs:()=>d,multiLineCommentEnd:()=>a,multiLineCommentStart:()=>s,now:()=>v,primitiveMethods:()=>T,refreshPerformanceNow:()=>y,run:()=>Qe,runningInNode:()=>h,setGlobalContext:()=>c,singleCharTokens:()=>g,singleLineComment:()=>o,sleep:()=>Pe,str:()=>Ce,stringSurrounds:()=>l,strip:()=>W,tokenType:()=>_,tokenTypeString:()=>w,tripleCharTokens:()=>S,tt:()=>b,types:()=>k,validURI:()=>Ie,wrap:()=>G});class n{constructor(e,t,n,r="(unknown)"){this.idx=e,this.ln=t,this.col=n,this.file=r}advance(e=""){return this.idx++,this.col++,"\n"===e&&(this.ln++,this.col=0),this}get clone(){return new n(this.idx,this.ln,this.col,this.file)}get str(){return`File ${this.file}, ${this.ln+1}:${this.col+1}`}get isUnknown(){return-2===this.idx}static get unknown(){return new n(-2,-2,-2,"(unknown)")}}const r="0123456789",i="_$abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",o="//",s="/*",a="*/";let u;const c=e=>{u=e},l=["'","`",'"'];let f="undefined"==typeof window;const h=()=>{f=!0},d={print:console.log},p=["var","let","global","local","mutable","const","if","else","while","for","in","continue","break","func","return","yield","class","extends","namespace","export"];let v=()=>0;function y(e){return t=this,void 0,r=function*(){v=e?()=>Date.now():()=>{try{return null===performance||void 0===performance?void 0:performance.now()}catch(e){return 0}}},new((n=void 0)||(n=Promise))((function(e,i){function o(e){try{a(r.next(e))}catch(e){i(e)}}function s(e){try{a(r.throw(e))}catch(e){i(e)}}function a(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(e){e(r)}))).then(o,s)}a((r=r.apply(t,[])).next())}));var t,n,r}y(f);const m={};var _;!function(e){e[e.NUMBER=0]="NUMBER",e[e.STRING=1]="STRING",e[e.ENDSTATEMENT=2]="ENDSTATEMENT",e[e.IDENTIFIER=3]="IDENTIFIER",e[e.KEYWORD=4]="KEYWORD",e[e.COMMA=5]="COMMA",e[e.ASSIGN=6]="ASSIGN",e[e.ADD=7]="ADD",e[e.SUB=8]="SUB",e[e.MUL=9]="MUL",e[e.DIV=10]="DIV",e[e.POW=11]="POW",e[e.OPAREN=12]="OPAREN",e[e.CPAREN=13]="CPAREN",e[e.OBRACES=14]="OBRACES",e[e.CBRACES=15]="CBRACES",e[e.OSQUARE=16]="OSQUARE",e[e.CSQUARE=17]="CSQUARE",e[e.EQUALS=18]="EQUALS",e[e.NOTEQUALS=19]="NOTEQUALS",e[e.NOT=20]="NOT",e[e.GT=21]="GT",e[e.LT=22]="LT",e[e.GTE=23]="GTE",e[e.LTE=24]="LTE",e[e.AND=25]="AND",e[e.OR=26]="OR",e[e.COLON=27]="COLON",e[e.DOT=28]="DOT",e[e.EOF=29]="EOF",e[e.BITWISE_OR=30]="BITWISE_OR",e[e.BITWISE_AND=31]="BITWISE_AND",e[e.BITWISE_NOT=32]="BITWISE_NOT"}(_||(_={}));let b=_;const w={[b.NUMBER]:"Number",[b.STRING]:"String",[b.ENDSTATEMENT]:";",[b.IDENTIFIER]:"Identifier",[b.KEYWORD]:"Keyword",[b.COMMA]:",",[b.OBRACES]:"{",[b.CBRACES]:"}",[b.OPAREN]:"(",[b.CPAREN]:")",[b.OSQUARE]:"[",[b.CSQUARE]:"]",[b.ASSIGN]:"=",[b.ADD]:"+",[b.SUB]:"-",[b.MUL]:"*",[b.DIV]:"/",[b.POW]:"^",[b.EQUALS]:"==",[b.NOTEQUALS]:"!=",[b.NOT]:"!",[b.GT]:">",[b.LT]:"<",[b.GTE]:">=",[b.LTE]:"<=",[b.AND]:"&&",[b.OR]:"||",[b.COLON]:":",[b.DOT]:".",[b.EOF]:"End of File",[b.BITWISE_AND]:"&",[b.BITWISE_OR]:"|",[b.BITWISE_NOT]:"~"},g={"*":b.MUL,"/":b.DIV,"+":b.ADD,"-":b.SUB,"(":b.OPAREN,")":b.CPAREN,"^":b.POW,"{":b.OBRACES,"}":b.CBRACES,",":b.COMMA,"[":b.OSQUARE,"]":b.CSQUARE,";":b.ENDSTATEMENT,":":b.COLON,".":b.DOT,"=":b.ASSIGN,">":b.GT,"<":b.LT,"!":b.NOT,"|":b.BITWISE_OR,"&":b.BITWISE_AND,"~":b.BITWISE_NOT},x={"==":b.EQUALS,"!=":b.NOTEQUALS,">=":b.GTE,"<=":b.LTE,"+=":b.ASSIGN,"-=":b.ASSIGN,"*=":b.ASSIGN,"/=":b.ASSIGN,"&&":b.AND,"||":b.OR},S={},T=["__add__","__subtract__","__multiply__","__divide__","__pow__","__eq__","__gt__","__lt__","__and__","__or__","__bool__","__setProperty__","__getProperty__","__call__"],k={};class E{constructor(e,t=k.any){this.self=this,this.isa=(e,t)=>new $(t===this.__type__),this.is=(e,t)=>new $(t===this),this.valueOf=()=>this.__value__,this.typeName=()=>this.__type__.__name__,this.hasProperty=(e,t)=>new $(this.hasOwnProperty(Ce(t))),this.describe=(e,t)=>{this.info.isBuiltIn||(this.info.description=Ce(t))},this.detail=(e,t)=>{if(this.info.isBuiltIn)return;const r=W(t,e);if("object"!=typeof r)return new De(n.unknown,"object",this.typeName(),Ce(this));this.info=Object.assign(Object.assign({},this.info),r),this.info.isBuiltIn=!1},this.__type__=t||this,this.__value__=e,this.info={}}__add__(e,t){return new je("",this)}__subtract__(e,t){return new je("",this)}__multiply__(e,t){return new je("",this)}__divide__(e,t){return new je("",this)}__pow__(e,t){return new je("__pow__",this)}__eq__(e,t){return new je("__eq__",this)}__gt__(e,t){return new je("__gt__",this)}__lt__(e,t){return new je("__lt__",this)}__and__(e,t){return new je("__and__",this)}__or__(e,t){return new je("__or__",this)}__bool__(e){return new je("__bool__",this)}__setProperty__(e,t,n){return new je("__setProperty__",this,`[${Ce(t)}] = ${Ce(n)}`)}__call__(e,...t){return new je("__call__",this)}}class O extends E{constructor(e=new Re(n.unknown,"Unknown","Error not specified")){super(e,k.error),this.__getProperty__=(e,t)=>{if(this.self.hasOwnProperty(Ce(t))){const e=this.self[Ce(t)];return"function"==typeof e?new M(e):G(e)}return new Le(n.unknown,t.valueOf(),this)},this.cast=({})=>new Re(n.unknown,"TypeError","Cannot cast type 'error'"),this.str=()=>new L(`<Error: ${this.valueOf().str}>`),this.__eq__=(e,t)=>new $(t instanceof O&&this.valueOf().constructor===t.valueOf().constructor),this.__bool__=()=>new $(!0),this.bool=this.__bool__,this.clone=()=>new O(this.valueOf())}}function C(e,t,r,i,o){if(!(t instanceof A))return new De(n.unknown,"Type",typeof t,t);const s=new M((({context:e},...n)=>{const s=new Z;if(s.parent=e,t.__extends__){let e=C(s,t.__extends__,r,i,o);if(e instanceof Re)return e}const a=null==t?void 0:t.__init__;if(!a)return;a.this_=i,a.__closure__=s;const u=a.__call__({context:s},...n);return u instanceof Re?u:void 0}),void 0,"super",i);let a=e.setOwn("super",s);if(a instanceof Re)return a;const u=P(t,{context:e},[],!1,r);return u instanceof Re?u:void 0}function P(e,{context:t},n,r=!0,i={}){var o;if(e.__isPrimitive__){if(n.length<1)return new I;switch(e.__name__){case"Undefined":case"Type":return n.length<1?new A:new L(n[0].__type__.__name__);case"String":return new L(n[0].str().valueOf());case"Array":return new U(n);case"Number":return new D(n[0].valueOf());case"Function":return new M(n[0].valueOf());case"Boolean":return new $(n[0].bool().valueOf());default:return G(n[0])}}const s=new Z;s.parent=null===(o=e.__init__)||void 0===o?void 0:o.__closure__;const a=new R;if(e.__extends__){let n=C(s,e.__extends__,i,a,t);if(n instanceof Re)return n}a.__value__=i;for(let t of e.__methods__){const e=t.clone();e.this_=a,i[t.name]=e,-1!==T.indexOf(t.name)&&(a[t.name]=e.__call__)}if(r&&e.__init__){e.__init__.this_=a,e.__init__.__closure__=s;const t=e.__init__.__call__({context:s},...n);if(t instanceof Re)return t}return a.__type__=e,e.__instances__.push(a),a}class A extends E{constructor(e=!1,t="(anon)",r=[],i,o){super(void 0,null==k?void 0:k.type),this.__instances__=[],this.clone=()=>new A(this.__isPrimitive__,this.__name__,this.__methods__,this.__extends__,this.__init__),this.isa=({},e)=>new $(e===k.type),this.cast=({},e)=>new je("cast",this),this.includesType=(e,t)=>{var n,r,i,o,s,a;return this.equals(e,k.any).bool().valueOf()||t.equals(e,k.any).bool().valueOf()||!0===(null===(n=this.__extends__)||void 0===n?void 0:n.equals(e,t).valueOf())||!0===(null===(r=this.__extends__)||void 0===r?void 0:r.equals(e,k.any).valueOf())||!0===(null===(i=this.__extends__)||void 0===i?void 0:i.includesType(e,t).valueOf())||!0===(null===(o=t.__extends__)||void 0===o?void 0:o.equals(e,this).valueOf())||!0===(null===(s=t.__extends__)||void 0===s?void 0:s.equals(e,k.any).valueOf())||!0===(null===(a=t.__extends__)||void 0===a?void 0:a.includesType(e,this).valueOf())?new $(!0):this.equals(e,t)},this.equals=({},e)=>new $(e.__name__===this.__name__&&e.__isPrimitive__===this.__isPrimitive__&&Object.is(this.valueOf(),e.valueOf())),this.__call__=({context:e},...t)=>P(this,{context:e},t||[]),this.str=()=>new L(`<Type: ${this.__name__}>`),this.__bool__=()=>new $(!0),this.bool=this.__bool__,this.__getProperty__=({},e)=>{if(this.self.hasOwnProperty(Ce(e))){const t=this.self[Ce(e)];return"function"==typeof t?new M(t):G(t)}return new Le(n.unknown,e.valueOf(),this)},this.__isPrimitive__=e,this.__name__=t,this.info.name=t,this.__extends__=i,this.__methods__=r,o&&(o.name=t,this.__init__=o),k.type||(this.__type__=this)}}class I extends E{constructor(){super(void 0,k.undefined),this.cast=({context:e},t)=>{switch(t){case k.number:return new D;case k.string:return new L;case k.array:return new U;case k.undefined:return new I;case k.type:return new A;case k.error:return new O;case k.object:case k.any:return new R;case k.function:return new M((()=>{}));case k.boolean:return new $;default:return t instanceof A?t.__call__({context:e}):new Re(n.unknown,"TypeError",`Cannot cast to type '${Ce(t.typeName())}'`)}},this.str=()=>new L("<Undefined>"),this.__eq__=({},e)=>new $(e instanceof I||void 0===e||void 0===e.valueOf()),this.__bool__=()=>new $,this.bool=this.__bool__,this.clone=()=>new I,this.__getProperty__=({},e)=>{if(this.self.hasOwnProperty(Ce(e))){const t=this.self[Ce(e)];return"function"==typeof t?new M(t):G(t)}return new Le(n.unknown,e.valueOf(),this)},this.info={name:"undefined",description:"Not defined, not a value.",file:"built-in",isBuiltIn:!0}}}class R extends E{constructor(e={}){super(e,k.object),this.isa=(e,t)=>t===k.object?new $(!0):t instanceof A?this.__type__.includesType(e,t):new De(n.unknown,"TypeError","type",Ce(t.typeName()),Ce(t)),this.cast=({},e)=>e===k.number?new D(this.valueOf()?1:0):new Re(n.unknown,"TypeError",`Cannot cast boolean to type '${Ce(e.typeName())}'`),this.str=()=>{let e=Ce(this.valueOf());return"\n"===e[e.length-1]&&(e=e.substr(0,e.length-1)),new L(`<ESObject ${e}>`)},this.__eq__=({context:e},t)=>{if(!(t instanceof R))return new $;if(t.keys.length!==this.keys.length)return new $;for(let n of this.keys){const r=n.valueOf(),i=this.valueOf()[r],o=t.valueOf()[r];if(!i){if(o)return new $;continue}if(!i.__eq__)return new $;const s=i.__eq__({context:e},o);if(s instanceof Re)return s;if(!s.valueOf())return new $}return new $(!0)},this.__bool__=()=>new $(!0),this.bool=this.__bool__,this.__add__=({context:e},t)=>{if(!(t instanceof R))return new De(n.unknown,"object",t.typeName().valueOf(),t);let r={};for(let t of this.keys){const n=t.valueOf(),i=this.__getProperty__({context:e},t);if(i instanceof Re)return i;r[n]=i}for(let n of t.keys){const i=n.valueOf();if(r.hasOwnProperty(i))continue;const o=t.__getProperty__({context:e},n);if(o instanceof Re)return o;r[i]=o}return new R(r)},this.__subtract__=(e,t)=>{let r=[];if(t instanceof L)r=[Ce(t)];else{if(!(t instanceof U))return new De(n.unknown,"array | string",t.typeName().valueOf(),t);r=W(t,e)}if(!Array.isArray(r))return new De(n.unknown,"array | string",t.typeName().valueOf(),t);let i={};for(let t of this.keys){const n=t.valueOf();if(-1===r.indexOf(n)){let r=this.__getProperty__(e,t);if(r instanceof Re)return r;i[n]=r}}return new R(i)},this.__getProperty__=({},e)=>{if(!(e instanceof L))return new De(n.unknown,"string",e.typeName(),Ce(e));const t=e.valueOf();if(this.valueOf().hasOwnProperty(t))return this.valueOf()[t];if(this.self.hasOwnProperty(t)){const e=this.self[t];return"function"==typeof e?new M(e):G(e)}return new I},this.__setProperty__=({},e,t)=>{if(!(e instanceof L))return new De(n.unknown,"string",e.typeName(),Ce(e));this.__value__[e.valueOf()]=t},this.hasProperty=(e,t)=>{const n=Ce(t);return this.valueOf().hasOwnProperty(Ce(n))?new $(!0):new $(this.hasOwnProperty(n))},this.clone=()=>{const e=new R;let t={},n=this.valueOf();for(let e of Object.keys(n))t[e]=n[e];return e.__value__=t,e}}get keys(){return Object.keys(this.valueOf()).map((e=>new L(e)))}set keys(e){}}class N extends E{constructor(e,t,r=!1){super(t,k.object),this.cast=({})=>new Re(n.unknown,"TypeError","Cannot cast type 'namespace'"),this.clone=()=>{let e={},t=this.valueOf();for(let n of Object.keys(t))e[n]=t[n];return new N(this.name,e)},this.str=()=>{const e=Object.keys(this.valueOf());return new L(`<Namespace ${Ce(this.name)}${e.length>0?": ":""}${e.slice(0,5)}${e.length>=5?"...":""}>`)},this.__eq__=({},e)=>new $(this===e),this.__bool__=()=>new $(!0),this.bool=this.__bool__,this.__getProperty__=({},e)=>{if(e instanceof L&&this.valueOf().hasOwnProperty(e.valueOf())){const t=this.valueOf()[e.valueOf()];if(t.isAccessible)return t.value}if(!(e instanceof L))return new De(n.unknown,"string",e.typeName());if(this.self.hasOwnProperty(Ce(e))){const t=this.self[Ce(e)];return"function"==typeof t?new M(t):G(t)}return new Le(n.unknown,e.valueOf(),this.self)},this.info.name=Ce(e),this.mutable=r}get name(){return new L(this.info.name)}set name(e){this.info.name=e.valueOf()}__setProperty__({},e,t){if(!(e instanceof L))return new De(n.unknown,"string",e.typeName().valueOf(),Ce(e));let r=Ce(e);if(!this.mutable)return new De(n.unknown,"mutable","immutable",`${Ce(this.name)}`);t instanceof E||(t=G(t));const i=this.__value__[r];return i?i.isConstant?new De(n.unknown,"mutable","immutable",`${Ce(this.name)}.${r}`):i.isAccessible?void(i.value=t):new De(n.unknown,"accessible","inaccessible",`${Ce(this.name)}.${r}`):new Re(n.unknown,"SymbolError",`Symbol ${r} is not declared in namespace ${Ce(this.name)}.`)}}class B extends E{constructor(e,t="<AnonNative>",r=!1){super(e,k.object),this.cast=({})=>new Re(n.unknown,"TypeError","Cannot cast native object"),this.clone=()=>new B(this.__value__),this.str=()=>{try{return new L(JSON.stringify(this.__value__))}catch(e){return new L(`${this.__value__}`)}},this.__eq__=({},e)=>new $(this===e),this.__bool__=()=>new $(!0),this.bool=this.__bool__,this.__getProperty__=(e,t)=>{const r=Ce(t),i=this.valueOf(),o=i[r];if(void 0===o){if(this.self.hasOwnProperty(r)){const e=this.self[Ce(r)];return"function"==typeof e?new M(e):G(e)}return new Le(n.unknown,r,this)}return o instanceof E?o:"function"==typeof o?new M((({context:t},...n)=>i[r](...n.map((t=>W(t,e)))))):new B(o)},this.__call__=(e,...t)=>{if("function"!=typeof this.__value__)return new De(n.unknown,"function",typeof this.__value__,Ce(this));let r;try{r=new this.__value__(...t.map((t=>W(t,e))))}catch(n){r=this.__value__(...t.map((t=>W(t,e))))}return r instanceof E?r:new B(r)},this.hasProperty=(e,t)=>new $(!(this.__getProperty__(e,t)instanceof Re)),this.info.name=Ce(t)}}k.type=new A(!0,"Type"),k.undefined=new A(!0,"Undefined"),k.string=new A(!0,"String"),k.array=new A(!0,"Array"),k.number=new A(!0,"Number"),k.any=new A(!0,"Any"),k.function=new A(!0,"Function"),k.bool=new A(!0,"Boolean"),k.object=new A(!0,"Object"),k.error=new A(!0,"Error"),k.any.info={name:"any",description:"Matches any other type",file:"built-in",isBuiltIn:!0},k.number.info={name:"any",description:"The ES Number type. Is a a double-precision 64-bit binary format IEEE 754 value, like double in Java and C#",file:"built-in",isBuiltIn:!0},k.string.info={name:"string",description:"The ES String type. Holds an array of characters, and can be defined with any of ', \" and `. Can be indexed like an array.",file:"built-in",isBuiltIn:!0},k.bool.info={name:"bool",description:"The ES Bool type. Exactly two instances exist, true and false.",file:"built-in",isBuiltIn:!0},k.function.info={name:"function",description:"The ES Function type. Is a block of code which executes when called and takes in 0+ parameters.",file:"built-in",isBuiltIn:!0},k.array.info={name:"array",description:"The ES Array type. Defines a set of items of any type which can be accessed by an index with [].",file:"built-in",isBuiltIn:!0},k.object.info={name:"object",description:"The ES Object type. Similar to JS objects or python dictionaries.",file:"built-in",isBuiltIn:!0},k.error.info={name:"error",description:"The ES Error type. Call to throw an error.",file:"built-in",isBuiltIn:!0},k.type.info={name:"type",description:"The ES Type type. Call to get the type of a value at a string.",file:"built-in",isBuiltIn:!0};class M extends E{constructor(e=(()=>{}),t=[],r="(anon)",i=new R,o=k.any,s=u){super(e,k.function),this.cast=({},e)=>new Re(n.unknown,"TypeError","Cannot cast type 'function'"),this.clone=()=>new M(this.__value__,this.arguments_,this.name,this.this_,this.returnType,this.__closure__),this.valueOf=()=>this,this.str=()=>new L(`<Func: ${this.name}>`),this.__eq__=({},e)=>new $(e instanceof M&&this.__value__===e.__value__),this.__bool__=()=>new $(!0),this.bool=this.__bool__,this.__call__=({context:e},...t)=>(this.__closure__.path=e.path,function(e,t,r){var i;let o=e;(e=t.__closure__).path=o.path;const s=t.__value__,a=function(e,t,r){const i=new Z;i.parent=r;let o=Math.max(e.length,t.arguments_.length);for(let s=0;s<o;s++){let o=new I,a=k.any;if(!t.arguments_[s])continue;const u=t.arguments_[s];if(!(u.type instanceof A))return new De(n.unknown,"Type",typeof u.type,u.type);if(e[s]instanceof E&&(a=e[s].__type__,o=e[s]),!u.type.includesType({context:r},a).bool().valueOf())return new De(n.unknown,u.type.__name__,a.__name__,Ce(o));i.setOwn(u.name,o,{forceThroughConst:!0})}let s=i.setOwn("args",new U(e),{forceThroughConst:!0});return s instanceof Re?s:i}(r,t,e);if(a instanceof Re)return a;let u=null!==(i=t.this_)&&void 0!==i?i:new R;if(!(u instanceof R))return new De(n.unknown,"object",typeof u,u,"'this' must be an object");let c=a.setOwn("this",u);return c instanceof Re?c:s instanceof ne?function(e,t,r,i){var o,s,a,u;const c=i.interpret(t);return c.error?c.error:(void 0!==c.funcReturn&&(c.val=c.funcReturn,c.funcReturn=void 0),!1===e.returnType.includesType({context:t},null!==(s=null===(o=c.val)||void 0===o?void 0:o.__type__)&&void 0!==s?s:k.any).valueOf()?new De(n.unknown,e.returnType.__name__,(null===(a=c.val)||void 0===a?void 0:a.typeName().valueOf())||"undefined",null===(u=c.val)||void 0===u?void 0:u.str().valueOf(),"(from function return)"):c.val?c.val:new I)}(t,a,0,s):"function"==typeof s?function(e,t,n,r){for(let e=n.length;e<r.length;e++)n.push(new I);const i=r({context:t},...n);return i instanceof Re||i instanceof E?i:new I}(0,a,r,s):new De(n.unknown,"function",typeof s)}(this.__closure__,this,t)),this.__getProperty__=({},e)=>{if(this.self.hasOwnProperty(Ce(e))){const t=this.self[Ce(e)];return"function"==typeof t?new M(t):G(t)}return new Le(n.unknown,e.valueOf(),this)},this.arguments_=t,this.info.name=r,this.this_=i,this.returnType=o,this.__closure__=s,this.info.returnType=Ce(o),this.info.args=t.map((e=>({name:e.name,defaultValue:Ce(e.defaultValue),type:e.type.info.name,required:!0})))}get name(){var e;return null!==(e=this.info.name)&&void 0!==e?e:"(anonymous)"}set name(e){this.info.name=e}}class D extends E{constructor(e=0){super(e,k.number),this.cast=({},e)=>{switch(e){case k.number:return this;case k.string:return this.str();case k.array:return new U(new Array(this.valueOf()));default:return new Re(n.unknown,"TypeError",`Cannot cast to type '${Ce(e.typeName())}'`)}},this.str=()=>new L(this.valueOf().toString()),this.__add__=({},e)=>e instanceof D?new D(this.valueOf()+e.valueOf()):new De(n.unknown,"Number",e.typeName().valueOf(),e.valueOf()),this.__subtract__=({},e)=>e instanceof D?new D(this.valueOf()-e.valueOf()):new De(n.unknown,"Number",e.typeName().valueOf(),e.valueOf()),this.__multiply__=({},e)=>e instanceof D?new D(this.valueOf()*e.valueOf()):new De(n.unknown,"Number",e.typeName().valueOf(),e.valueOf()),this.__divide__=({},e)=>e instanceof D?new D(this.valueOf()/e.valueOf()):new De(n.unknown,"Number",e.typeName().valueOf(),e.valueOf()),this.__pow__=({},e)=>e instanceof D?new D(Math.pow(this.valueOf(),e.valueOf())):new De(n.unknown,"Number",e.typeName().valueOf(),e.valueOf()),this.__eq__=({},e)=>new $(e instanceof D&&this.valueOf()===e.valueOf()),this.__gt__=({},e)=>e instanceof D?new $(this.valueOf()>e.valueOf()):new De(n.unknown,"Number",e.typeName().valueOf(),e.valueOf()),this.__lt__=({},e)=>e instanceof D?new $(this.valueOf()<e.valueOf()):new De(n.unknown,"Number",e.typeName().valueOf(),e.valueOf()),this.__bool__=()=>new $(this.valueOf()>0),this.bool=this.__bool__,this.clone=()=>new D(this.valueOf()),this.__getProperty__=({},e)=>{if(this.self.hasOwnProperty(Ce(e))){const t=this.self[Ce(e)];return"function"==typeof t?new M(t):G(t)}return new Le(n.unknown,e.valueOf(),this)}}}class $ extends E{constructor(e=!1){super(Boolean(e),k.bool),this.__getProperty__=(e,t)=>{if(this.self.hasOwnProperty(Ce(t))){const e=this.self[Ce(t)];return"function"==typeof e?new M(e):G(e)}return new Le(n.unknown,t.valueOf(),this)},this.cast=(e,t)=>t===k.number?new D(this.valueOf()?1:0):new Re(n.unknown,"TypeError",`Cannot cast boolean to type '${Ce(t.typeName())}'`),this.__eq__=(e,t)=>t instanceof $?new $(this.valueOf()===t.valueOf()):new De(n.unknown,"Boolean",t.typeName().valueOf(),t.valueOf()),this.__bool__=()=>this,this.__and__=(e,t)=>new $(this.valueOf()&&t.bool().valueOf()),this.__or__=(e,t)=>new $(this.valueOf()||t.bool().valueOf()),this.str=()=>new L(this.valueOf()?"true":"false"),this.clone=()=>new $(this.valueOf()),this.bool=()=>this,this.info={name:Ce(e),description:`Boolean global constant which evaluates to ${Ce(e)}, the opposite of ${Ce(!e)}`,file:"built-in",isBuiltIn:!0,helpLink:"https://en.wikipedia.org/wiki/Boolean_expression"}}}class U extends E{constructor(e=[]){super(e,k.array),this.cast=({},e)=>{switch(e){case k.number:return new D(this.len);case k.boolean:return this.bool();default:return new Re(n.unknown,"TypeError",`Cannot cast boolean to type '${Ce(e.typeName())}'`)}},this.str=()=>new L(Ce(this.valueOf())),this.__eq__=({context:e},t)=>{if(!(t instanceof U))return new $;if(t.len!==this.len)return new $;for(let n=0;n<this.len;n++){const r=this.valueOf()[n],i=t.valueOf()[n];if(!r){if(i)return new $;continue}if(!r.__eq__)return new $;const o=r.__eq__({context:e},i);if(o instanceof Re)return o;if(!o.valueOf())return new $}return new $(!0)},this.__add__=({context:e},t)=>t instanceof U?new U([...this.valueOf(),...t.valueOf()]):new De(n.unknown,"array",t.typeName().valueOf(),t),this.__bool__=()=>new $(this.valueOf().length>0),this.bool=this.__bool__,this.__getProperty__=({},e)=>{if(e instanceof L&&this.self.hasOwnProperty(Ce(e))){const t=this.self[Ce(e)];return"function"==typeof t?new M(t):G(t)}if(!(e instanceof D))return new I;let t=e.valueOf();for(;t<0;)t=this.valueOf().length+t;return t<this.valueOf().length?this.valueOf()[t]:new I},this.add=({},e,t=new D(this.len-1))=>{if(!(e instanceof E))throw"adding non-primitive to array: "+Ce(e);return this.len++,this.__value__.splice(t.valueOf(),0,e),new D(this.len)},this.contains=({},e)=>{for(let t of this.__value__)if(e.valueOf()==t.valueOf())return!0;return!1},this.clone=()=>{const e=[];for(let t of this.valueOf())e.push(t);return new U(e)},this.len=e.length}__setProperty__({},e,t){if(!(e instanceof D))return;t instanceof E||(t=G(t));let n=e.valueOf();for(;n<0;)n=this.valueOf().length+n;this.__value__[n]=t}}class L extends E{constructor(e=""){super(e,k.string),this.str=()=>this,this.cast=({},e)=>{switch(e){case k.number:const t=parseFloat(this.valueOf());return isNaN(t)?new Re(n.unknown,"TypeError","This string is not a valid number"):new D(t);case k.string:return this;case k.array:return new U(this.valueOf().split("").map((e=>new L(e))));default:return new Re(n.unknown,"TypeError",`Cannot cast to type '${Ce(e.typeName())}'`)}},this.__add__=({},e)=>e instanceof L?new L(this.valueOf()+e.valueOf()):new De(n.unknown,"String",e.typeName().valueOf(),e.valueOf()),this.__multiply__=({},e)=>e instanceof D?new L(this.valueOf().repeat(e.valueOf())):new De(n.unknown,"Number",e.typeName().valueOf(),e.valueOf()),this.__eq__=({},e)=>new $(e instanceof L&&this.valueOf()===e.valueOf()),this.__gt__=({},e)=>e instanceof L?new $(this.valueOf().length>e.valueOf().length):new De(n.unknown,"String",e.typeName().valueOf(),e.valueOf()),this.__lt__=({},e)=>e instanceof L?new $(this.valueOf().length<e.valueOf().length):new De(n.unknown,"String",e.typeName().valueOf(),e.valueOf()),this.__bool__=()=>new $(this.valueOf().length>0),this.bool=this.__bool__,this.len=()=>new D(this.valueOf().length),this.clone=()=>new L(this.valueOf()),this.__getProperty__=(e,t)=>{if(t instanceof L&&this.self.hasOwnProperty(Ce(t))){const e=this.self[Ce(t)];return"function"==typeof e?new M(e):G(e)}if(!(t instanceof D))return new L;let n=t.valueOf();for(;n<0;)n=this.valueOf().length+n;return n<this.valueOf().length?new L(this.valueOf()[n]):new L}}__setProperty__({},e,t){if(!(e instanceof D))return;t instanceof L||(t=new L(Ce(t)));let n=e.valueOf();for(;n<0;)n=this.valueOf().length+n;const r=t.str().valueOf();let i=this.__value__.substr(0,n),o=this.__value__.substr(n+r.length);this.__value__=i+r+o}}class j{constructor(e,t,n={}){var r,i;this.clone=()=>new j(this.value.clone(),this.identifier,{isConstant:this.isConstant,isAccessible:this.isAccessible}),this.str=()=>new L(`<Symbol: ${this.identifier}>`),this.value=e,this.identifier=t,this.isConstant=null!==(r=n.isConstant)&&void 0!==r&&r,this.isAccessible=null===(i=n.isAccessible)||void 0===i||i}}function G(e,t=!1){return e instanceof E?e:null==e?new I:e instanceof Re?new O(e):e instanceof j?e.value:"number"==typeof e?new D(e):"string"==typeof e?new L(e):"boolean"==typeof e?new $(e):"bigint"==typeof e?new D(Number(e)):"symbol"==typeof e?new L(String(e)):new B(e,void 0,t)}function W(e,t){if(null!=e){if(!(e instanceof E))return e;if(e instanceof U)return e.valueOf().map((e=>W(e,t)),t);if(e instanceof R){let n={};for(let r in e.valueOf())n[r]=W(e.valueOf()[r],t);return n}if(!(e instanceof I))return e instanceof M?(...n)=>{const r=e.__call__(t,...n.map((e=>G(e))));return r instanceof Re?r:W(r,t)}:e instanceof A?e:e.valueOf()}}const q={red:31,yellow:33,green:32,cyan:36,blue:34,grey:2},F={};for(let e of Object.keys(q))F[e]=t=>(t||(t=""),f?`[${q[e]}m`+t+"[0m":`<span style="color: ${e}">${t}</span>`);const z=F,V={range:[({context:e},t)=>{if(!(t instanceof D))return new De(n.unknown,"Number",t.typeName().valueOf(),t.valueOf());const r=t.valueOf();try{return new U([...Array(r).keys()].map((e=>new D(e))))}catch(e){return new Re(n.unknown,"RangeError",`Cannot make range of length '${Ce(t)}'`)}},{args:[{name:"N",type:"Number"}],description:"Generates an array of integers given N. Starts at 0 and goes to N-1. Can be used like for i in range(10) ..., similarly to python.",returns:"array of numbers from 0 to N-1",returnType:"number[] | RangeError"}],log:[({context:e},...t)=>{console.log(...t.map((e=>Ce(e))))},{args:[{name:"...values",type:"any[]"}],description:"Uses console.log to log all values",returnType:"void"}],parseNum:[({context:e},t)=>{try{const e=parseFloat(Ce(t));return isNaN(e)?new Re(n.unknown,"TypeError",`Cannot convert '${Ce(t)}' to a number.`):new D(e)}catch(e){return new Re(n.unknown,"TypeError",`Cannot convert '${Ce(t)}' to a number.`)}},{args:[{name:"num",type:"any"}],description:"Converts a string of digits into a number. Works with decimals and integers. Calls .str() on value before using native JS 'parseFloat' function. Returns TypeError if the string can't be converted into a number.",returnType:"number | TypeError"}],help:[({context:e},...t)=>{if(!t.length)return new L("Visit https://entropygames.io/entropy-script for help with Entropy Script!\nTry 'help(<anything>)' for help about a particular object.");let n="";for(const e of t){if(!(e instanceof E))return void console.log("Invalid arg not primitive: "+Ce(e));const t=e.info;if(n+=`${z.yellow(`Help on '${t.name||"(anonymous)"}'`)}:\n    \n    ${z.yellow("Value")}: ${Ae(Ae(Ce(e)))}\n    ${z.yellow("Type")}: '${Ce(e.typeName())}'\n    ${z.yellow("Location")}: ${t.file||z.yellow("(unknown)")}\n    \n        ${z.green(t.description)||"No description."}\n        \n    ${t.helpLink?z.cyan(t.helpLink+"\n\n"):""}\n`,t.args&&e instanceof M){const e=t.args.length,r=t.args.filter((e=>e.required)).length;n+=e==r?z.yellow(`    Arguments (${e}): \n`):z.yellow(`    Arguments (${r}-${e}): \n`);for(const[e,r]of t.args.entries())n+="object"!=typeof r?`        ${e+1}. INVALID ARG INFO`:`        ${e+1}. ${r.name}${!1===r.required?z.yellow(" (optional) "):" "}{${r.type}} ${r.description||""}\n`;n+="\n\n",t.returns&&(n+=`    Returns: ${t.returns}\n\n`),t.returnType&&(n+=`    Return Type: ${t.returnType}\n\n`)}if(t.contents&&(e instanceof R||e instanceof N)){n+="    Properties: \n      ";for(let e of t.contents)n+=e.name+"\n      "}}return console.log(n),t.length>1?new U(t):t?t[0]:void 0},{args:[{name:"value",type:"any"}],description:"logs info on value",returns:"value passed in"}],delete:[({context:e},t)=>{const r=Ce(t);if(!e.has(r))return new Re(n.unknown,"DeleteError",`Identifier '${r}' not found in the current context`);e.set(r,new I)},{name:"delete",args:[{name:"identifier",type:"string"}],description:"Deletes a variable from the current context"}],__path:[({context:e})=>new L(e.path),{name:"__path",args:[],description:"Returns the current path"}],__symbols:[({context:e})=>G(e.keys),{name:"__allSymbols",args:[],description:"Returns an array of the names of all symbols in the current context"}],using:[({context:e},t,r)=>{if(!(t instanceof N||t instanceof B))return new De(n.unknown,"Namespace",Ce(t.typeName()));let i=!0;r&&(r.bool().valueOf()||(i=!1));const o=t.valueOf();i?e=e.root:e.parent&&(e=e.parent);for(const t of Object.keys(o))e.setOwn(t,o[t].value,{isConstant:o[t].isConstant,isAccessible:o[t].isAccessible,forceThroughConst:!0})},{name:"using",args:[{name:"module",type:"namespace"},{name:"global",type:"bool"}],description:"Adds contents of a namespace to the global context"}],sleep:[({context:e},t,r)=>t instanceof D?r instanceof M?void Pe(t.valueOf()).then((()=>{const t=r.__call__({context:e});t instanceof Re&&console.log(t.str)})):new De(n.unknown,"function",Ce(r.typeName()),Ce(r)):new De(n.unknown,"number",Ce(t.typeName()),Ce(t)),{name:"sleep",args:[{name:"n",type:"number"},{name:"callback",type:"function"}],description:"Waits n milliseconds and then executes the callback"}]},K={ascii:{asciiToChar:(e,t)=>t instanceof D?new L(String.fromCharCode(t.valueOf())):new De(n.unknown,"number",Ce(t.typeName()),Ce(t)),charToAscii:(e,t)=>t instanceof L?new D(Ce(t).charCodeAt(0)):new De(n.unknown,"string",Ce(t.typeName()),Ce(t))},json:{parse:(e,t)=>new R(JSON.parse(Ce(t))),stringify:(e,t)=>t instanceof R?new L(JSON.stringify(W(t,e))):new De(n.unknown,"object",Ce(t.typeName()),Ce(t))}},Q={};function Y(e,t){const n={},r=e.valueOf();for(const e of Object.keys(r))n[e]=new j(r[e],e);return new B(n,t)}function H(e){return e in K||e in Q}function J(e){if(e in Q)return Q[e];if(e in K){const t=Y(new B(K[e]),e);return Q[e]=t,t}}function X(e,t,r){V.import=[({context:r},i,o)=>{if(f)return new Re(n.unknown,"ImportError","Is running in node instance but trying to run browser import function");const s=i.str();if(H(Ce(s)))return J(Ce(s));try{fetch(Ce(s)).then((e=>e.text())).then((i=>{return a=this,void 0,c=function*(){const a=new Z;a.parent=e;const u=yield Qe(i);u.error?t(new $e(n.unknown,Ce(s),u.error.str).str):o instanceof M&&o.__call__({context:r},new N(s,a.getSymbolTableAsDict()))},new((u=void 0)||(u=Promise))((function(e,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function r(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof u?i:new u((function(e){e(i)}))).then(n,r)}i((c=c.apply(a,[])).next())}));var a,u,c}))}catch(e){return new Re(n.unknown,"ImportError",e.toString())}},{}],V.print=[({context:e},...n)=>{let r="";for(let e of n)r+=Ce(e);t(r)},{}],V.input=[({context:e},t,n)=>{r(t.valueOf(),(t=>{let r=null==n?void 0:n.valueOf();if(r instanceof M){let n=r.__call__({context:e},new L(t));n instanceof Re&&console.log(n.str)}else"function"==typeof r&&r(t);return new L("'input()' does not return anything. Pass in a function as the second argument, which will take the user input as an argument.")}))},{}];for(let t in V){const n=new M(V[t][0],[],t,void 0,void 0,e);n.info=V[t][1],n.info.name=t,n.info.isBuiltIn=!0,n.info.file="built-in",e.set(t,n,{global:!0,isConstant:!0})}!function(e){const t={false:new $(!1),true:new $(!0),nil:new I,any:k.any,number:k.number,string:k.string,bool:k.bool,function:k.function,array:k.array,object:k.object,type:k.type,error:k.error,undefined:k.undefined};for(let n in t){const r=t[n];e.set(n,r,{global:!0,isConstant:!0})}}(e);const i=function(){if(Q.math=new B(Math),!f){const e=(()=>{if(f)return new Ge;const e=window;return void 0!==e&&"$"in e?{$:new B(e.$,"jquery"),window:new B(e,"window"),document:new B(e.document,"document")}:new Ue(n.unknown,"$ must be property of window to use dom library")})();if(e instanceof Re)return e;K.dom=e}}();if(i)return i;e.initialisedAsGlobal=!0}class Z{constructor(){this.symbolTable={},this.initialisedAsGlobal=!1,this.deleted=!1,this.path_=""}get path(){return this.path_||!this.parent?this.path_:this.parent.path}set path(e){this.path_=e}get parent(){return this.parent_}set parent(e){e!=this?this.parent_=e:console.error(z.red("Setting context parent to self"))}has(e){return void 0!==this.get(e)}hasOwn(e){return this.symbolTable[e]instanceof j}get(e){let t=this.getSymbol(e);return t instanceof Re||null==t?t:t.value}getRawSymbolTableAsDict(){const e={};for(let t in this.symbolTable)e[t]=this.symbolTable[t].value;return e}getSymbolTableAsDict(){const e={};for(let t in this.symbolTable)e[t]=this.symbolTable[t];return e}getSymbol(e){let t=this.symbolTable[e];if(void 0!==t&&!t.isAccessible)return new De(n.unknown,"assessable","inaccessible",t.identifier);if(void 0===t&&this.parent){let r=this.parent.getSymbol(e);if(r instanceof Re)return r;if(!r)return new Ue(n.unknown,e);t=r}return t}set(e,t,n={}){let r=this;if(n.global)r=this.root;else{for(;!r.hasOwn(e)&&void 0!==r.parent;)r=r.parent;r.hasOwn(e)||(r=this)}return r.setOwn(e,t,n)}setOwn(e,t,r={}){if(t instanceof E||(t=G(t)),r.global&&!this.initialisedAsGlobal&&(r.global=!1),!r.forceThroughConst){let t=this.symbolTable[e];if(null==t?void 0:t.isConstant)return new De(n.unknown,"dynamic","constant",e)}this.symbolTable[e]=new j(t,e,r)}remove(e){delete this.symbolTable[e]}clear(){for(let e in this.symbolTable)this.remove(e);this.parent=void 0,this.deleted=!0}get root(){let e=this;for(;e.parent;)e=e.parent;return e}get keys(){return Object.keys(this.symbolTable)}resetAsGlobal(){var e,t;if(!this.initialisedAsGlobal)return;const n=this.root.get("print"),r=this.root.get("input");n instanceof E&&r instanceof E?(this.symbolTable={},this.initialisedAsGlobal=!1,X(this,(null===(e=n.valueOf())||void 0===e?void 0:e.func)||console.log,(null===(t=r.valueOf())||void 0===t?void 0:t.func)||(()=>{}))):console.error("Error with print and input functions.")}clone(){const e=new Z;return e.parent=this.parent,e.deleted=this.deleted,e.initialisedAsGlobal=this.initialisedAsGlobal,e.symbolTable=Object.assign(Object.assign({},e.symbolTable),this.symbolTable),e}deepClone(){var e;let t=this.clone();return t.parent=null===(e=t.parent)||void 0===e?void 0:e.deepClone(),t}log(){console.log("---- CONTEXT ----");for(let e in this.symbolTable){const t=this.symbolTable[e];let n=e;t.isConstant&&(n+=" (CONST)"),t.isAccessible||(n+=" (INACCESSIBLE)"),n+=": ",n+=Ce(this.symbolTable[e].value),console.log(n)}console.log("-----------------")}}function ee(e,t){var r;let i;const o=e.type.interpret(t);if(o.error)return o.error;if(!(o.val instanceof A))return new De(n.unknown,"Type",typeof o.val,o.val,"Argument can't be undefined");let s;if(i=o.val,e.defaultValue){let n=null===(r=e.defaultValue)||void 0===r?void 0:r.interpret(t);if(n.error)return n.error;n.val instanceof E&&(s=n.val)}return{name:e.name,type:i,defaultValue:s}}class te{constructor(){this.val=new I,this.shouldBreak=!1,this.shouldContinue=!1}}class ne{constructor(e,t=!1){this.pos=e,this.isTerminal=t}interpret(e){var t;const r=v(),i=new te,o=this.interpret_(e);o instanceof Re?i.error=o:o instanceof te?(i.val=o.val,i.error=o.error,i.funcReturn=o.funcReturn,i.shouldBreak=o.shouldBreak,i.shouldContinue=o.shouldContinue):i.val=o,i.error&&i.error.pos.isUnknown&&(i.error.pos=this.pos),i.val instanceof E||(i.error=new De(n.unknown,"Primitive","Native JS value",Ce(i.val)),i.val=new I),(t=i.val.info).file||(t.file=this.pos.file),ne.interprets++;let s=v()-r;return ne.totalTime+=s,s>ne.maxTime&&(ne.maxTime=s),i}}ne.interprets=0,ne.totalTime=0,ne.maxTime=0;class re extends ne{constructor(e,t,n,r){super(e),this.left=t,this.opTok=n,this.right=r}interpret_(e){const t=this.left.interpret(e);if(t.error)return t.error;const n=this.right.interpret(e);if(n.error)return n.error;const r=t.val,i=n.val;if(void 0===r)return new De(this.opTok.pos,"~undefined","undefined",r,"N_binOp.interpret_");if(void 0===i)return new De(this.opTok.pos,"~undefined","undefined",i,"N_binOp.interpret_");switch(this.opTok.type){case b.LTE:{const t=r.__lt__({context:e},i),n=r.__eq__({context:e},i);return t instanceof Re?t:n instanceof Re?n:t.__or__({context:e},n)}case b.GTE:{const t=r.__gt__({context:e},i),n=r.__eq__({context:e},i);return t instanceof Re?t:n instanceof Re?n:t.__or__({context:e},n)}case b.NOTEQUALS:{const t=r.__eq__({context:e},i);return t instanceof Re?t:new $(!t.bool().valueOf())}case b.ADD:return r.__add__({context:e},i);case b.SUB:return r.__subtract__({context:e},i);case b.MUL:return r.__multiply__({context:e},i);case b.DIV:return r.__divide__({context:e},i);case b.POW:return r.__pow__({context:e},i);case b.EQUALS:return r.__eq__({context:e},i);case b.LT:return r.__lt__({context:e},i);case b.GT:return r.__gt__({context:e},i);case b.AND:return r.__and__({context:e},i);case b.OR:return r.__or__({context:e},i);default:return new Be(this.opTok.pos,`Invalid binary operator: ${w[this.opTok.type]}`)}}}class ie extends ne{constructor(e,t,n){super(e),this.a=t,this.opTok=n}interpret_(e){var t,n,r;const i=this.a.interpret(e);if(i.error)return i.error;switch(this.opTok.type){case b.SUB:case b.ADD:if(!(i.val instanceof D))return new De(this.pos,"Number",(null===(t=i.val)||void 0===t?void 0:t.typeName().toString())||"undefined_",null===(n=i.val)||void 0===n?void 0:n.valueOf());const e=i.val.valueOf();return new D(this.opTok.type===b.SUB?-e:Math.abs(e));case b.NOT:return new $(!(null===(r=null==i?void 0:i.val)||void 0===r?void 0:r.bool().valueOf()));default:return new Be(this.opTok.pos,`Invalid unary operator: ${w[this.opTok.type]}`)}}}class oe extends ne{constructor(e,t,n,r="=",i=!1,o=!1,s=!1,a=!1,u=k.any){super(e),this.value=n,this.varNameTok=t,this.isGlobal=i,this.assignType=r,this.isConstant=s,this.isDeclaration=a,this.isLocal=o,this.type=u instanceof A?new Ee(u):u}interpret_(e){var t,n,r,i;if(this.isDeclaration&&e.hasOwn(this.varNameTok.value))return new Be(this.pos,`Symbol '${this.varNameTok.value}' already exists, and cannot be redeclared`);const o=this.value.interpret(e),s=this.type.interpret(e);if(o.error)return o.error;if(s.error)return s.error;if(!(s.val&&s.val instanceof A))return new De(this.varNameTok.pos,"Type",null!==(n=null===(t=s.val)||void 0===t?void 0:t.typeName().valueOf())&&void 0!==n?n:"undefined",null===(r=s.val)||void 0===r?void 0:r.str(),"@ !typeRes.val || !(typeRes.val instanceof ESType)");if(!o.val)return new De(this.varNameTok.pos,"~undefined","undefined","N_varAssign.interpret_");if(!s.val.includesType({context:e},o.val.__type__).bool().valueOf())return new De(this.varNameTok.pos,Ce(s.val),Ce(null===(i=o.val)||void 0===i?void 0:i.typeName()),Ce(o.val));if(this.isDeclaration)return"="!==this.assignType?new Be(this.pos,`Cannot declare variable with operator '${this.assignType}'`):(e.setOwn(this.varNameTok.value,o.val,{global:!1,isConstant:this.isConstant}),o.val);if("="===this.assignType){let t=o.val;void 0===t&&(t=new I);const n=e.set(this.varNameTok.value,t,{global:this.isGlobal,isConstant:this.isConstant});if(n instanceof Re)return n}else{if(this.isDeclaration)return new Be(this.pos,`Cannot declare variable with operator '${this.assignType}'`);const t=e.get(this.varNameTok.value);if(t instanceof Re)return t;if(null==t)return new Be(this.pos,`Cannot declare variable with operator '${this.assignType}'`);let n,r=o.val;switch(this.assignType[0]){case"*":n=t.__multiply__({context:e},r);break;case"/":n=t.__divide__({context:e},r);break;case"+":n=t.__add__({context:e},r);break;case"-":n=t.__subtract__({context:e},r);break;default:return new Re(this.pos,"AssignError",`Cannot find assignType of ${this.assignType[0]}`)}if(n instanceof Re)return n;let i=e.set(this.varNameTok.value,n,{global:this.isGlobal,isConstant:this.isConstant});if(i instanceof Re)return i;o.val=n}return"(anonymous)"!==o.val.info.name&&o.val.info.name||(o.val.info.name=this.varNameTok.value),o}}class se extends ne{constructor(e,t,n,r){super(e),this.comparison=t,this.ifFalse=r,this.ifTrue=n}interpret_(e){var t;let n=new Z;n.parent=e;let r=new te,i=this.comparison.interpret(e);if(i.error)return i;if(null===(t=i.val)||void 0===t?void 0:t.bool().valueOf()){if(r=this.ifTrue.interpret(n),r.val=new I,r.error)return r}else if(this.ifFalse&&(r=this.ifFalse.interpret(n),r.val=new I,r.error))return r;return r}}class ae extends ne{constructor(e,t,n){super(e),this.comparison=t,this.loop=n}interpret_(e){var t,n;let r=new Z;for(r.parent=e;;){let i=this.comparison.interpret(e);if(i.error)return i;if(!(null===(n=null===(t=i.val)||void 0===t?void 0:t.bool())||void 0===n?void 0:n.valueOf()))break;let o=this.loop.interpret(r);if(o.error)return o;if(o.shouldBreak)break}return new I}}class ue extends ne{constructor(e,t,n,r,i,o){super(e),this.body=t,this.array=n,this.identifier=r,this.isGlobalId=i,this.isConstId=o}interpret_(e){var t,n,r,i,o,s,a,u;let c=new Z;c.parent=e;const l=this.array.interpret(e);if(l.error)return l;if(-1===["Array","Number","Object","String","Any"].indexOf((null===(t=l.val)||void 0===t?void 0:t.typeName().valueOf())||""))return new De(this.identifier.pos,"Array | Number | Object | String",typeof l.val+" | "+(null===(n=l.val)||void 0===n?void 0:n.typeName()));function f(e,t,n,r,i){c.set(t,n,{global:r,isConstant:i});const o=e.interpret(c);return o.error||void 0!==o.funcReturn?o:o.shouldBreak?(o.shouldBreak=!1,"break"):void(o.shouldContinue&&(o.shouldContinue=!1))}if(l.val instanceof D||"number"==typeof(null===(r=l.val)||void 0===r?void 0:r.valueOf()))for(let e=0;e<l.val.valueOf();e++){const t=f(this.body,this.identifier.value,new D(e),this.isGlobalId,this.isConstId);if("break"===t)break;if(t&&(t.error||void 0!==t.funcReturn))return t}else if(l.val instanceof R||"number"==typeof(null===(i=l.val)||void 0===i?void 0:i.valueOf())&&!Array.isArray(null===(o=l.val)||void 0===o?void 0:o.valueOf()))for(let e in null===(s=l.val)||void 0===s?void 0:s.valueOf()){const t=f(this.body,this.identifier.value,new L(e),this.isGlobalId,this.isConstId);if("break"===t)break;if(t&&(t.error||void 0!==t.funcReturn))return t}else{if(!(l.val instanceof U||Array.isArray(null===(a=l.val)||void 0===a?void 0:a.valueOf())))return new De(this.identifier.pos,"Array | Number | Object | String",typeof l.val);for(let e of null===(u=l.val)||void 0===u?void 0:u.valueOf()){const t=f(this.body,this.identifier.value,e,this.isGlobalId,this.isConstId);if("break"===t)break;if(t&&(t.error||void 0!==t.funcReturn))return t}}return new I}}class ce extends ne{constructor(e,t,n=!1){super(e),this.items=t,this.shouldClone=n}interpret_(e){let t=new te,n=[];for(let t of this.items){const r=t.interpret(e);if(r.error||void 0!==r.funcReturn)return r;if(!r.val)continue;let i=r.val;this.shouldClone&&(i=i.clone()),n.push(i)}return t.val=new U(n),t}}class le extends ne{constructor(e,t){super(e),this.properties=t}interpret_(e){let t={};for(const[n,r]of this.properties){const i=r.interpret(e);if(i.error)return i.error;const o=n.interpret(e);if(o.error)return o.error;o.val&&i.val&&(t[o.val.valueOf()]=i.val)}return new R(t)}}class fe extends ne{constructor(e){super(e)}interpret_(e){return new R({})}}class he extends ne{constructor(e,t){super(e),this.items=t}interpret_(e){let t;for(let n of this.items){const r=n.interpret(e);if(r.error||void 0!==r.funcReturn||r.shouldBreak||r.shouldContinue)return r;t=r.val}return t||new I}}class de extends ne{constructor(e,t,n){super(e),this.arguments=n,this.to=t}interpret_(e){let{val:t,error:n}=this.to.interpret(e);if(n)return n;if(!t)return new De(this.pos,"any","undefined",void 0,"On function call");let r=[];for(let t of this.arguments){const n=t.interpret(e);if(n.error)return n.error;n.val&&r.push(n.val)}const i=t.__call__({context:e},...r);return i instanceof Re&&i.traceback.push({position:this.pos,line:`${t.info.name||"<AnonFunction>"}(${r.map(Ce).join(", ")})`}),i}}class pe extends ne{constructor(e,t,n,r,i="(anon)",o=new R,s=""){super(e),this.arguments=n,this.body=t,this.name=i,this.this_=o,this.returnType=r,this.description=s}interpret_(e){var t,n,r;let i=[];for(let t of this.arguments){const n=ee(t,e);if(n instanceof Re)return n;i.push(n)}const o=this.returnType.interpret(e);return o.error?o.error:o.val instanceof A?new M(this.body,i,this.name,this.this_,o.val,e):new De(this.returnType.pos,"Type",null!==(n=null===(t=o.val)||void 0===t?void 0:t.typeName().valueOf())&&void 0!==n?n:"<Undefined>",null===(r=o.val)||void 0===r?void 0:r.str().valueOf(),`On func '${this.name}' return type`)}}class ve extends ne{constructor(e,t){super(e),this.value=t}interpret_(e){const t=new te;if(void 0===this.value)return t.funcReturn=new I,t;let n=this.value.interpret(e);return n.error?n.error:(t.funcReturn=n.val,t)}}class ye extends ne{constructor(e,t){super(e),this.value=t}interpret_(e){var t;const n=new te;if(void 0===this.value)return n.funcReturn=new I,n;let r=this.value.interpret(e);return r.error?r.error:((null===(t=r.val)||void 0===t?void 0:t.bool().valueOf())&&(n.funcReturn=r.val),n)}}class me extends ne{constructor(e,t,n){super(e),this.base=t,this.index=n}interpret_(e){var t;let n=this.base.interpret(e);if(n.error)return n;let r=this.index.interpret(e);if(r.error)return r;const i=r.val,o=n.val;if(!o||!i)return new I;if(void 0!==this.value){let n=this.value.interpret(e);if(n.error)return n;const r=G(o.__getProperty__({context:e},i));let s,a=n.val;if(null!==(t=this.assignType)&&void 0!==t||(this.assignType="="),!a)return new De(this.pos,"~undefined","undefined","undefined","N_indexed.interpret_");switch(this.assignType[0]){case"*":s=r.__multiply__({context:e},a);break;case"/":s=r.__divide__({context:e},a);break;case"+":s=r.__add__({context:e},a);break;case"-":s=r.__subtract__({context:e},a);break;case"=":s=a;break;default:return new Re(this.pos,"AssignError",`Cannot find assignType of ${this.assignType[0]}`)}if(s instanceof Re)return s;if(!o.__setProperty__)return new De(this.pos,"mutable","immutable",o.valueOf());const u=o.__setProperty__({context:e},i,null!=s?s:new I);if(u instanceof Re)return u}return o.__getProperty__({context:e},i)}}class _e extends ne{constructor(e,t,n,r,i="<anon class>"){super(e),this.init=r,this.methods=t,this.name=i,this.extends_=n,this.instances=[]}interpret_(e){var t,n,r;const i=[];for(let n of this.methods){const r=n.interpret(e);if(r.error)return r.error;if(!(r.val instanceof M))return new De(this.pos,"Function",(null===(t=r.val)||void 0===t?void 0:t.typeName().valueOf())||"undefined","method on "+this.name);i.push(r.val)}let o,s;if(this.extends_){const t=this.extends_.interpret(e);if(t.error)return t.error;if(!(t.val instanceof A))return new De(this.pos,"Function",(null===(n=t.val)||void 0===n?void 0:n.typeName().valueOf())||"undefined","method on "+this.name);o=t.val}if(this.init){const t=this.init.interpret(e);if(t.error)return t.error;if(!(t.val instanceof M))return new De(this.pos,"Function",(null===(r=t.val)||void 0===r?void 0:r.typeName().valueOf())||"undefined","method on "+this.name);s=t.val}return new A(!1,this.name,i,o,s)}}class be extends ne{constructor(e,t,n="(anon)",r=!1){super(e),this.name=n,this.statements=t,this.mutable=r}interpret_(e){const t=new Z;t.parent=e;const n=this.statements.interpret(t);return n.error?n:new N(new L(this.name),t.getSymbolTableAsDict(),this.mutable)}}class we extends ne{constructor(e,t){super(e,!0),this.a=t}interpret_(e){let t=this.a.value;if("number"!=typeof t)return new De(this.pos,"number",typeof t);const n=new te;return n.val=new D(t),n}}class ge extends ne{constructor(e,t){super(e,!0),this.a=t}interpret_(e){let t=this.a.value;if("string"!=typeof t)return new De(this.pos,"string",typeof t);const n=new te;return n.val=new L(t),n}}class xe extends ne{constructor(e){super(e.pos,!0),this.a=e}interpret_(e){if(!e.has(this.a.value))return new Ue(this.a.pos,this.a.value);let t=new te,n=e.getSymbol(this.a.value);return n?n instanceof Re?n:(t.val=n.value,t):new I}}class Se extends ne{constructor(e=n.unknown){super(e,!0)}interpret_(e){const t=new te;return t.val=new I,t}}class Te extends ne{constructor(e){super(e,!0)}interpret_(e){const t=new te;return t.shouldBreak=!0,t}}class ke extends ne{constructor(e){super(e,!0)}interpret_(e){const t=new te;return t.shouldContinue=!0,t}}class Ee extends ne{constructor(e,t=n.unknown){super(t,!0),this.value=e}interpret_(e){return this.value}}function Oe(e,t=new WeakMap){let n;if(Object(e)!==e||e instanceof Function)return e;if(t.has(e))return t.get(e);try{n=new e.constructor}catch(t){n=Object.create(Object.getPrototypeOf(e))}return e instanceof Map?Array.from(e,(([e,r])=>n.set(Oe(e,t),Oe(r,t)))):e instanceof Set&&Array.from(e,(e=>n.add(Oe(e,t)))),t.set(e,n),Object.assign(n,...Object.keys(e).map((n=>({[n]:Oe(e[n],t)}))))}function Ce(e,t=0){if("string"==typeof e)return t>0?`'${e}'`:e;if(t>20)return"...";let n="";if(void 0===e)return"undefined";if(e instanceof E)return e.str().valueOf();if(e instanceof ne)return`<RunTimeNode: ${e.constructor.name}>`;switch(typeof e){case"object":if(Array.isArray(e)){n+="[";for(let r of e)try{n+=Ce(r,t+1)+", "}catch(e){n+="<large property>, "}e.length&&(n=n.substring(0,n.length-2)),n+="]"}else{try{n+=e.constructor.name}catch(e){n+="UNKNOWN_CONSTRUCTOR"}n+=": {\n";let r=0;for(let i in e)r++,e.hasOwnProperty&&e.hasOwnProperty(i)&&(n+=`  ${i}: ${Ce(e[i],t+1)||""}, \n`);r>0&&(n=n.substring(0,n.length-3)),n+="\n}\n"}break;case"string":n=`'${e}'`;break;case"bigint":case"number":case"boolean":n=`${e}`;break;case"undefined":n="<NativeUndefined>";break;case"function":n=`<NativeFunction ${e.name}>`}for(let e=0;e<t;e++)n=Ae(n);return n}const Pe=e=>new Promise((t=>setTimeout((()=>t()),e)));function Ae(e){return e.replace(/\n/g,"\n    ")}const Ie=e=>/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(e);class Re{constructor(e,t,n){this.traceback=[],this.pos=e,this.name=t,this.details=n}get colouredStr(){let e="";if(this.traceback.length){e=z.yellow("Error Traceback (most recent call last):\n");for(let t of[...this.traceback].reverse())e+=`    ${z.cyan(t.position.str)}:\n        ${t.line}\n`}return e+=`${z.red(this.name)}: ${this.details} \n at ${z.cyan(this.pos.str)}`,e}get str(){return`${this.name}: ${this.details} \n at ${this.pos.str}`}}class Ne extends Re{constructor(e,t){super(e,"IllegalCharError",`'${t}'`)}}class Be extends Re{constructor(e,t){super(e,"InvalidSyntaxError",t)}}class Me extends Re{constructor(e,t){super(e,"ExpectedCharError",`'${t}'`)}}class De extends Re{constructor(e,t,n,r="",i=""){super(e,"TypeError",`Expected type '${t}', got type '${n}' ${void 0===r?"":` on value '${Ce(r)}'`} ${i||""}`)}}class $e extends Re{constructor(e,t,n=""){super(e,"ImportError",`Could not import ${t}: ${n}`)}}class Ue extends Re{constructor(e,t){super(e,"ReferenceError",`${t} is not defined`)}}class Le extends Re{constructor(e,t,n){var r;super(e,"IndexError",`'${t}' is not a property of '${(null===(r=null==n?void 0:n.info)||void 0===r?void 0:r.name)||Ce(n)}'`)}}class je extends Re{constructor(e,t,r="",i=n.unknown){var o;super(i,"TypeError",`Cannot perform '${e}' on value ${(null===(o=null==t?void 0:t.info)||void 0===o?void 0:o.name)||Ce(t)}: ${r}`)}}class Ge extends Re{constructor(){super(n.unknown,"InvalidRuntimeError","Required runtime of "+(f?"browser":"node"))}}class We extends Re{constructor(e){super(n.unknown,"TestFailed",e)}}class qe{constructor(e,t,n){this.type=t,this.value=n,this.pos=e}matches(e,t){return this.type===e&&this.value===t}}class Fe{constructor(e,t){this.text=e,this.position=new n(-1,0,-1,t),this.advance()}advance(){this.position.advance(this.currentChar),this.currentChar=this.text[this.position.idx]}generate(){if(!this.text)return[new qe(this.position,b.EOF)];const e=[];for(;void 0!==this.currentChar;)if(" \t\n".includes(this.currentChar))this.advance();else if(r.includes(this.currentChar))e.push(this.makeNumber());else if(this.currentChar===o[0]&&this.text[this.position.idx+1]===o[1])this.singleLineComment();else if(this.currentChar===s[0]&&this.text[this.position.idx+1]===s[1])this.multiLineComment();else if(i.includes(this.currentChar))e.push(this.makeIdentifier());else if(-1!==l.indexOf(this.currentChar))e.push(this.makeString());else{const t=this.currentChar;let n=this.unknownChar();if(!n){let e=this.position.clone,t=this.currentChar;return this.advance(),new Ne(e,t)}n.type===b.ASSIGN&&(n.value=t),e.push(n)}return e.push(new qe(this.position,b.EOF)),e}makeNumber(){const e=this.position.clone;let t="",n=0;for(;void 0!==this.currentChar&&(r+"._").includes(this.currentChar);){if("."===this.currentChar){if(1===n)break;n++,t+="."}else"_"!==this.currentChar&&(t+=this.currentChar);this.advance()}return new qe(e,b.NUMBER,parseFloat(t))}makeString(){const e=this.position.clone;let t="",n=this.currentChar;for(this.advance();this.currentChar!==n&&void 0!==this.currentChar;)"\\"!==this.currentChar||(this.advance(),"n"!==this.currentChar)?(t+=this.currentChar,this.advance()):(t+="\n",this.advance());return this.advance(),new qe(e,b.STRING,t)}makeIdentifier(){let e="";const t=this.position.clone;for(;void 0!==this.currentChar&&(i+r).includes(this.currentChar);)e+=this.currentChar,this.advance();let n=b.IDENTIFIER;return-1!==p.indexOf(e)&&(n=b.KEYWORD),new qe(t,n,e)}unknownChar(){if(void 0!==this.currentChar){for(let e in S)if(e[0]===this.currentChar&&e[1]===this.text[this.position.idx+1]&&e[2]===this.text[this.position.idx+2]){const t=this.position.clone;return this.advance(),this.advance(),this.advance(),new qe(t,S[e])}for(let e in x)if(e[0]===this.currentChar&&e[1]===this.text[this.position.idx+1]){const t=this.position.clone;return this.advance(),this.advance(),new qe(t,x[e])}if(g.hasOwnProperty(this.currentChar)){let e=this.position.clone,t=g[this.currentChar];return this.advance(),new qe(e,t)}}}singleLineComment(){for(this.advance();"\n"!==this.currentChar&&void 0!==this.currentChar;)this.advance();this.advance()}multiLineComment(){for(this.advance();this.currentChar!==a[0]||this.text[this.position.idx+1]!==a[1];)this.advance();this.advance(),this.advance()}}class ze{constructor(){this.advanceCount=0,this.lastRegisteredAdvanceCount=0,this.reverseCount=0}registerAdvance(){this.advanceCount=1,this.lastRegisteredAdvanceCount++}register(e){return this.lastRegisteredAdvanceCount=e.advanceCount,this.advanceCount+=e.advanceCount,e.error&&(this.error=e.error),e.node?e.node:new Se}tryRegister(e){if(!e.error)return this.register(e);this.reverseCount+=e.advanceCount}success(e){return this.node=e,this}failure(e){return this.error=e,this}}class Ve{constructor(e){this.tokens=e,this.tokenIdx=-1,this.currentToken=e[0],this.advance()}parse(){var e;if(!this.currentToken||!this.tokens||1===this.tokens.length&&this.tokens[0].type===b.EOF)return new ze;const t=this.statements(!0);return t.error||this.currentToken.type===_.EOF?t:t.failure(new Be(null===(e=this.currentToken)||void 0===e?void 0:e.pos,`Expected 'End of File', got token of type'${w[this.currentToken.type]}' of value ${this.currentToken.value}`))}advance(e){return e&&e.registerAdvance(),this.tokenIdx++,this.currentToken=this.tokens[this.tokenIdx],this.currentToken}reverse(e=1){return this.tokenIdx-=e,this.currentToken=this.tokens[this.tokenIdx],this.currentToken}consume(e,t,n){if(this.currentToken.type!==t)return e.failure(new Be(this.currentToken.pos,null!=n?n:`Expected '${w[t]}' but got '${w[this.currentToken.type]}'`));this.advance(e)}clearEndStatements(e){for(;this.currentToken.type===b.ENDSTATEMENT;)this.advance(e)}statements(e=!1){const t=new ze,n=this.currentToken.pos;let r=[];this.clearEndStatements(t);const i=t.register(this.statement());if(!i)return t;if(r.push(i),t.error)return t;let o=!0;for(;;){let e=0;for(;this.currentToken.type===b.ENDSTATEMENT;)this.advance(t),e++;if(0===e&&(o=!1),!o)break;const n=t.tryRegister(this.statement());n?r.push(n):this.reverse(t.reverseCount)}this.clearEndStatements(t);let s=new he(n,r);return e&&(s=new ce(n,r,!0)),t.success(s)}statement(){const e=new ze,t=this.currentToken.pos;if(this.currentToken.matches(b.KEYWORD,"return")){this.advance(e);let n=new Se(this.currentToken.pos);if(this.currentToken.type!==b.ENDSTATEMENT){let t=e.register(this.expr());if(!t)return e.failure(new Be(this.currentToken.pos,"Expected end of statement"));n=t}return e.success(new ve(t,n))}if(this.currentToken.matches(b.KEYWORD,"yield")){this.advance(e);let n=new Se(this.currentToken.pos);if(this.currentToken.type!==b.ENDSTATEMENT){let t=e.register(this.expr());if(!t)return e.failure(new Be(this.currentToken.pos,"Expected end of statement"));n=t}return e.success(new ye(t,n))}if(this.currentToken.matches(b.KEYWORD,"break"))return this.advance(e),e.success(new Te(t));if(this.currentToken.matches(b.KEYWORD,"continue"))return this.advance(e),e.success(new ke(t));const n=e.register(this.expr());return e.error?e:n?e.success(n):e.failure(new Be(t,"No empty statements"))}atom(){const e=new ze,t=this.currentToken,n=this.currentToken.pos;switch(t.type){case b.NUMBER:return this.advance(e),e.success(new we(n,t));case b.STRING:return this.advance(e),e.success(new ge(n,t));case b.IDENTIFIER:return this.atomIdentifier(e,n,t);case b.OPAREN:this.advance(e);const r=e.register(this.expr());return e.error?e:this.currentToken.type==b.CPAREN?(this.advance(e),e.success(r)):e.failure(new Be(this.currentToken.pos,"Expected ')'"));case b.OSQUARE:let i=e.register(this.array());return e.error?e:e.success(i);case b.OBRACES:let o=e.register(this.object());return e.error?e:e.success(o);case b.KEYWORD:if("if"===t.value){const t=e.register(this.ifExpr());return e.error?e:e.success(t)}return e.failure(new Be(this.currentToken.pos,`Invalid Identifier ${t.value}`));default:return e.failure(new Be(this.currentToken.pos,"Expected number, identifier, '(', '+' or '-'"))}}atomIdentifier(e,t,n){this.advance(e);let r=new xe(n),i=new Se(t),o=!1;for(;-1!==[b.OPAREN,b.OSQUARE,b.DOT].indexOf(this.currentToken.type);)switch(this.currentToken.type){case b.OPAREN:o=!0;const t=r;if(r=e.register(this.makeFunctionCall(r,i)),i=t,e.error)return e;break;case b.OSQUARE:if(i=r,r=e.register(this.makeIndex(r)),e.error)return e;break;case b.DOT:if(this.advance(e),this.currentToken.type!==b.IDENTIFIER)return e.failure(new Be(this.currentToken.pos,"Expected identifier after '.'"));i=r,r=new me(this.currentToken.pos,r,new ge(this.currentToken.pos,this.currentToken)),this.advance(e)}if(this.currentToken.type===b.ASSIGN){let n=this.currentToken.value;if(o)return e.failure(new Be(t,"Cannot assign to return value of function"));this.advance(e);const i=e.register(this.expr());if(r instanceof xe)r=new oe(t,r.a,i,n,!1);else{if(!(r instanceof me))return e.failure(new Be(t,`Cannot have node of type ${this.currentToken.constructor.name}.\n                            Expected either index or variable node.`));r.value=i,r.assignType=n}if(e.error)return e}return e.success(r)}power(){return this.binOp((()=>this.atom()),[_.POW],(()=>this.factor()))}factor(){const e=new ze,t=this.currentToken;switch(t.type){case b.SUB:case b.ADD:this.advance(e);const n=e.register(this.factor());return e.error?e:e.success(new ie(t.pos,n,t));default:return this.power()}}term(){return this.binOp((()=>this.factor()),[b.MUL,b.DIV])}arithmeticExpr(){return this.binOp((()=>this.term()),[b.ADD,b.SUB])}comparisonExpr(){const e=new ze;if(this.currentToken.type===b.NOT){const t=this.currentToken;this.advance(e);let n=e.register(this.expr());return e.error?e:e.success(new ie(t.pos,n,t))}let t=e.register(this.binOp((()=>this.arithmeticExpr()),[b.EQUALS,b.NOTEQUALS,b.GT,b.GTE,b.LTE,b.LT]));return e.error?e:e.success(t)}expr(){const e=new ze;if(this.clearEndStatements(e),this.currentToken.type===b.KEYWORD&&-1!==["var","let","global","mutable","const","local"].indexOf(this.currentToken.value))return this.initiateVar(e);if(this.currentToken.matches(_.KEYWORD,"if"))return this.ifExpr();if(this.currentToken.matches(_.KEYWORD,"while"))return this.whileExpr();if(this.currentToken.matches(_.KEYWORD,"for"))return this.forExpr();if(this.currentToken.matches(_.KEYWORD,"func"))return this.funcExpr();if(this.currentToken.matches(_.KEYWORD,"class"))return this.classExpr();if(this.currentToken.matches(_.KEYWORD,"namespace"))return this.namespace();let t=e.register(this.binOp((()=>this.comparisonExpr()),[b.AND,b.OR]));return e.error?e:e.success(t)}binOp(e,t,n=e){const r=new ze;let i=r.register(e());if(r.error)return r;for(;-1!==t.indexOf(this.currentToken.type)||-1!==t.indexOf([this.currentToken.type,this.currentToken.value]);){const e=this.currentToken;this.advance(r);const t=r.register(n());if(r.error)return r;i=new re(i.pos,i,e,t)}return r.success(i)}typeExpr(){const e=new ze;if(this.currentToken.type!==b.IDENTIFIER)return e.failure(new Be(this.currentToken.pos.clone,"Expected an identifier"));let t=this.currentToken;return this.advance(e),e.success(new xe(t))}makeFunctionCall(e,t=new Se){const n=new ze;let r=[];const i=this.currentToken.pos;if(this.currentToken.type!==b.OPAREN)return n.failure(new Be(i,"Expected '['"));if(this.advance(n),this.currentToken.type===b.CPAREN)return this.advance(n),n.success(new de(i,e,[]));if(r.push(n.register(this.expr())),n.error)return n.failure(new Be(this.currentToken.pos,"Invalid argument"));for(;this.currentToken.type===b.COMMA;)if(this.advance(n),r.push(n.register(this.expr())),n.error)return n;return this.currentToken.type!==b.CPAREN?n.failure(new Be(this.currentToken.pos,"Expected ',' or ')'")):(this.advance(n),n.success(new de(i,e,r)))}makeIndex(e){const t=new ze,n=this.currentToken.pos,r=e;if(this.currentToken.type!==b.OSQUARE)return t.failure(new Be(n,"Expected '["));if(this.advance(t),this.currentToken.type===b.CSQUARE)return t.failure(new Be(n,"Cannot index without expression"));let i=t.register(this.expr());return t.error?t.failure(new Be(this.currentToken.pos,"Invalid index")):this.currentToken.type!==b.CSQUARE?t.failure(new Be(this.currentToken.pos,"Expected ']'")):(this.advance(t),t.success(new me(n,r,i)))}initiateVar(e){let t=this.currentToken.pos,n=!1,r=!1,i=!1,o=!1;if(this.currentToken.type===b.KEYWORD&&-1!==["var","let"].indexOf(this.currentToken.value)&&(o=!0,r=!0,this.advance(e),e.error))return e;if(this.currentToken.type===b.KEYWORD&&-1!==["global","local"].indexOf(this.currentToken.value)&&(o=!0,"global"===this.currentToken.value?i=!0:r=!0,this.advance(e),e.error))return e;if(this.currentToken.type===b.KEYWORD&&-1!==["const","mutable"].indexOf(this.currentToken.value)&&(o=!0,"const"===this.currentToken.value&&(n=!0),this.advance(e),e.error))return e;if(this.currentToken.type===b.KEYWORD)return e.failure(new Be(this.currentToken.pos,`Expected Identifier 'var', 'let', 'const', 'mutable', 'local', or 'global', not ${this.currentToken.value}`));if(this.currentToken.type!==_.IDENTIFIER)return e.failure(new Be(this.currentToken.pos,"Expected Identifier or Keyword"));const s=this.currentToken;this.advance(e);let a=k.any;if(this.currentToken.type===b.COLON&&(o=!0,this.consume(e,b.COLON),a=e.register(this.typeExpr())),this.currentToken.type!==b.ASSIGN)return n?e.failure(new Be(t,"Cannot initialise constant to undefined")):e.success(new oe(t,s,new Se(this.currentToken.pos),"=",i,r,n,o,a));let u=this.currentToken.value;this.advance(e);const c=e.register(this.expr());return e.error?e:((c instanceof _e||c instanceof pe)&&(c.name=s.value),c instanceof be&&(c.name=s.value,c.mutable=!n),e.success(new oe(t,s,c,u,i,r,n,o,a)))}bracesExp(){const e=new ze;if(this.consume(e,b.OBRACES),e.error)return e;if(this.clearEndStatements(e),this.currentToken.type===b.CBRACES)return this.advance(e),e.success(new Se(this.currentToken.pos));const t=e.register(this.statements());return e.error?e:(this.consume(e,b.CBRACES),e.error?e:e.success(t))}addEndStatement(e){this.tokens.splice(this.tokenIdx,0,new qe(this.currentToken.pos,b.ENDSTATEMENT)),this.reverse(),this.advance(e)}ifExpr(){const e=new ze;let t,n,r;const i=this.currentToken.pos;if(!this.currentToken.matches(b.KEYWORD,"if"))return e.failure(new Be(this.currentToken.pos,"Expected 'if'"));if(this.advance(e),r=e.register(this.expr()),e.error)return e;if(t=e.register(this.bracesExp()),e.error)return e;if(this.clearEndStatements(e),this.currentToken.matches(b.KEYWORD,"else"))if(this.advance(e),this.currentToken.type==b.OBRACES){if(n=e.register(this.bracesExp()),e.error)return e}else if(n=e.register(this.statement()),e.error)return e;return this.addEndStatement(e),e.success(new se(i,r,t,n))}whileExpr(){const e=new ze;let t,n;const r=this.currentToken.pos;return this.currentToken.matches(b.KEYWORD,"while")?(this.advance(e),n=e.register(this.expr()),e.error?e:(t=e.register(this.bracesExp()),e.error?e:(this.addEndStatement(e),e.success(new ae(r,n,t))))):e.failure(new Be(this.currentToken.pos,"Expected 'while'"))}parameter(e){let t,n=new Ee(k.any);if(this.currentToken.type!==b.IDENTIFIER)return new Be(this.currentToken.pos,"Expected identifier");if(t=this.currentToken.value,this.advance(e),this.currentToken.type===b.COLON){if(this.consume(e,b.COLON),e.error)return e.error;if(n=e.register(this.typeExpr()),e.error)return e.error}return{name:t,type:n}}funcCore(){const e=new ze,t=this.currentToken.pos;let n,r=[],i=new Ee(k.any);if(this.consume(e,b.OPAREN),this.currentToken.type===b.CPAREN)this.advance(e);else{let t=this.parameter(e);if(t instanceof Re)return e.failure(t);for(r.push(t);this.currentToken.type===b.COMMA;){this.advance(e);let t=this.parameter(e);if(t instanceof Re)return e.failure(t);r.push(t)}if(this.currentToken.type!==b.CPAREN)return e.failure(new Be(this.currentToken.pos,"Expected ',' or ')'"));this.advance(e)}if(this.currentToken.type===b.COLON&&(this.advance(e),i=e.register(this.typeExpr()),e.error))return e;if(this.currentToken.type!==b.OBRACES){if(n=new ve(this.currentToken.pos,e.register(this.expr())),e.error)return e}else{if(this.consume(e,b.OBRACES),e.error)return e;if(n=this.currentToken.type!==b.CBRACES?e.register(this.statements()):new Se(this.currentToken.pos),this.consume(e,b.CBRACES),e.error)return e}return e.success(new pe(t,n,r,i))}funcExpr(){const e=new ze;if(!this.currentToken.matches(b.KEYWORD,"func"))return e.failure(new Be(this.currentToken.pos,"Expected 'func'"));this.advance(e);const t=e.register(this.funcCore());return e.error?e:e.success(t)}classExpr(e){const t=new ze,n=this.currentToken.pos,r=[];let i,o;if(!this.currentToken.matches(b.KEYWORD,"class"))return t.failure(new Be(this.currentToken.pos,"Expected 'class'"));if(this.advance(t),this.currentToken.matches(b.KEYWORD,"extends")&&(this.advance(t),o=t.register(this.expr()),t.error))return t;if(this.consume(t,b.OBRACES),t.error)return t;if(this.currentToken.type===b.CBRACES)return this.advance(t),t.success(new _e(n,[],void 0,void 0,e));for(;this.currentToken.type===b.IDENTIFIER;){let e=this.currentToken.value;this.advance(t);const n=t.register(this.funcCore());if(t.error)return t;if(!(n instanceof pe))return t.failure(new Re(this.currentToken.pos,"ParseError",`Tried to get function, but got ${n} instead`));n.name=e,"init"===e?i=n:r.push(n)}return this.consume(t,b.CBRACES),t.success(new _e(n,r,o,i,e))}forExpr(){const e=new ze,t=this.currentToken.pos;let n,r,i,o=!1,s=!1;return this.currentToken.matches(b.KEYWORD,"for")?(this.advance(e),this.currentToken.matches(b.KEYWORD,"global")?(o=!0,this.advance(e)):this.currentToken.matches(b.KEYWORD,"const")?(s=!0,this.advance(e)):(this.currentToken.matches(b.KEYWORD,"var")||this.currentToken.matches(b.KEYWORD,"let"))&&this.advance(e),this.currentToken.type!==b.IDENTIFIER?e.failure(new Be(this.currentToken.pos,"Expected identifier")):(i=this.currentToken,this.advance(e),this.currentToken.matches(b.KEYWORD,"in")?(this.advance(e),r=e.register(this.expr()),e.error?e:(n=e.register(this.bracesExp()),e.error?e:(this.addEndStatement(e),e.success(new ue(t,n,r,i,o,s))))):e.failure(new Be(this.currentToken.pos,"Expected keyword 'in")))):e.failure(new Be(this.currentToken.pos,"Expected 'for'"))}array(){const e=new ze;let t=[];const n=this.currentToken.pos;if(this.currentToken.type!==b.OSQUARE)return e.failure(new Be(n,"Expected '["));if(this.advance(e),this.currentToken.type===b.CSQUARE)return this.advance(e),e.success(new ce(n,[]));if(t.push(e.register(this.expr())),e.error)return e.failure(new Be(this.currentToken.pos,"Expected ']', 'var', 'if', 'for', 'while', number, identifier, '+', '-', '(', '[' or '!' 2"));for(;this.currentToken.type===b.COMMA;)if(this.advance(e),t.push(e.register(this.expr())),e.error)return e;return this.currentToken.type!==b.CSQUARE?e.failure(new Be(this.currentToken.pos,"Expected ',' or ']'")):(this.advance(e),e.success(new ce(n,t)))}object(){const e=new ze;let t=[];const n=this.currentToken.pos;if(this.currentToken.type!==b.OBRACES)return e.failure(new Be(n,"Expected '{"));if(this.advance(e),this.currentToken.type===b.CBRACES)return this.advance(e),e.success(new fe(n));for(;;){let n,r,i;if(this.currentToken.type===b.IDENTIFIER)n="id",r=new ge(this.currentToken.pos,this.currentToken),this.advance(e);else if(this.currentToken.type===b.STRING)n="string",r=new ge(this.currentToken.pos,this.currentToken),this.advance(e);else{if(this.currentToken.type!==b.OSQUARE)break;if(n="value",this.advance(e),r=e.register(this.expr()),e.error)return e;if(this.currentToken.type!==b.CSQUARE)return e.failure(new Be(this.currentToken.pos,`Expected ']', got '${w[this.currentToken.type]}'`));this.advance(e)}if(this.currentToken.type===b.COLON){if(this.advance(e),i=e.register(this.expr()),e.error)return e;if(this.currentToken.type!==b.COMMA&&this.currentToken.type!==b.CBRACES)return e.failure(new Be(this.currentToken.pos,`Expected ',' or '}', got '${w[this.currentToken.type]}'`));this.currentToken.type===b.COMMA&&this.advance(e)}else{if(this.currentToken.type!==b.COMMA&&this.currentToken.type!==b.CBRACES)return e.failure(new Be(this.currentToken.pos,`Expected ',' or '}', got '${w[this.currentToken.type]}'`));if("id"!==n)return e.failure(new Be(this.currentToken.pos,"You must specify a value when initialising an object literal with a key that is not an identifier.\n                        Try using `key: value` syntax."));this.reverse(),i=new xe(this.currentToken),this.advance(e),this.currentToken.type===b.COMMA&&this.advance(e)}if(t.push([r,i]),e.error)return e}return this.currentToken.type!==b.CBRACES?e.failure(new Be(this.currentToken.pos,"Expected identifier, ',' or '}'")):(this.advance(e),e.success(new le(n,t)))}namespace(){const e=new ze,t=this.currentToken.pos;if(this.consume(e,b.KEYWORD),e.error)return e;if(this.consume(e,b.OBRACES),e.error)return e;if(this.currentToken.type===b.CBRACES)return this.advance(e),e.success(new be(t,new Se));const n=e.register(this.statements());return e.error?e:(this.consume(e,b.CBRACES),e.error?e:e.success(new be(t,n)))}}function Ke(e=console.log,t,r=!0,i={print:console.log},o=new Z,s=""){var a,l,f,p;return l=this,void 0,p=function*(){const l=X(o,e,t);if(l instanceof Re)return l;c(o),null!==(a=i.context)&&void 0!==a||(i.context=o),s&&(o.path=s),i.print&&(d.print=i.print),r&&(h(),yield y(!0),function(e,t){const{fs:r,path:i}=e;for(let t in e)e.hasOwnProperty(t)&&(o=t,s=new B(e[t],t),function(e,t){K[e]={},Q[e]=t}(o,Y(G(s),o)));var o,s;t.set("import",new M((({context:e},t)=>{let o=Ce(t);if(H(o))return J(o);if(o=i.join(e.path,o),o in m)return m[o];try{if(!r.existsSync(o)){if(!r.existsSync("./particles/"+o))return new Re(n.unknown,"ImportError",`Can't find file '${o}' to import.`);if(!r.existsSync("particles/"+o+"/main.es"))return new Re(n.unknown,"ImportError",`Module '${o}' has no entry point. Requires 'main.es'.`);o="particles/"+o+"/main.es"}const e=i.dirname(o),t=r.readFileSync(o,"utf-8"),s=new Z;s.parent=u,s.path=e;const a=new N(new L(o),{});m[o]=a;const c=Qe(t,{env:s,measurePerformance:!1,fileName:o,currentDir:e});return a.__value__=s.getSymbolTableAsDict(),c.error?c.error:a}catch(e){return new Re(n.unknown,"ImportError",e.toString())}}),[{name:"path",type:k.string}],"import",void 0,k.object),{forceThroughConst:!0,isConstant:!0}),t.setOwn("open",new M((({context:e},t,i)=>{const o=Ce(t),s=Ce(i)||"utf-8";return r.existsSync(o)?new R({str:new M((({context:e})=>new L(r.readFileSync(e.path+o,s))),[],"str",void 0,k.string),write:new M((({context:e},t)=>{r.writeFileSync(e.path+o,Ce(t))}),[{name:"path",type:k.string}]),append:new M((({context:e},t)=>{r.appendFileSync(e.path+o,Ce(t))}),[{name:"path",type:k.string}])}):new $e(n.unknown,o)})))}(i,o))},new((f=void 0)||(f=Promise))((function(e,t){function n(e){try{i(p.next(e))}catch(e){t(e)}}function r(e){try{i(p.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof f?i:new f((function(e){e(i)}))).then(n,r)}i((p=p.apply(l,[])).next())}))}function Qe(e,{env:t=u,measurePerformance:r=!1,fileName:i="(unknown)",currentDir:o=""}={}){o&&(t.path=o),ne.maxTime=0,ne.totalTime=0,ne.interprets=0;const s={total:0,lexerTotal:0,parserTotal:0,interpretTotal:0,nodeMax:0,nodeAvg:0,nodeTotal:0,interprets:0};let a=v();if(!t.root.initialisedAsGlobal){const e=new te;return e.error=new Re(n.unknown,"Uninitialised","Global context has not been initialised with global values"),e}const c=new Fe(e,i).generate();if(c instanceof Re){const e=new te;return e.error=c,e}s.lexerTotal=v()-a,a=v();const l=new Ve(c).parse();if(l.error){const e=new te;return e.error=l.error,e}if(s.parserTotal=v()-a,a=v(),!l.node){const e=new te;return e.val=new U([]),e}const f=l.node.interpret(t);return s.interpretTotal=v()-a,s.total=v()-a,s.nodeMax=ne.maxTime,s.nodeTotal=ne.totalTime,s.nodeAvg=ne.totalTime/ne.interprets,s.interprets=ne.interprets,r&&console.log(s),Object.assign(Object.assign({},f),{timeData:s})}return t})()},637:(e,t,n)=>{"use strict";n.d(t,{a:()=>s});var r=n(838),i=n(23),o=n(359),s=function(e,t){var n,s;if(!i.SB.selectedEntity)throw"no selected entity";var a=e.subtype||e.type;t.append('\n            <div id="component-'.concat(a,'">\n                <p class="subheader" id="component-').concat(a,'-title" style="\n                    background: vaR(--input-opposite-bg);\n                    margin-top: 10px;\n                    border-top: 1px solid vaR(--text-colour);\n                    padding: 2px 0;\n                ">\n                    ').concat(a,"\n                </p>\n            </div>\n        ")),"Transform"!==a&&(0,r.Az)("component-".concat(a,"-title"),i.SB.selectedEntity,"\n             ".concat((0,r.I3)("remove-".concat(a),(function(){var t,n,o=null===(t=i.SB.selectedEntity)||void 0===t?void 0:t.components.indexOf(e);-1!==o&&null!=o?(null===(n=i.SB.selectedEntity)||void 0===n||delete n.components.splice(o,1)[0],(0,r.B)()):console.error("No component found to delete: "+e)}),"remove"),"\n\t\t"));var u=$("#component-".concat(a)),c=0;try{for(var l=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e.public),f=l.next();!f.done;f=l.next()){var h=f.value,d=e.type;"Script"===d&&(d=e.name||e.subtype),u.append('\n                <div style="border-bottom: 1px solid vaR(--input-bg); margin-bottom: 4px">\n                    '.concat((0,o.l)(h,"value",d,["public",c],h.name,h.type),"\n                </div>\n            ")),c++}}catch(e){n={error:e}}finally{try{f&&!f.done&&(s=l.return)&&s.call(l)}finally{if(n)throw n.error}}}},359:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{l:()=>_componentProperty_});var _renderer__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(838),_state__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(23),entropy_engine__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(216),__values=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},__spreadArray=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};function _colour_(e,t,n){return'\n\t\t<input \n\t\t\ttype="color" \n\t\t\tid="'.concat(e,'" \n\t\t\tvalue="').concat(t.hex,'" \n\t\t\tonchange="window.onPropertyChange(\'').concat(e,"', '").concat(n,"', ['colour'])\"\n\t\t>\n\t")}function _transform_(e,t,n,r,i,o){var s,a;void 0===o&&(o=!1);var u='\n\t\t<select\n\t\t\tid="'.concat(e,'"\n\t\t\tonchange="\n\t\t\t').concat(r.includes("parent")?"\n\t\t\t\twindow.onPropertyChange(\n\t\t\t\t\t'".concat(e,"',\n\t\t\t\t\t'").concat(n,"',\n\t\t\t\t\t[").concat(r," '").concat(i,"'],\n\t\t\t\t\twindow.findNodeWithName\n\t\t\t\t)"):"\n\t\t\t\t\twindow.setParent('".concat(e,"')\n\t\t\t\t"),'\n\t\t\t"\n\t\t>\n\t\t\n\t\t<option value="">\n\t\t\tNone\n\t\t</option>\n\t'),c=!1;try{for(var l=__values(entropy_engine__WEBPACK_IMPORTED_MODULE_2__.Scene.activeScene.entities),f=l.next();!f.done;f=l.next()){var h=f.value;if(o||!Object.is(h,_state__WEBPACK_IMPORTED_MODULE_1__.SB.selectedEntity)){var d=Object.is(t,h.transform);c||(c=d),u+='\n\t\t\t<option value="'.concat(h.name,'" ').concat(d?"selected":"",">").concat(h.name,"</option>\n\t\t")}}}catch(e){s={error:e}}finally{try{f&&!f.done&&(a=l.return)&&a.call(l)}finally{if(s)throw s.error}}return u+"\n\t\t<selection>\n\t"}function _array_(id,value,type){void 0===type&&(type=typeof value[0]),window["addElement".concat(id)]=function(){var defaultValue;switch(type){case"number":defaultValue=0;break;case"boolean":defaultValue=!1;break;case"object":defaultValue=new(eval(value[0].constructor.name));break;default:defaultValue=Array.isArray(value[0])?[]:""}value.push(defaultValue),(0,_renderer__WEBPACK_IMPORTED_MODULE_0__.B)()},window["removeElement".concat(id)]=function(){var e=$("removeElementIndex".concat(id)).val();if(!e)throw"no index to splice at";value.splice(parseInt(e.toString()),1),(0,_renderer__WEBPACK_IMPORTED_MODULE_0__.B)()};for(var showValue='<div id="'.concat(id,'" class="array">(').concat(value.length,")"),i=0;i<value.length;i++)showValue="".concat(showValue," <div>").concat(_componentProperty_(value,i.toString(),i.toString()),"</div>");return showValue+="\n\t\t</div>\n\t\t<button onclick=\"window['addElement".concat(id,'\']()" class="empty-button" style="width: 20px; height: 20px">+</button>\n\t\t<span style="border: 1px solid #b1b1b1; border-radius: 3px; height: 24px">\n\t\t\t<input id="removeElementIndex').concat(id,'" type="number">\n\t\t\t<button onclick="window[\'removeElement').concat(id,'\']()" class="empty-button" style="width: 20px; height: 20px">-</button>\n\t\t</span>\n\t'),showValue}var _componentProperty_=function(e,t,n,r,i,o){var s,a;void 0===r&&(r=[]),void 0===i&&(i=t),void 0===o&&(o=null);var u="",c=e[t];o||(o=typeof c);var l=e.description||"",f=e.default||"";"object"==typeof e.default&&(f=JSON.stringify(e.default));var h=!!f&&c!==f;(e.default instanceof entropy_engine__WEBPACK_IMPORTED_MODULE_2__.v2||e.default instanceof entropy_engine__WEBPACK_IMPORTED_MODULE_2__.v3)&&(f=e.default.str,h=!e.default.equals(c));var d="input-".concat(t,"-").concat(n,"-").concat(r.join("-")),p="";try{for(var v=__values(r),y=v.next();!y.done;y=v.next()){var m=y.value;p+="'".concat(m,"', ")}}catch(e){s={error:e}}finally{try{y&&!y.done&&(a=v.return)&&a.call(v)}finally{if(s)throw s.error}}switch(o){case"rgb":u=_colour_(d,c,n);break;case"number":case"string":var _="number"==typeof c;u='\n                    <input \n                        type="'.concat(_?"number":"text",'"\n                        id="').concat(d,'" value="').concat(c,'"\n                        onchange="window.onPropertyChange(\'').concat(d,"', '").concat(n,"', [").concat(p," '").concat(t,"'] ").concat(_?", parseFloat":"",')"\n                    >\n                ');break;case"boolean":u='\n                    <input \n                        type="checkbox"\n                        id="'.concat(d,'" ').concat(c?"checked":""," \n                        onchange=\"window.onPropertyChange('").concat(d,"', '").concat(n,"', [").concat(p," '").concat(t,"'], window.parseBool)\"\n                        \n                    >\n                ");break;case"v2":case"v3":u+='\n                    <div style="display: flex; justify-content: space-evenly; transform: scale(0.9)">\n                ',u+=_componentProperty_(c,"x",n,__spreadArray(__spreadArray([],__read(r),!1),[t],!1)),u+=_componentProperty_(c,"y",n,__spreadArray(__spreadArray([],__read(r),!1),[t],!1)),"v3"===o&&(u+=_componentProperty_(c,"z",n,__spreadArray(__spreadArray([],__read(r),!1),[t],!1))),u+="</div>";break;case"Transform":u=_transform_(d,c,n,p,t);break;case"object":case"json":if(Array.isArray(c)){u=_array_(d,c);break}for(var m in c)u+=_componentProperty_(c,m,n,__spreadArray(__spreadArray([],__read(r),!1),[t],!1));break;default:u="That type ('".concat(o,"') is not supported in the editor")}return'\n\n\t\t<div style="\n\t\t\tmargin-left: 2px;\n\t\t\tdisplay: grid;\n\t\t\tpadding-bottom: 3px;\n\t\t">\n\t\t\t<span style="grid-column: 1/1; font-size: 14px" class="tooltip-container">\n\t\t\t\t'.concat(i,"\n\t\t\t\t\n\t\t\t\t").concat(l||h?'\n\t\t\t\t\t<span class="tooltip-fleeting">\n\t\t\t\t\t\t'.concat(l||"","\n\t\t\t\t\t\t").concat(h?"Default: ".concat(f):"","\n\t\t\t\t\t</span>\n\t\t\t\t"):"",'\n\t\t\t</span> \n\t\t\t<span style="grid-column: 2/2; text-align: right; padding-right: 2px" >\n\t\t\t\t').concat(u,"\n\t\t\t</span>\n\t\t</div>\n\n\t")}},958:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{w:()=>reRenderInspector});var _state__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(23),_renderer__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(838),_scripts__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(955),_property__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(359),_component__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(637),entropy_engine__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(216),__awaiter=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},__generator=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},__read=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},__spreadArray=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},__values=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};entropy_engine__WEBPACK_IMPORTED_MODULE_5__.Script;var allComponents={General:[entropy_engine__WEBPACK_IMPORTED_MODULE_5__.Camera],Physics:[entropy_engine__WEBPACK_IMPORTED_MODULE_5__.Body,entropy_engine__WEBPACK_IMPORTED_MODULE_5__.CircleCollider,entropy_engine__WEBPACK_IMPORTED_MODULE_5__.RectCollider],GUI:[entropy_engine__WEBPACK_IMPORTED_MODULE_5__.GUIBox,entropy_engine__WEBPACK_IMPORTED_MODULE_5__.GUIText,entropy_engine__WEBPACK_IMPORTED_MODULE_5__.GUITextBox,entropy_engine__WEBPACK_IMPORTED_MODULE_5__.GUIRect,entropy_engine__WEBPACK_IMPORTED_MODULE_5__.GUICircle,entropy_engine__WEBPACK_IMPORTED_MODULE_5__.GUIPolygon,entropy_engine__WEBPACK_IMPORTED_MODULE_5__.GUIImage],Renderers:[entropy_engine__WEBPACK_IMPORTED_MODULE_5__.CircleRenderer,entropy_engine__WEBPACK_IMPORTED_MODULE_5__.RectRenderer,entropy_engine__WEBPACK_IMPORTED_MODULE_5__.ImageRenderer2D],Scripts:[]};function reRenderInspector(){var e_1,_a,_this=this,i=$("#inspector");if(_state__WEBPACK_IMPORTED_MODULE_0__.SB.selectedEntity){for(var p in i.html('\n        <div class="center" style="margin-bottom: 5px">\n        \x3c!--  do the name completely seperately --\x3e\n            <input\n                type="text" \n                id="input-name" \n                value="'.concat(_state__WEBPACK_IMPORTED_MODULE_0__.SB.selectedEntity.name,"\" \n                onchange=\"window.onPropertyChange('input-name', 'nocomponent', ['name'])\" \n                style=\"\n                    font-size: 20px;\n                    text-align: center;\n                    padding: 8px 2px;\n                \"\n            >\n        </div>\n    ")),_state__WEBPACK_IMPORTED_MODULE_0__.SB.selectedEntity)_state__WEBPACK_IMPORTED_MODULE_0__.SB.selectedEntity.hasOwnProperty(p)&&["tag","Static"].includes(p)&&i.append((0,_property__WEBPACK_IMPORTED_MODULE_3__.l)(_state__WEBPACK_IMPORTED_MODULE_0__.SB.selectedEntity,p,"nocomponent"));try{for(var _b=__values(__spreadArray([_state__WEBPACK_IMPORTED_MODULE_0__.SB.selectedEntity.transform],__read(_state__WEBPACK_IMPORTED_MODULE_0__.SB.selectedEntity.components),!1)),_c=_b.next();!_c.done;_c=_b.next()){var c=_c.value;(0,_component__WEBPACK_IMPORTED_MODULE_4__.a)(c,i)}}catch(e){e_1={error:e}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error}}i.append('\n        <div id="add-component-wrapper">\n            <div class="center">           \n                <button id="add-component" class="button">\n                    New Component\n                </button>\n            </div>\n        </div>\n    '),$("#add-component").click((function(){if(!$(".add-component-popup").length){window.addComponent=function(type){var _a,_b;try{null===(_a=_state__WEBPACK_IMPORTED_MODULE_0__.SB.selectedEntity)||void 0===_a||_a.addComponent(new(eval(type))({}))}catch(e){var component=new entropy_engine__WEBPACK_IMPORTED_MODULE_5__.Script({path:type});if(!(null===(_b=_state__WEBPACK_IMPORTED_MODULE_0__.SB.selectedEntity)||void 0===_b?void 0:_b.addComponent(component)))return;component.name=type,(0,_scripts__WEBPACK_IMPORTED_MODULE_2__.oI)().then((function(){return __awaiter(_this,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,window.backgroundSave()];case 1:return e.sent(),window.location.reload(),[2]}}))}))}))}(0,_renderer__WEBPACK_IMPORTED_MODULE_1__.B)()};var _button_=function(e){return"\n            <div>\n                <button class='empty-button' onclick=\"window.addComponent(`".concat(e,'`)">\n                    ').concat(e,"\n                </button>\n            </div>\n        ")};setTimeout((function(){$("#add-component-wrapper").append('\n            <div style="width: 100%; display: flex; justify-content: center">\n                <div class="add-component-popup">\n                    '.concat(components(),"\n                </div>\n            </div>\n\n            "));var e=document.getElementById("inspector");if(!e)throw"expected inspector";e.scrollTop=e.scrollHeight}),5)}function components(){var e,t,n="";for(var r in allComponents)if(n+='\n                    <button\n                        class="empty-button" \n                        style="background-color: vaR(--input-opposite-bg)"\n                    >\n                       '.concat(r,"\n                    </button>\n                "),"Scripts"!==r)try{for(var i=(e=void 0,__values(allComponents[r])),o=i.next();!o.done;o=i.next()){var s=new(0,o.value)({});n+=_button_(s.constructor.name)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}else for(var a in _state__WEBPACK_IMPORTED_MODULE_0__.v1)n+=_button_("".concat(a));return n}}))}else i.html('\n\n        <p style="text-align: center">\n            No sprite selected\n        </p>\n        \n        ')}},838:(e,t,n)=>{"use strict";n.d(t,{B:()=>V,GD:()=>A,a6:()=>I,g5:()=>z,I3:()=>P,Az:()=>C});var r=n(23),i=n(216),o=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},s=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},a=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},u=function(e,t){return'\n    <div style="margin: 0; padding: 0" id="entity'.concat(e.id,'">\n        <button\n            class="empty-button"\n            style="\n                background-color: ').concat(t?"var(--input-bg)":"var(--input-opposite-bg)",';\n                border-bottom: 2px solid vaR(--bg);\n            "\n            id="entitybutton').concat(e.id,'"\n        >\n            ').concat(e.name,'\n        </button>\n        <div id="childrenOf').concat(e.id,'" style="padding-left: 20px">\n            ').concat(e.transform.children.map((function(e){return u(e,Object.is(r.SB.selectedEntity,e))})).join(""),"\n        </div>\n    </div>\n")},c=$("#hierarchy"),l=$("#scene-select"),f=$("#add-scene"),h=$("#rename-scene"),d=$("#rename-scene-to");var p=n(958),v=n(955),y=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},m=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},_=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},b=$("#world-space-pos"),w=$("#screen-space-pos"),g=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},x=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};function S(e){var t=this;function n(e){return g(this,void 0,void 0,(function(){var t,r,i,o,s,a,u,c,l=this;return x(this,(function(f){switch(f.label){case 0:return[4,window.request("get-comments",{public:!1})];case 1:if(t=f.sent(),$("#num-comments").html(t.length),!t)return[2];(r=$("#the-comments")).html(""),i=function(t){var i,o,s,a=(i=t,void 0===(o=t.username===e)&&(o=!1),void 0===s&&(s=!0),'\n\t\n\t<div id="comment-'.concat(i._id,'-menu" style="\n\t\twidth: 160px;\n\t\tbackground-color: rgba(180, 180, 180, 0.8);\n\t\ttext-align: center;\n\t\tborder-radius: 6px;\n\t\tpadding: 8px 0;\n\t\tposition: absolute;\n\t\tz-index: 1;\n\t\tdisplay: none;\n\t">\n\t\t').concat(o?'\n\t\t<button id="delete-comment-'.concat(i._id,'" style="padding: 0; width: 100%; background-color: transparent">\n\t\t\tDelete 🗑️\n\t\t</button><br>\n\t\t'):"",'\n\t\t<a href="https://entropyengine.dev/report?type=comment&id=').concat(i._id,'" style="padding: 0; width: 100%; background-color: transparent">\n\t\t\tReport ⚠️\n\t\t</a>\n\t</div>\n\t\n\t<div id="comment-').concat(i._id,'" style="\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tborder-bottom: 1px solid vaR(--input-bg);\n\t">\n\t\t<p style="margin: 8px">\n\t\t\t').concat(i.content,'\n\t\t</p>\n\t\t<aside style="min-width: 200px; margin-left: 20px">\n\t\t\t<span style="margin-right: 10px">').concat(i.username,"</span>\n\t\t\t<span>\n\t\t\t\t").concat(window.secondsToReadable(Math.round((new Date).getTime()/1e3)-i.date)," ago\n\t\t\t</span>\n\t\t\t\n\t\t\t").concat(s?'\n\t\t\t<button id="comment-'.concat(i._id,'-menu-toggle" style="\n\t\t\t\tposition: relative;\n\t\t\t\tdisplay: inline-block;\n\t\t\t\tcursor: pointer;\n\t\t\t\tbackground: url(https://entropyengine.dev/svg/menu-dots.svg) no-repeat center center;\n\t\t\t\tbackground-size: contain;\n\t\t\t\twidth: 20px; height: 15px;\n\t\t\t">\n\t\t\t'):"","\n\t\t\t</button>\n\t\t</aside>\n\t</div>\n\n\t").concat(s?"\n\t<script>\n\t(function () {\n\t\tconst menu = $('#comment-".concat(i._id,"-menu');\n\t\tconst menuButton = $('#comment-").concat(i._id,"-menu-toggle');\n\t\tconst both = $('#comment-").concat(i._id,"-menu, #comment-").concat(i._id,"-menu-toggle');\n\t\n\t\t$(document).on('click', clickPosition => {\n\t\t\tif (!both.is(clickPosition.target) && menu.has(clickPosition.target).length === 0){\n\t\t\t\tmenu.hide();\n\t\t\t} else {\n\t\t\t\tif (menuButton.is(clickPosition.target) && menu.css('display') !== 'none') {\n\t\t\t\t\tmenu.hide();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (!menu.is(clickPosition.target)){\n\t\t\t\t\tmenu.css({\n\t\t\t\t\t\t'top': clickPosition.pageY,\n\t\t\t\t\t\t'left': clickPosition.pageX - 150\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\n\t\t\t\tmenu.show();\n\t\t\t}\n\t\t});\n\t\n\t})();\n\t<\/script>\n\t"):"","\n\n"));if(r.append(a),t.username!==e)return"continue";$("#delete-comment-".concat(t._id)).click((function(){return g(l,void 0,void 0,(function(){return x(this,(function(r){switch(r.label){case 0:return $("#comment-".concat(t._id,"-menu")).hide(),$("#comment-".concat(t._id)).hide(),[4,window.request("delete-comment",{commentID:t._id})];case 1:return r.sent(),[4,n(e)];case 2:return r.sent(),[2]}}))}))}))};try{for(o=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),s=o.next();!s.done;s=o.next())a=s.value,i(a)}catch(e){u={error:e}}finally{try{s&&!s.done&&(c=o.return)&&c.call(o)}finally{if(u)throw u.error}}return[2]}}))}))}e.html('\n\t\t<p>\n\t\t\tOnly editors for this project can see this. \n\t\t\t<a href="https://entropyengine.dev/play?p='.concat(projectID,'">Public Comments</a>\n\t\t</p>\n\t\t\n\t\t<p style="margin: 10px 0 50px 100px; font-size: 20px">\n\t\t\t<span id="num-comments"></span> Private Comments\n\t\t</p>\n\t\t\n\t\t<div id="add-comment-container">\n\t\t\t<label>\n\t\t\t\t<input\n\t\t\t\t\ttype="text"\n\t\t\t\t\tid="add-comment"\n\t\t\t\t\tplaceholder="Add a private comment..."\n\t\t\t\t\tmaxlength = "500"\n\t\t\t\t/>\n\t\t\t</label>\n\t\t</div>\n\t\t<div id="the-comments"></div>\n\t\t<footer style="height: 100px"></footer>\n\t'));var r=$("#add-comment");window.request("get-username").then((function(e){return g(t,void 0,void 0,(function(){var t=this;return x(this,(function(i){switch(i.label){case 0:return r.keyup((function(i){return g(t,void 0,void 0,(function(){var t;return x(this,(function(o){switch(o.label){case 0:return 13!==i.keyCode?[2]:(t=r.val(),r.val(""),[4,window.request("comment",{content:t,public:!1})]);case 1:return o.sent(),[4,n(e.username)];case 2:return o.sent(),[2]}}))}))})),[4,n(e.username)];case 1:return i.sent(),[2]}}))}))}))}function T(e,t,n,r){return'\n\t\t<input \n\t\t\ttype="'.concat(r?"number":"text",'"\n\t\t\tid="').concat(n,'"\n\t\t\tvalue="').concat(t,'"\n\t\t\tonchange="window.changeSceneSettings(\'').concat(e,"', '").concat(n,"')\"\n\t\t>\n\t")}function k(e){var t=e.settings,n=e.key,r=e.showName,i=void 0===r?n:r,o=e.type,s=void 0===o?typeof t[n]:o,a="input-".concat(n,"-").concat(i),u="\n\t\t<div>\n\t\t\t".concat(i,": \n\t");switch(s){case"number":u+=T(n,t[n],a,!0);break;case"string":u+=T(n,t[n],a,!1)}return u+"</div>"}window.changeSceneSettings=function(e,t){var n=$("#".concat(t)).val();i.Scene.activeScene.settings[e]=n};var E={license:"License",version:"Version",gameName:"Game Name",maxFrameRate:"Max Frame Rate",timeScale:"Time Scale",background:"Background",globalGravity:"Gravity",collisionIterations:"Collision Accuracy",globalVolume:"Sound Volume Multiplier"},O=["ctx","canvasID"];function C(e,t,n){var i;null===(i=document.getElementById(e))||void 0===i||i.addEventListener("contextmenu",(function(e){(0,r.Pq)(t),V(),function(e,t){setTimeout((function(){var n=$("#pop-up");n.css("visibility","visible"),n.css("top","".concat(e.clientY,"px")),n.css("left","".concat(e.clientX,"px")),$("#pop-up-content").html(t)}),0)}(e,n),e.preventDefault()}),!1)}function P(e,t,n){return void 0===n&&(n=e),window["rightclick-".concat(e)]=t,'\n        <div>\n            <button \n                class="empty-button" \n                onclick="window[\'rightclick-'.concat(e,'\']()"\n                style="\n                    border-radius: 5px;\n                    width: 100%;\n                    background-color: vaR(--transparent);\n                "\n            >\n                ').concat(n,"\n            </button>\n        </div>\n    ")}function A(){var e;null===(e=i.Systems.getByName("Renderer"))||void 0===e||e.Update(i.Scene.activeScene)}function I(){if(!r.Xl)throw"no ctx";if(!r.SB.sceneCamera)throw"no camera";(0,i.renderDebug)(r.JQ,r.Xl,r.SB.sceneCamera,i.Scene.activeScene.entities),r.SB.selectedEntity&&((0,i.renderSelectedOutline)(r.JQ,r.Xl,r.SB.sceneCamera,r.SB.selectedEntity),r.SB.selectedEntity.hasComponent("Camera")&&(0,i.drawCameraViewArea)(r.Xl,r.JQ,r.SB.sceneCamera,r.SB.selectedEntity,"rgb(255, 0, 0)"))}var R=$("#canvas"),N=$("#scene-toolbar"),B=$("#scripts"),M=$("#assets"),D=$("#scene-settings"),U=$("#comments"),L=$("#go-to-scripts-button"),j=$("#go-to-scene-button"),G=$("#go-to-game-button"),W=$("#go-to-assets-button"),q=$("#go-to-scene-settings-button"),F=$("#go-to-comments-button");function z(){!function(e){var t,n;if(!r.SB.sceneCamera)throw"no camera";var o=null!==(t=r.SB.sceneCamera.getComponent("Camera").zoom.toFixed(2))&&void 0!==t?t:"N/A",s=null!==(n=r.SB.sceneCamera.transform.position)&&void 0!==n?n:i.v3.zero,a=b.text()||"0, 0",u=w.text()||"0, 0";e.html('\n\t\t<style>\n\t\t\t.scene-toolbar-info {\n\t\t\t\tbackground-color: vaR(--input-bg); \n\t\t\t\tborder-radius: 5px;\n\t\t\t\tmargin: 4px;\n\t\t\t\tpadding: 3px;\n\t\t\t}\n\t\t</style>\n\t\t<div>\n\t\t\tWorld Space:\n\t\t\t<span id="world-space-pos" class="scene-toolbar-info">\n\t\t\t \t'.concat(a,'\n\t\t\t</span>\n\t\t</div>\n\t\t\n\t\t<div>\n\t\t\tScreen Space:\n\t\t\t<span id="screen-space-pos" class="scene-toolbar-info">\n\t\t\t \t').concat(u,'\n\t\t\t</span>\n\t\t</div>\n\t\t\t\n\t\t<div>\n\t\t\tZoom:\n\t\t\t<span id="scene-camera-zoom" class="scene-toolbar-info">\n\t\t\t\t').concat(o,'\n\t\t\t</span>\n\t\t</div>\n\t\t\n\t\t<div>\n\t\t\tCamera Pos:\n\t\t\t<span id="scene-camera-pos" class="scene-toolbar-info">\n\t\t\t\t').concat(s.x.toFixed(2)," | ").concat(s.y.toFixed(2)," | ").concat(s.z.toFixed(2),"\n\t\t\t</span>\n\t\t</div>\n\t"))}(N)}function V(){if(!r.Xl)throw"no ctx";function e(e,t){e.hover((function(){e.css("background-color","var(--input-hover-bg)")}),(function(){e.css("background-color","var(--input-opposite-bg)")})),e.css("background-color","var(--input-opposite-bg)"),e.css("border-bottom","none"),t.css("display","none")}function t(e,t,n){void 0===n&&(n=!1),e.hover((function(){e.css("background-color","var(--input-hover-bg)")}),(function(){e.css("background-color","var(--input-bg)")})),e.css("background-color","var(--input-bg)"),e.css("border-bottom","3px sold blue"),t.css("display",n?"inline":"flex")}switch(N.css("height","0"),r.SB.window!==r.$q.sceneView&&N.html(""),r.SB.window){case r.$q.sceneView:if(e(L,B),e(G,R),t(j,R,!0),e(W,M),e(q,D),e(F,U),!r.SB.sceneCamera)throw"no scene camera";i.Camera.main=r.SB.sceneCamera,A(),I(),z(),N.css("height","30px");break;case r.$q.scriptEditor:e(j,R),t(L,B),e(G,R),e(W,M),e(q,D),e(F,U),(0,i.rect)(r.Xl,i.v2.zero,r.JQ.width,r.JQ.height,"rgb(255, 255, 255)",0),$("#".concat("scripts")).html('\n        <div style="width: 100%; height: 100%;">\n            \x3c!-- all scripts --\x3e\n            <div id="scripts-container">\n                '.concat((0,v.Oq)((function(e,t){return"\n                    <button \n                        onclick=\"window.switchScripts('".concat(e,'\')" \n                        style="\n                            border: none;\n                            outline: none;\n                            padding: 4px;\n                            background-color: ').concat(e===r.SB.currentScript?"var(--input-bg)":"var(--input-opposite-bg)",'\n                        "\n                        onMouseOver="this.style.backgroundColor=\'var(--input-hover-bg)\'"\n                        onMouseOut="this.style.backgroundColor=\'').concat(e===r.SB.currentScript?"var(--input-bg)":"var(--input-opposite-bg)","'\"\n                    >\n                        ").concat(e,".es\n                    </button>\n                ")})).join(""),'\n                \x3c!-- for the spacing --\x3e\n                <span class="even-space-stretch"></span>\n            </div>\n            \x3c!-- new scripts --\x3e\n            <input type="text" id="new-script-name" style="margin-right: 0" placeholder="new script name">\n            <button onclick="window.blankScript(\'new-script-name\')" class="short-button">+</button>\n\n            \n            <div id="script-editor" style="height: calc(100vh - 190px);"></div>\n        </div>\n    ')),Object.keys(r.v1).length<1||r.SB.currentScript&&($("#script-editor").html('\n        <textarea id="script-code">'.concat(null!==(b=r.v1[r.SB.currentScript])&&void 0!==b?b:"","</textarea>\n    ")),$("#script-code").keyup((function(){var e,t=null===(e=$("#script-code").val())||void 0===e?void 0:e.toString();if(!t&&""!==t)throw"no code found...";r.v1[r.SB.currentScript]=t})));break;case r.$q.gameView:i.Scene.activeScene.findMainCamera(),e(j,R),e(L,B),t(G,R,!0),e(W,M),e(q,D),e(F,U),A();break;case r.$q.assets:e(j,R),e(L,B),e(G,R),t(W,M,!0),e(q,D),e(F,U),n=M,y(void 0,void 0,void 0,(function(){var e,t,o,s,a,u,c,l,f,h,d,p,v;return m(this,(function(b){switch(b.label){case 0:if(!r.SB.selectedEntity)throw"expected a selected entity";return[4,window.request("get-assets",window.apiToken)];case 1:e=b.sent(),t="";try{for(o=_(e),s=o.next();!s.done;s=o.next())f=s.value,t+=(w=f.fileName,'\n\n\t<div id="asset'.concat(w,'" class="asset-container">\n\t\t<div style="\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: center;\n\t\t\talign-items: center;\n\t\t\twidth: 150px; height: 150px;\n\t\t">\n\t\t\t<div class="asset-image-container">\n\t\t\t\t<div style="\n\t\t\t\t\tbackground: url(../projects/').concat(r.Yu,"/assets/").concat(w,') no-repeat center center;\n\t\t\t\t\t" class="asset-image">\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t</div>\n\t\t<p style="font-size: 20px; text-align: center; margin: 5px 0">\n\t\t\t').concat((0,i.cullString)(w,10),"\n\t\t</p>\n\n\t</div>\n\n"))}catch(e){h={error:e}}finally{try{s&&!s.done&&(d=o.return)&&d.call(o)}finally{if(h)throw h.error}}return[4,window.request("folder-size",{path:"../projects/".concat(r.Yu,"/")})];case 2:a=b.sent(),n.html("\n\t\t<div>\n\t\t\tUsed ".concat(a.mb.toFixed(1),' / 1000 MB\n\t\t\t<form \n\t\t\t\taction="https://entropyengine.dev:50001/upload/').concat(r.Yu,'/assets/"\n\t\t\t\tmethod="post"\n\t\t\t\tenctype="multipart/form-data"\n\t\t\t\tstyle="\n\t\t\t\t\tborder-radius: 10px;\n\t\t\t\t\tborder: 1px solid var(--text-colour);\n\t\t\t\t\tpadding: 10px;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t"\n\t\t\t>\n\t\t\t\tImport Assets: <br>\n\t\t\t\t<input type="file" name="filetoupload" id="fileToUpload"><br>\n\t\t\t\t<input \n\t\t\t\t\ttype="submit" \n\t\t\t\t\tvalue="Upload"\n\t\t\t\t\tname="submit"\n\t\t\t\t\tclass="button"  \n\t\t\t\t\tid="upload-button" \n\t\t\t\t\tstyle="width: 30%"\n\t\t\t\t>\n\t\t\t</form>\n\t\t</div>\n\t\t<div style="\n\t\t\toverflow-y: scroll;\n\t\t\tdisplay: grid;\n\t\t\tgrid-auto-rows: auto;\n\t\t\tgrid-gap: 1rem;\n\t\t\tgrid-template-columns: repeat(auto-fill, 170px);\n\t\t\theight: 100%;\n\t\t">\n\t\t\t').concat(t,"\n\t\t</div>\n\t")),u=function(e){var t=e.fileName;C("asset".concat(t),r.SB.selectedEntity,"\n\t\t\t".concat(P("delete_asset_".concat(t),(function(){return y(void 0,void 0,void 0,(function(){return m(this,(function(e){switch(e.label){case 0:return[4,window.request("delete-asset",{fileName:t})];case 1:return e.sent(),V(),[2]}}))}))}),"delete")))};try{for(c=_(e),l=c.next();!l.done;l=c.next())f=l.value,u(f)}catch(e){p={error:e}}finally{try{l&&!l.done&&(v=c.return)&&v.call(c)}finally{if(p)throw p.error}}return[2]}var w}))}));break;case r.$q.comments:e(j,R),e(L,B),e(G,R),e(W,M),e(q,D),t(F,U,!0),S(U);break;case r.$q.sceneSettings:e(j,R),e(L,B),e(G,R),e(W,M),t(q,D,!0),e(F,U),function(e){var t=i.Scene.activeScene.settings;for(var n in e.html(""),t)O.includes(n)||e.append(k({settings:t,key:n,showName:E[n]}))}(D);break;default:console.error("Current window not recognised: ",r.SB.window),(0,r.IW)(r.$q.sceneView),V()}var n,b;(function(){var e,t,n,p,v=this;c.html('\n        <p class="header">\n            <button id="add-scene" style="font-size: 20px">+</button>\n            <select id="scene-select" onchange="window.setScene()" style="font-size: 20px" class="text-box">\n            </select><br>\n            <button id="rename-scene">\n                rename to\n            </button>\n            <input \n                type="text" \n                id="rename-scene-to" \n                style="\n                    border-radius: 0;\n                    border-bottom: 1px solid vaR(--text-colour); \n                    background: none\n            ">\n        </p>\n    ');try{for(var y=a(i.Scene.scenes),m=y.next();!m.done;m=y.next()){var _=m.value,b=_.id===i.Scene.active;l.append('\n            <option value="'.concat(_.id,'" ').concat(b?"selected":"",">\n                ").concat(_.name,"\n            </option>\n        "))}}catch(t){e={error:t}}finally{try{m&&!m.done&&(t=y.return)&&t.call(y)}finally{if(e)throw e.error}}f.click((function(){var e=i.Scene.activeScene.settings.ctx;i.Scene.active=i.Scene.create({name:"New Scene"}).id,i.Scene.activeScene.settings.ctx=e,V(),window.save()})),h.click((function(){var e=d.val();e&&"string"==typeof e&&(i.Scene.activeScene.name=e,window.save(),V())}));var w="",g=i.Scene.activeScene.entities;try{for(var x=a(g),S=x.next();!S.done;S=x.next()){var T=S.value;T.transform.isRoot()&&(w+="\n            <li>\n                ".concat(u(T,Object.is(r.SB.selectedEntity,T)),"\n            </li>\n        "))}}catch(e){n={error:e}}finally{try{S&&!S.done&&(p=x.return)&&p.call(x)}finally{if(n)throw n.error}}c.append('\n        <ul id="hierarchy-draggable-area">\n            '.concat(w,'\n        </ul>\n        <div id="create-entity-area" style="height: 100%; max-height: 100vw"></div>\n    '));for(var k=function(e){var t=g[e];$("#entitybutton".concat(t.id)).click((function(){"visible"!==$("#pop-up").css("visibility")&&((0,r.Pq)(t),V())})),C("entitybutton".concat(t.id),t,"\n            ".concat(P("delete",(function(){var e,t,n,i;null===(n=r.SB.selectedEntity)||void 0===n||n.delete();try{for(var o=(e=void 0,a((null===(i=r.SB.selectedEntity)||void 0===i?void 0:i.transform.children)||[])),s=o.next();!s.done;s=o.next())s.value.delete()}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}V()})),"\n            ").concat(P("duplicate",(function(){return o(v,void 0,void 0,(function(){var e,t,n,o,a;return s(this,(function(s){switch(s.label){case 0:return[4,null===(a=r.SB.selectedEntity)||void 0===a?void 0:a.getClone()];case 1:return(e=s.sent())?(t=/(.*)\(([0-9]+)\)/,(n=e.name.match(t))?(o=parseInt(n[2])+1,e.name="".concat(n[1]," (").concat(o,")")):e.name="".concat(e.name," (1)"),i.Entity.entities.push(e),V(),[2]):[2]}}))}))})),"\n            ").concat(P("add child",(function(){return o(v,void 0,void 0,(function(){var e;return s(this,(function(t){return i.Entity.newEntity({name:"New Entity",transform:new i.Transform({parent:(null===(e=r.SB.selectedEntity)||void 0===e?void 0:e.transform)||i.Scene.active})}),V(),[2]}))}))})),"\n        "))},E=0;E<g.length;E++)k(E);$("#create-entity-area").click((function(){(0,r.Pq)(null),V()})),function(e){if(!r.SB.selectedEntity)throw"no selected entity";C("create-entity-area",r.SB.selectedEntity,'\n        <p style="\n            background-color: var(--input-bg); \n            margin: 0;\n            padding: 2px 5px;\n            border-bottom: 1px solid var(--input-opposite-bg)\n        ">\n            Create\n        </p>\n        '.concat(P("empty",(function(){(0,r.Pq)(i.Entity.newEntity({})),V()})),"\n        ").concat(P("square",(function(){(0,r.Pq)(i.Entity.newEntity({name:"square",transform:new i.Transform({scale:new i.v3(100,100,100)}),components:[new i.RectRenderer({}),new i.RectCollider({})]})),V()})),"\n        ").concat(P("circle",(function(){(0,r.Pq)(i.Entity.newEntity({name:"circle",transform:new i.Transform({scale:new i.v3(50,1,1)}),components:[new i.CircleRenderer({}),new i.CircleCollider({})]})),V()})),"\n        ").concat(P("camera",(function(){(0,r.Pq)(i.Entity.newEntity({name:"camera",components:[new i.Camera({})]})),V()})),"\n    "))}()})(),(0,p.w)()}},955:(e,t,n)=>{"use strict";n.d(t,{Oq:()=>l,yu:()=>f,oI:()=>d});var r=n(23),i=n(838),o=n(216),s=n(768),a=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},u=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},c=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function l(e){var t=[];for(var n in r.v1)t.push(e(n,r.v1[n]));return t}function f(){return a(this,void 0,void 0,(function(){var e,t,n,i,o,s,a,l,f;return u(this,(function(u){switch(u.label){case 0:return[4,window.request("find-scripts",window.apiToken)];case 1:e=u.sent(),u.label=2;case 2:u.trys.push([2,8,9,10]),t=c(e),n=t.next(),u.label=3;case 3:return n.done?[3,7]:(i=n.value,[4,fetch("".concat(i,"?").concat(window.genCacheBust()))]);case 4:return[4,u.sent().text()];case 5:o=u.sent(),s=window.nameFromScriptURL(i),r.v1[s]=o,r.kw[s]=i,u.label=6;case 6:return n=t.next(),[3,3];case 7:return[3,10];case 8:return a=u.sent(),l={error:a},[3,10];case 9:try{n&&!n.done&&(f=t.return)&&f.call(t)}finally{if(l)throw l.error}return[7];case 10:return[2]}}))}))}function h(e,t){return a(this,void 0,void 0,(function(){var n,i,o;return u(this,(function(a){switch(a.label){case 0:return[4,fetch("".concat(e,"?").concat(window.genCacheBust()))];case 1:return[4,a.sent().text()];case 2:return n=a.sent(),i=window.nameFromScriptURL(e),r.kw[i]=e,(o=(0,s.run)(n,{env:t,fileName:i,measurePerformance:!1,currentDir:e})).error?[2,o.error]:[2,o.val]}}))}))}function d(){return a(this,void 0,void 0,(function(){var e,t,n,r,a,l,f,d,p,v,y,m,_,b,w,g,x,S,T,k,E,O;return u(this,(function(u){switch(u.label){case 0:return[4,window.request("find-scripts",window.apiToken)];case 1:e=u.sent(),t={},u.label=2;case 2:u.trys.push([2,7,8,9]),n=c(e),r=n.next(),u.label=3;case 3:return r.done?[3,6]:(a=r.value,(l=new s.Context).path=a,l.parent=s.global,f=window.nameFromScriptURL(a),[4,h(a,l)]);case 4:if((d=u.sent())instanceof s.ESError)return console.error(d.str),[3,5];t[f]=new s.ESNamespace(new s.ESString(f),l.getSymbolTableAsDict()),u.label=5;case 5:return r=n.next(),[3,3];case 6:return[3,9];case 7:return p=u.sent(),x={error:p},[3,9];case 8:try{r&&!r.done&&(S=n.return)&&S.call(n)}finally{if(x)throw x.error}return[7];case 9:try{for(v=c(o.Entity.entities),y=v.next();!y.done;y=v.next()){m=y.value;try{for(E=void 0,_=c(m.components),b=_.next();!b.done;b=_.next())"Script"===(w=b.value).type&&((g=w).script=t[g.name])}catch(e){E={error:e}}finally{try{b&&!b.done&&(O=_.return)&&O.call(_)}finally{if(E)throw E.error}}}}catch(e){T={error:e}}finally{try{y&&!y.done&&(k=v.return)&&k.call(v)}finally{if(T)throw T.error}}return(0,i.B)(),[2]}}))}))}window.blankScript=function(e){var t,n,o=null===(t=$("#".concat(e)).val())||void 0===t?void 0:t.toString();o&&(/^(?!(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$)[$A-Z\_a-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0\u08a2-\u08ac\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa80-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc][$A-Z\_a-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0\u08a2-\u08ac\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa80-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc0-9\u0300-\u036f\u0483-\u0487\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u0669\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7\u06e8\u06ea-\u06ed\u06f0-\u06f9\u0711\u0730-\u074a\u07a6-\u07b0\u07c0-\u07c9\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0859-\u085b\u08e4-\u08fe\u0900-\u0903\u093a-\u093c\u093e-\u094f\u0951-\u0957\u0962\u0963\u0966-\u096f\u0981-\u0983\u09bc\u09be-\u09c4\u09c7\u09c8\u09cb-\u09cd\u09d7\u09e2\u09e3\u09e6-\u09ef\u0a01-\u0a03\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a66-\u0a71\u0a75\u0a81-\u0a83\u0abc\u0abe-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ae2\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b3c\u0b3e-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b66-\u0b6f\u0b82\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd7\u0be6-\u0bef\u0c01-\u0c03\u0c3e-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0c66-\u0c6f\u0c82\u0c83\u0cbc\u0cbe-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0ce6-\u0cef\u0d02\u0d03\u0d3e-\u0d44\u0d46-\u0d48\u0d4a-\u0d4d\u0d57\u0d62\u0d63\u0d66-\u0d6f\u0d82\u0d83\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0df2\u0df3\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0e50-\u0e59\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0ed0-\u0ed9\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e\u0f3f\u0f71-\u0f84\u0f86\u0f87\u0f8d-\u0f97\u0f99-\u0fbc\u0fc6\u102b-\u103e\u1040-\u1049\u1056-\u1059\u105e-\u1060\u1062-\u1064\u1067-\u106d\u1071-\u1074\u1082-\u108d\u108f-\u109d\u135d-\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b4-\u17d3\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u18a9\u1920-\u192b\u1930-\u193b\u1946-\u194f\u19b0-\u19c0\u19c8\u19c9\u19d0-\u19d9\u1a17-\u1a1b\u1a55-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1b00-\u1b04\u1b34-\u1b44\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1b82\u1ba1-\u1bad\u1bb0-\u1bb9\u1be6-\u1bf3\u1c24-\u1c37\u1c40-\u1c49\u1c50-\u1c59\u1cd0-\u1cd2\u1cd4-\u1ce8\u1ced\u1cf2-\u1cf4\u1dc0-\u1de6\u1dfc-\u1dff\u200c\u200d\u203f\u2040\u2054\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2cef-\u2cf1\u2d7f\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua620-\ua629\ua66f\ua674-\ua67d\ua69f\ua6f0\ua6f1\ua802\ua806\ua80b\ua823-\ua827\ua880\ua881\ua8b4-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f1\ua900-\ua909\ua926-\ua92d\ua947-\ua953\ua980-\ua983\ua9b3-\ua9c0\ua9d0-\ua9d9\uaa29-\uaa36\uaa43\uaa4c\uaa4d\uaa50-\uaa59\uaa7b\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uaaeb-\uaaef\uaaf5\uaaf6\uabe3-\uabea\uabec\uabed\uabf0-\uabf9\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\ufe33\ufe34\ufe4d-\ufe4f\uff10-\uff19\uff3f]*$/.test(o)?(n=o,a(void 0,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,fetch("https://entropyengine.dev/templates/script.txt?c="+window.genCacheBust())];case 1:return[4,e.sent().text()];case 2:return[2,e.sent().replace(/NAME/,n)]}}))}))).then((function(e){r.v1[o]=e,r.kw[o]="../projects/".concat(r.Yu,"/assets/").concat(o,".es"),(0,i.B)()})):console.error("Not a valid variable name, sorry"))}},23:(e,t,n)=>{"use strict";n.d(t,{Yu:()=>u,JQ:()=>l,Xl:()=>f,v1:()=>d,kw:()=>p,$q:()=>h,SB:()=>v,Pq:()=>y,IW:()=>m});var r,i,o=n(838),s=n(955),a=n(216),u=window.urlParam("p");if(!u)throw"no project id specified";window.apiToken.project=parseInt(u),window.parseBool=function(e){return"true"===e};var c=document.getElementById("myCanvas");if(!(c instanceof HTMLCanvasElement))throw"canvas not a canvas";var l=c,f=c.getContext("2d");if(!f)throw"context is not defined";var h,d={},p={};window.switchScripts=function(e){v.currentScript=e,localStorage.currentScript=e,(0,o.B)()},function(e){e[e.sceneView=0]="sceneView",e[e.scriptEditor=1]="scriptEditor",e[e.gameView=2]="gameView",e[e.assets=3]="assets",e[e.sceneSettings=4]="sceneSettings",e[e.comments=5]="comments"}(h||(h={})),window.sceneView=h.sceneView,window.scriptEditor=h.scriptEditor,window.gameView=h.gameView,window.assets=h.assets,window.sceneSettings=h.sceneSettings,window.comments=h.comments;var v={window:null!==(r=parseInt(localStorage.statewindow))&&void 0!==r?r:h.sceneView,eeReturns:{},currentScript:null!==(i=localStorage.currentScript)&&void 0!==i?i:"",dragging:!1,dragStart:a.v2.zero,dragEnd:a.v2.zero,sceneCamera:null,selectedEntity:null,running:!1},y=function(e){v.selectedEntity=e},m=function(e){return t=void 0,n=void 0,i=function(){return function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}(this,(function(t){switch(t.label){case 0:return v.window===e?[2]:[4,(0,s.oI)()];case 1:return t.sent(),localStorage.statewindow=e,v.window=e,(0,o.B)(),[2]}}))},new((r=void 0)||(r=Promise))((function(e,o){function s(e){try{u(i.next(e))}catch(e){o(e)}}function a(e){try{u(i.throw(e))}catch(e){o(e)}}function u(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,a)}u((i=i.apply(t,n||[])).next())}));var t,n,r,i};window.setState=m,$("#share").attr("href",(function(e,t){return t+u})),$("#build-button").attr("href",(function(e,t){return t+u}))},754:function(){"use strict";var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},t=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};function n(){return e(this,void 0,void 0,(function(){var e,n;return t(this,(function(t){switch(t.label){case 0:return e=performance.now(),[4,window.request("ping")];case 1:return t.sent().ok?(n=performance.now()-e,$("#ping").html(Math.floor(n).toFixed(2)),[2]):(console.error("Server ping failed"),[2])}}))}))}setInterval(n,2e3),n()}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__={};(()=>{"use strict";var e=__webpack_require__(216),t=__webpack_require__(23),n=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},r=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},i=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function o(){var e=[];for(var n in t.v1){var r=t.kw[n],i=t.v1[n];void 0!==r&&void 0!==i?e.push({path:r,text:i}):(console.log(t.kw),console.error("Cannot find either script path or text for script ".concat(n,". Path: ").concat(r,", text: ").concat(i)))}return e}window.backgroundSave=function(){return n(void 0,void 0,void 0,(function(){var e,t,n,i,u;return r(this,(function(r){switch(r.label){case 0:return t=(e=window).request,n=["save-project"],u={scripts:o()},i='\n        {\n            "canvasID": "myCanvas",\n            "entities": [\n                '.concat,[4,s()];case 1:return[4,t.apply(e,n.concat([(u.json=i.apply('\n        {\n            "canvasID": "myCanvas",\n            "entities": [\n                ',[r.sent(),'\n            ],\n            "scenes": [\n                ']).concat(a(),"\n            ]\n        }\n        "),u)]))];case 2:return r.sent(),[2]}}))}))},window.save=function(){return n(void 0,void 0,void 0,(function(){var e,t,n,i;return r(this,(function(r){switch(r.label){case 0:return e=performance.now(),t=500,(n=$("#save")).html("Saving..."),n.prop("disabled",!0),[4,window.backgroundSave()];case 1:return r.sent(),(i=performance.now())-e<t?[4,window.sleep(t-(i-e))]:[3,3];case 2:r.sent(),r.label=3;case 3:return n.html("Saved"),[4,window.sleep(1e3)];case 4:return r.sent(),n.prop("disabled",!1),n.html("Save"),[2]}}))}))};var s=function(){return n(void 0,void 0,void 0,(function(){var n,o,s,a,u,c,l,f,h,d,p,v;return r(this,(function(r){n=[];try{for(o=i(e.Entity.entities),s=o.next();!s.done;s=o.next()){a=s.value,u=a.json();try{for(p=void 0,c=i(u.components),l=c.next();!l.done;l=c.next())"Script"===(f=l.value).type&&(f.path=t.kw[f.name||f.scriptName])}catch(e){p={error:e}}finally{try{l&&!l.done&&(v=c.return)&&v.call(c)}finally{if(p)throw p.error}}n.push(JSON.stringify(u))}}catch(e){h={error:e}}finally{try{s&&!s.done&&(d=o.return)&&d.call(o)}finally{if(h)throw h.error}}return[2,n.join(",\n")]}))}))};function a(){var t,n,r=[];try{for(var o=i(e.Scene.scenes),s=o.next();!s.done;s=o.next()){var a=s.value;r.push(JSON.stringify(a.json()))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r.join(",\n")}var u,c=__webpack_require__(955),l=__webpack_require__(838),f=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},h=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},d=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};window.addEventListener("click",(function(){$("#pop-up").css("visibility","hidden");var e=$(".add-component-popup");e.length&&e.remove()})),document.addEventListener("contextmenu",(function(e){$("#pop-up").css("visibility","hidden")})),window.onPropertyChange=function(e,n,r,i){for(var o,s,a=(null===(o=$("#".concat(e)).val())||void 0===o?void 0:o.toString())||"",u="nocomponent"===n?t.SB.selectedEntity:null===(s=t.SB.selectedEntity)||void 0===s?void 0:s.getComponent(n),c=0;c<r.length-1;c++)u=u[r[c]];i&&(a=i(a)),u[r[r.length-1]]=a,(0,l.B)()},window.setParent=function(e){var n,r=$("#".concat(e)).val();null===(n=t.SB.selectedEntity)||void 0===n||n.transform.setParentDirty(window.findNodeWithName(r)),(0,l.B)()},$(document).keydown((function(e){if((e.ctrlKey||e.metaKey)&&83===e.which)return window.save(),e.preventDefault(),!1}));var p=document.getElementById("run");if(!p)throw"no run button";window.run=function(){return f(void 0,void 0,void 0,(function(){return h(this,(function(n){switch(n.label){case 0:if(!t.Xl)throw"context is not defined";return t.SB.running=!0,[4,window.backgroundSave()];case 1:return n.sent(),[4,(0,c.oI)()];case 2:return n.sent(),(0,t.IW)(t.$q.gameView),(0,l.B)(),(0,e.rect)(t.Xl,e.v2.zero,t.JQ.width,t.JQ.height,"rgb(255, 255, 255)",0),$("#run").css({background:"none","background-color":"var(--text-colour)",height:"15px",width:"15px",margin:"2px 35px"}),p.onclick=function(){localStorage.statewindow=t.$q.sceneView,window.location.reload()},$("#save, #build-button, #share").remove(),t.SB.eeReturns.run(),[2]}}))}))},t.JQ.onwheel=function(e){if(e.preventDefault(),t.SB.window===t.$q.sceneView){if(!t.SB.sceneCamera)throw"no camera found";var n=t.SB.sceneCamera.getComponent("Camera");n.zoom*=1+-1e-4*e.deltaY,n.zoom=Math.min(Math.max(5*Math.pow(10,-3),n.zoom),5*Math.pow(10,2)),t.SB.sceneCamera.transform.position.z+=e.deltaY/1e3,(0,l.GD)(),(0,l.a6)(),(0,l.g5)()}},window.goToBuildMenu=function(){return f(void 0,void 0,void 0,(function(){return h(this,(function(e){switch(e.label){case 0:return[4,window.backgroundSave()];case 1:return e.sent(),window.location.href="../build/?p=".concat(t.Yu),[2]}}))}))};var v=$("#scene-select");window.setScene=function(){var n;e.Scene.active=parseInt((null===(n=v.val())||void 0===n?void 0:n.toString())||"0")||0,(0,t.Pq)(e.Scene.activeScene.entities[0]),sessionStorage.sceneID=e.Scene.active,(0,l.B)()},t.JQ.addEventListener("click",(function(n){var r;if(t.SB.window===t.$q.sceneView){var i=(0,e.getMousePos)(t.JQ,n),o=null===(r=t.SB.sceneCamera)||void 0===r?void 0:r.getComponent("Camera").screenSpaceToWorldSpace(i,t.JQ,t.SB.sceneCamera.transform.position);o&&function(n){var r,i,o,s;if(!t.Xl)throw"no ctx";var a=[];try{for(var u=d(e.Scene.activeScene.entities),c=u.next();!c.done;c=u.next()){var f=c.value;try{for(var h=(o=void 0,d(f.components)),p=h.next();!p.done;p=h.next()){var v=p.value;"GUIElement"===v.type&&v.touchingPoint(n,t.Xl,f.transform)&&a.push(f),"Collider"===v.type&&v.overlapsPoint(f.transform,n)&&a.push(f)}}catch(e){o={error:e}}finally{try{p&&!p.done&&(s=h.return)&&s.call(h)}finally{if(o)throw o.error}}}}catch(e){r={error:e}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}0===a.length?(0,t.Pq)(null):(0,t.Pq)(a[0]),(0,l.B)()}(o)}})),t.JQ.addEventListener("mousedown",(function(n){2===n.button&&(t.SB.dragStart=(0,e.getMousePos)(t.JQ,n),t.SB.dragging=!0)})),t.JQ.addEventListener("contextmenu",(function(e){e.preventDefault()}),!1),t.JQ.addEventListener("mouseup",(function(e){2===e.button&&(t.SB.dragging=!1)})),t.JQ.addEventListener("mousemove",(function(n){if(e.Camera.main&&t.SB.window===t.$q.sceneView&&t.SB.sceneCamera){var r=(0,e.getMousePos)(t.JQ,n),i=t.SB.sceneCamera.getComponent("Camera").screenSpaceToWorldSpace(r,t.JQ,t.SB.sceneCamera.transform.position),o=$("#world-space-pos"),s=$("#screen-space-pos");o.html("\n        ".concat(i.x.toFixed(2)," | ").concat(i.y.toFixed(2),"\n    ")),s.html("\n        ".concat(r.x.toFixed(2)," | ").concat(r.y.toFixed(2),"\n    ")),t.SB.dragging&&function(n){var r,i,o;t.SB.dragEnd=(0,e.getMousePos)(t.JQ,n);var s=t.SB.dragEnd.clone.sub(t.SB.dragStart),a=null!==(i=null===(r=t.SB.sceneCamera)||void 0===r?void 0:r.getComponent("Camera").zoom)&&void 0!==i?i:1;s.scale(1/a),s.scale(-1),null===(o=t.SB.sceneCamera)||void 0===o||o.transform.localPosition.add(s.v3),t.SB.dragStart=t.SB.dragEnd,(0,l.GD)(),(0,l.a6)(),(0,l.g5)()}(n)}}),!1),null===(u=null===t.JQ||void 0===t.JQ?void 0:t.JQ.parentNode)||void 0===u||u.addEventListener("resize",(function(){(0,l.B)()})),window.findSpriteWithName=function(t){return e.Entity.find(t)},window.findNodeWithName=function(t){var n,r=null===(n=e.Entity.find(t))||void 0===n?void 0:n.transform;return null!=r||(r=e.Scene.active),r},__webpack_require__(754);var y=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},m=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},_=window.location.search,b=new URLSearchParams(_).get("p");function w(e,t,n,r){try{fetch("http://localhost:5501/"+e,{body:JSON.stringify(t),method:"POST"}).then(n).catch(r)}catch(e){r(e)}}function g(){return y(this,void 0,void 0,(function(){var e=this;return m(this,(function(n){return w("ping",{},(function(n){return y(e,void 0,void 0,(function(){return m(this,(function(e){switch(e.label){case 0:return t.SB.running?[2]:[4,n.text()];case 1:return"1"!==e.sent()?(setTimeout(g,1e3),[2]):(function(){var e=this;w("authenticate-connection",{user:localStorage.id,project:b},(function(t){return y(e,void 0,void 0,(function(){return m(this,(function(e){switch(e.label){case 0:return[4,t.text()];case 1:return"1"!==e.sent()?(setTimeout(g,500),[2]):(console.log("Connected to localhost client"),x(),[2])}}))}))}),(function(){return y(e,void 0,void 0,(function(){return m(this,(function(e){return[2,void setTimeout(g,500)]}))}))}))}(),[2])}}))}))}),(function(){return y(e,void 0,void 0,(function(){return m(this,(function(e){return[2,void setTimeout(g,1e3)]}))}))})),[2]}))}))}function x(){var e=this;w("changed",{},(function(n){return y(e,void 0,void 0,(function(){return m(this,(function(e){switch(e.label){case 0:return t.SB.running?[2]:[4,n.text()];case 1:return"1"!==e.sent()?(setTimeout(x,500),[2]):(window.location.reload(),[2])}}))}))}),(function(){return y(e,void 0,void 0,(function(){return m(this,(function(e){return[2,void setTimeout(g,500)]}))}))}))}g();var S=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},T=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},k=new Headers;k.append("pragma","no-cache"),k.append("cache-control","no-cache");var E={method:"GET",headers:k};function O(n){return S(this,void 0,void 0,(function(){var r,i,o,s;return T(this,(function(a){switch(a.label){case 0:return r="../projects/".concat(n),i={},[4,fetch(r+"/index.json?c=".concat(window.genCacheBust()),E)];case 1:return[4,a.sent().json()];case 2:for(s in o=a.sent())["sprites","scenes"].includes(s)||(i[s]=o[s]);return e.initialiseScenes(o.scenes||[]),t.SB.sceneCamera=new e.Entity({components:[new e.Camera({})]}),t.SB.eeReturns=e.EntropyEngine(i),[4,e.entitiesFromJSON(o.entities||[])];case 3:return a.sent(),(0,t.Pq)(e.Entity.entities[0]),[4,(0,c.oI)()];case 4:return a.sent(),e.Camera.main=t.SB.sceneCamera,e.Scene.active=parseInt(sessionStorage.sceneID)||0,[2]}}))}))}function C(){return S(this,void 0,void 0,(function(){var e=this;return T(this,(function(t){return[2,new Promise((function(t){window.mustBeSignedIn((function(){return S(e,void 0,void 0,(function(){var e;return T(this,(function(n){switch(n.label){case 0:return[4,window.request("get-project-access",window.apiToken)];case 1:return(e=n.sent().accessLevel)<1?(window.location.href="https://entropyengine.dev/accounts/error?type=projectAccessDenied",[2]):(console.log("ACCESS LEVEL: ".concat(e)),e?(t(e),[2]):[2])}}))}))}))}))]}))}))}$("nav").html(""),function(){var n;S(this,void 0,void 0,(function(){var r,i;return T(this,(function(o){switch(o.label){case 0:return[4,C()];case 1:if(o.sent()<1)throw"no access to project";return[4,e.initialiseEntropyScript()];case 2:return o.sent(),[4,(0,c.yu)()];case 3:if(o.sent(),null!==(n=t.SB.currentScript)&&void 0!==n||(t.SB.currentScript=Object.keys(t.v1)[0]),!t.Yu)throw"Invalid projectID";return[4,O(parseInt(t.Yu))];case 4:return o.sent(),[4,window.request("get-project-name",window.apiToken)];case 5:return r=o.sent(),i=e.cullString(r.name,16),$("#project-name").html(i),document.title=i,[2]}}))}))}()})()})();</script><footer></footer></body></html>